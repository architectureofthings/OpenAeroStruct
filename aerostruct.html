<!DOCTYPE html>
<!-- Generated by Cython 0.24.1 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: aerostruct.py</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.24.1</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="aerostruct.c">aerostruct.c</a></p>
<div class="cython"><pre class="cython line score-0">&#xA0;<span class="">0001</span>: <span class="c"># Univ. Michigan Aerostructural model.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0002</span>: <span class="c"># Based on OpenAeroStruct by John Hwang, and John Jasa (github.com/johnjasa/OpenAeroStruct)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: <span class="c"># Cython implementation by Sam Friedman</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: <span class="c"># Main file for coupled system components</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: <span class="c"># make compatible Python 2.x to 3.x</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: <span class="k">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span></pre>
<pre class="cython line score-19" onclick='toggleDiv(this)'>+<span class="">0010</span>: <span class="k">from</span> <span class="nn">future.builtins</span> <span class="k">import</span> <span class="nb">range</span>  <span class="c"># make compatible Python 2.x to 3.x</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_range);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_range);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_range);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_future_builtins, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_range); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_range, __pyx_t_1) &lt; 0) __PYX_ERR(0, 10, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0011</span>: <span class="k">import</span> <span class="nn">warnings</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_warnings, 0, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_warnings, __pyx_t_2) &lt; 0) __PYX_ERR(0, 11, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0012</span>: <span class="k">import</span> <span class="nn">sys</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sys, 0, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 12, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sys, __pyx_t_2) &lt; 0) __PYX_ERR(0, 12, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0013</span>: <span class="k">import</span> <span class="nn">os</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_os, 0, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_os, __pyx_t_2) &lt; 0) __PYX_ERR(0, 13, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0014</span>: <span class="k">import</span> <span class="nn">scipy.sparse</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_sparse, 0, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_scipy, __pyx_t_2) &lt; 0) __PYX_ERR(0, 14, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0015</span>: <span class="k">from</span> <span class="nn">scipy.linalg</span> <span class="k">import</span> <span class="n">lu_factor</span><span class="p">,</span> <span class="n">lu_solve</span></pre>
<pre class='cython code score-29 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_lu_factor);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_lu_factor);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_lu_factor);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_lu_solve);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_lu_solve);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_lu_solve);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_linalg, __pyx_t_2, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_lu_factor); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_lu_factor, __pyx_t_2) &lt; 0) __PYX_ERR(0, 15, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_lu_solve); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_lu_solve, __pyx_t_2) &lt; 0) __PYX_ERR(0, 15, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0016</span>: </pre>
<pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">0017</span>: <span class="k">try</span><span class="p">:</span></pre>
<pre class='cython code score-9 '>  {
    /*try:*/ {
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L9_try_end;
    __pyx_L2_error:;
    __Pyx_PyThreadState_assign
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
    __Pyx_PyThreadState_assign
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
    goto __pyx_L1_error;
    __pyx_L3_exception_handled:;
    __Pyx_PyThreadState_assign
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);
    __pyx_L9_try_end:;
  }
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0018</span>:     <span class="k">import</span> <span class="nn">lib</span></pre>
<pre class='cython code score-8 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_lib, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L2_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_lib, __pyx_t_1) &lt; 0) __PYX_ERR(0, 18, __pyx_L2_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0019</span>:     <span class="n">fortran_flag</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-5 '>      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_fortran_flag, Py_True) &lt; 0) __PYX_ERR(0, 19, __pyx_L2_error)
</pre><pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">0020</span>: <span class="k">except</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>    /*except:*/ {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_2, &amp;__pyx_t_6) &lt; 0) __PYX_ERR(0, 20, __pyx_L4_except_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0021</span>:     <span class="n">fortran_flag</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-8 '>      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_fortran_flag, Py_False) &lt; 0) __PYX_ERR(0, 21, __pyx_L4_except_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L3_exception_handled;
    }
    __pyx_L4_except_error:;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0022</span>: <span class="n">sparse_flag</span> <span class="o">=</span> <span class="bp">False</span>  <span class="c"># don&#39;t use sparse functions</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sparse_flag, Py_False) &lt; 0) __PYX_ERR(0, 22, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0023</span>: </pre>
<pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0024</span>: <span class="k">import</span> <span class="nn">numpy</span></pre>
<pre class='cython code score-8 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 24, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_numpy, __pyx_t_6) &lt; 0) __PYX_ERR(0, 24, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0025</span>: <span class="n">DTYPE</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span>  <span class="c"># double precision float</span></pre>
<pre class='cython code score-11 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 25, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 25, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_2) &lt; 0) __PYX_ERR(0, 25, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0026</span>: <span class="c"># import cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>: <span class="c"># cimport cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0028</span>: <span class="c"># import numpy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0029</span>: <span class="c"># cimport numpy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0030</span>: <span class="c"># DTYPE = numpy.float64</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0031</span>: <span class="c"># ctypedef numpy.float64_t DTYPE_t</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0032</span>: <span class="c"># @cython.boundscheck(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0033</span>: <span class="c"># @cython.wraparound(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0034</span>: <span class="c"># @cython.nonecheck(False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0035</span>: <span class="c"># to disable OpenMDAO warnings which will create an error in Matlab</span></pre>
<pre class="cython line score-14" onclick='toggleDiv(this)'>+<span class="">0036</span>: <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">&quot;ignore&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_warnings); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 36, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_filterwarnings); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 36, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__534, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 36, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__534 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_ignore); if (unlikely(!__pyx_tuple__534)) __PYX_ERR(0, 36, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__534);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__534);
</pre><pre class="cython line score-0">&#xA0;<span class="">0037</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0038</span>: <span class="c"># In Matlab code, add this before calling Python functions:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0039</span>: <span class="c">#   if count(py.sys.path,&#39;&#39;) == 0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0040</span>: <span class="c">#       insert(py.sys.path,int32(0),&#39;&#39;);</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0041</span>: <span class="c">#   end</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0042</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0043</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0044</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0045</span>: <span class="sd">--------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0046</span>: <span class="sd">--------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0047</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0048</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0049</span>: <span class="sd">                                GEOMETRY / SETUP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0050</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>: <span class="sd">--------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>: <span class="sd">--------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0054</span>: <span class="sd">From geometry.py: Manipulate geometry mesh based on high-level design parameters &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0055</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0056</span>: </pre>
<pre class="cython line score-79" onclick='toggleDiv(this)'>+<span class="">0057</span>: <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="n">num_inboard</span><span class="o">=</span><span class="mf">3</span><span class="p">,</span> <span class="n">num_outboard</span><span class="o">=</span><span class="mf">4</span><span class="p">):</span></pre>
<pre class='cython code score-79 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_1setup(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_setup[] = " Setup the aerostruct mesh ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_1setup = {"setup", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_1setup, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_setup};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_1setup(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_num_inboard = 0;
  PyObject *__pyx_v_num_outboard = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("setup (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_num_inboard,&amp;__pyx_n_s_num_outboard,0};
    PyObject* values[2] = {0,0};
    values[0] = ((PyObject *)((PyObject *)__pyx_int_3));
    values[1] = ((PyObject *)((PyObject *)__pyx_int_4));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_inboard);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_outboard);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "setup") &lt; 0)) __PYX_ERR(0, 57, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_num_inboard = values[0];
    __pyx_v_num_outboard = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("setup", 0, 0, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 57, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.setup", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_setup(__pyx_self, __pyx_v_num_inboard, __pyx_v_num_outboard);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_setup(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_num_inboard, PyObject *__pyx_v_num_outboard) {
  double __pyx_v_span;
  double __pyx_v_M;
  double __pyx_v_alpha;
  double __pyx_v_rho;
  double __pyx_v_a;
  double __pyx_v_v;
  double __pyx_v_E;
  double __pyx_v_G;
  double __pyx_v_stress;
  double __pyx_v_mrho;
  PyObject *__pyx_v_mesh = NULL;
  PyObject *__pyx_v_num_x = NULL;
  PyObject *__pyx_v_num_y = NULL;
  PyObject *__pyx_v_num_twist = NULL;
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_v_num_thickness = NULL;
  PyObject *__pyx_v_t = NULL;
  PyObject *__pyx_v_aero_ind = NULL;
  PyObject *__pyx_v_fem_ind = NULL;
  double __pyx_v_dihedral;
  double __pyx_v_sweep;
  double __pyx_v_taper;
  double __pyx_v_fem_origin;
  PyObject *__pyx_v_tot_n_fem = NULL;
  PyObject *__pyx_v_disp = NULL;
  PyObject *__pyx_v_num_surf = NULL;
  PyObject *__pyx_v_jac_twist = NULL;
  PyObject *__pyx_v_jac_thickness = NULL;
  PyObject *__pyx_v_twist_cp = NULL;
  PyObject *__pyx_v_thickness_cp = NULL;
  PyObject *__pyx_v_twist = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_thickness = NULL;
  PyObject *__pyx_v_def_mesh = NULL;
  PyObject *__pyx_v_params = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("setup", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.setup", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_twist);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_thickness);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fem_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_disp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_jac_twist);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_jac_thickness);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_twist_cp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_thickness_cp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_twist);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_thickness);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_def_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_params);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__535 = <span class='py_c_api'>PyTuple_Pack</span>(36, __pyx_n_s_num_inboard, __pyx_n_s_num_outboard, __pyx_n_s_span, __pyx_n_s_M, __pyx_n_s_alpha, __pyx_n_s_rho, __pyx_n_s_a, __pyx_n_s_v, __pyx_n_s_E, __pyx_n_s_G, __pyx_n_s_stress, __pyx_n_s_mrho, __pyx_n_s_mesh, __pyx_n_s_num_x, __pyx_n_s_num_y, __pyx_n_s_num_twist, __pyx_n_s_r, __pyx_n_s_num_thickness, __pyx_n_s_t, __pyx_n_s_aero_ind, __pyx_n_s_fem_ind, __pyx_n_s_dihedral, __pyx_n_s_sweep, __pyx_n_s_taper, __pyx_n_s_fem_origin, __pyx_n_s_tot_n_fem, __pyx_n_s_disp, __pyx_n_s_num_surf, __pyx_n_s_jac_twist, __pyx_n_s_jac_thickness, __pyx_n_s_twist_cp, __pyx_n_s_thickness_cp, __pyx_n_s_twist, __pyx_n_s_thickness, __pyx_n_s_def_mesh, __pyx_n_s_params); if (unlikely(!__pyx_tuple__535)) __PYX_ERR(0, 57, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__535);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__535);
  __pyx_codeobj__536 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 36, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__535, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_setup, 57, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__536)) __PYX_ERR(0, 57, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_1setup, 0, __pyx_n_s_setup, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__536)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 57, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__537);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_setup, __pyx_t_2) &lt; 0) __PYX_ERR(0, 57, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__537 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject *)__pyx_int_3), ((PyObject *)__pyx_int_4)); if (unlikely(!__pyx_tuple__537)) __PYX_ERR(0, 57, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__537);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__537);
</pre><pre class="cython line score-0">&#xA0;<span class="">0058</span>:     <span class="sd">&#39;&#39;&#39; Setup the aerostruct mesh &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0059</span>:     <span class="c"># Define the aircraft properties, from CRM.py</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0060</span>:     <span class="n">span</span> <span class="o">=</span> <span class="mf">58.7630524</span>  <span class="c"># [m] baseline CRM</span></pre>
<pre class='cython code score-0 '>  __pyx_v_span = 58.7630524;
</pre><pre class="cython line score-0">&#xA0;<span class="">0061</span>:     <span class="c"># W0 = 0.5 * 2.5e6 # [N] (MTOW of B777 is 3e5 kg with fuel)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0062</span>:     <span class="c"># CT = 9.81 * 17.e-6 # [1/s] (9.81 N/kg * 17e-6 kg/N/s)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0063</span>:     <span class="c"># R = 14.3e6 # [m] maximum range</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0064</span>:     <span class="n">M</span> <span class="o">=</span> <span class="mf">0.84</span>  <span class="c"># at cruise</span></pre>
<pre class='cython code score-0 '>  __pyx_v_M = 0.84;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0065</span>:     <span class="n">alpha</span> <span class="o">=</span> <span class="mf">3.</span>  <span class="c"># [deg.]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_alpha = 3.;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0066</span>:     <span class="n">rho</span> <span class="o">=</span> <span class="mf">0.38</span>  <span class="c"># [kg/m^3] at 35,000 ft</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rho = 0.38;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0067</span>:     <span class="n">a</span> <span class="o">=</span> <span class="mf">295.4</span>  <span class="c"># [m/s] at 35,000 ft</span></pre>
<pre class='cython code score-0 '>  __pyx_v_a = 295.4;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0068</span>:     <span class="n">v</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">M</span></pre>
<pre class='cython code score-0 '>  __pyx_v_v = (__pyx_v_a * __pyx_v_M);
</pre><pre class="cython line score-0">&#xA0;<span class="">0069</span>:     <span class="c"># CL0 = 0.2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0070</span>:     <span class="c"># CD0 = 0.015</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0071</span>:     <span class="c"># Define spatialbeam properties, from aluminum.py</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0072</span>:     <span class="n">E</span> <span class="o">=</span> <span class="mf">200.e9</span>  <span class="c"># [Pa]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 200.e9;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0073</span>:     <span class="n">G</span> <span class="o">=</span> <span class="mf">30.e9</span>  <span class="c"># [Pa]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_G = 30.e9;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0074</span>:     <span class="n">stress</span> <span class="o">=</span> <span class="mf">20.e6</span>  <span class="c"># [Pa]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_stress = 20.e6;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0075</span>:     <span class="n">mrho</span> <span class="o">=</span> <span class="mf">3.e3</span>  <span class="c"># [kg/m^3]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_mrho = 3.e3;
</pre><pre class="cython line score-0">&#xA0;<span class="">0076</span>:     <span class="c"># Create the mesh with 3 inboard points and 4 outboard points.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0077</span>:     <span class="c"># This will be mirrored to produce a mesh with ... spanwise points,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0078</span>:     <span class="c"># or ...-1 spanwise panels</span></pre>
<pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">0079</span>:     <span class="n">mesh</span> <span class="o">=</span> <span class="n">gen_crm_mesh</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num_inboard</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_outboard</span><span class="p">),</span> <span class="n">num_x</span><span class="o">=</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_gen_crm_mesh); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_num_inboard); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 79, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_num_outboard); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 79, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 79, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 79, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_num_x, __pyx_int_2) &lt; 0) __PYX_ERR(0, 79, __pyx_L1_error)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 79, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_mesh = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0080</span>:     <span class="n">num_x</span><span class="p">,</span> <span class="n">num_y</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-57 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 80, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_2, 0, 2, NULL, NULL, &amp;__pyx_slice_, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 80, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
    PyObject* sequence = __pyx_t_3;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 80, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 80, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 80, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 80, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_4 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_1), 2) &lt; 0) __PYX_ERR(0, 80, __pyx_L1_error)
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 80, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_num_x = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_num_y = __pyx_t_4;
  __pyx_t_4 = 0;
/* … */
  __pyx_slice_ = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_2, Py_None); if (unlikely(!__pyx_slice_)) __PYX_ERR(0, 80, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice_);
</pre><pre class="cython line score-45" onclick='toggleDiv(this)'>+<span class="">0081</span>:     <span class="n">num_twist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="nb">int</span><span class="p">((</span><span class="n">num_y</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5</span><span class="p">),</span> <span class="mf">5</span><span class="p">])</span></pre>
<pre class='cython code score-45 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 81, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_max); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 81, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_num_y, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 81, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_TrueDivideObjC</span>(__pyx_t_4, __pyx_int_5, 5, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 81, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 81, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 81, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_5);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 81, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 81, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 81, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_num_twist = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">0082</span>:     <span class="n">r</span> <span class="o">=</span> <span class="n">radii</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_radii); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 82, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_mesh); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 82, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 82, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_6); __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mesh);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_v_mesh);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 82, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_r = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0083</span>:     <span class="c"># Set the number of thickness control points and the initial thicknesses</span></pre>
<pre class="cython line score-1" onclick='toggleDiv(this)'>+<span class="">0084</span>:     <span class="n">num_thickness</span> <span class="o">=</span> <span class="n">num_twist</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_twist);
  __pyx_v_num_thickness = __pyx_v_num_twist;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0085</span>:     <span class="n">t</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="mf">10</span></pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_TrueDivideObjC</span>(__pyx_v_r, __pyx_int_10, 10, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 85, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_t = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-31" onclick='toggleDiv(this)'>+<span class="">0086</span>:     <span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-31 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_reshape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 86, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 86, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 86, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 86, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (__pyx_t_1) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_7, __pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_7, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 86, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_mesh, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-67" onclick='toggleDiv(this)'>+<span class="">0087</span>:     <span class="n">aero_ind</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">num_x</span><span class="p">,</span> <span class="n">num_y</span><span class="p">]))</span></pre>
<pre class='cython code score-67 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 87, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_atleast_2d); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 87, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 87, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 87, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 87, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_x);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_num_x);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_y);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_v_num_y);
  __pyx_t_8 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_8) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 87, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 87, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 87, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 87, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 87, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_9, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 87, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_aero_ind = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">0088</span>:     <span class="n">fem_ind</span> <span class="o">=</span> <span class="p">[</span><span class="n">num_y</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 88, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_y);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_num_y);
  __pyx_v_fem_ind = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-75" onclick='toggleDiv(this)'>+<span class="">0089</span>:     <span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_ind</span> <span class="o">=</span> <span class="n">get_inds</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">)</span></pre>
<pre class='cython code score-75 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_get_inds); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 89, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_9 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 89, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (__pyx_t_9) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9); __pyx_t_9 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_7, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fem_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_7, __pyx_v_fem_ind);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 89, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
    PyObject* sequence = __pyx_t_3;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 89, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 89, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 89, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 89, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;
    index = 0; __pyx_t_4 = __pyx_t_5(__pyx_t_9); if (unlikely(!__pyx_t_4)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    index = 1; __pyx_t_2 = __pyx_t_5(__pyx_t_9); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_9), 2) &lt; 0) __PYX_ERR(0, 89, __pyx_L1_error)
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 89, __pyx_L1_error)
    __pyx_L6_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_aero_ind, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_fem_ind, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0090</span>:     <span class="c"># Set additional mesh parameters</span></pre>
<pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0091</span>:     <span class="n">dihedral</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c"># dihedral angle in degrees</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dihedral = 0.;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0092</span>:     <span class="n">sweep</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c"># shearing sweep angle in degrees</span></pre>
<pre class='cython code score-0 '>  __pyx_v_sweep = 0.;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0093</span>:     <span class="n">taper</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c"># taper ratio</span></pre>
<pre class='cython code score-0 '>  __pyx_v_taper = 1.;
</pre><pre class="cython line score-0" onclick='toggleDiv(this)'>+<span class="">0094</span>:     <span class="n">fem_origin</span> <span class="o">=</span> <span class="mf">0.35</span></pre>
<pre class='cython code score-0 '>  __pyx_v_fem_origin = 0.35;
</pre><pre class="cython line score-0">&#xA0;<span class="">0095</span>:     <span class="c"># Initial displacements of zero</span></pre>
<pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0096</span>:     <span class="n">tot_n_fem</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 96, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 96, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__2 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__2)) __PYX_ERR(0, 96, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__2);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fem_ind, __pyx_tuple__3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 96, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_9) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 96, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 96, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9); __pyx_t_9 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 96, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_tot_n_fem = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__2, __pyx_int_0); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 96, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0097</span>:     <span class="n">disp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_n_fem</span><span class="p">,</span> <span class="mf">6</span><span class="p">))</span></pre>
<pre class='cython code score-38 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 97, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 97, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 97, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_n_fem);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_n_fem);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_tot_n_fem);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_6);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 97, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 97, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_9, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 97, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_disp = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0098</span>:     <span class="c"># # Define Jacobians for b-spline controls</span></pre>
<pre class="cython line score-45" onclick='toggleDiv(this)'>+<span class="">0099</span>:     <span class="n">tot_n_fem</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-45 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 99, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__4 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__4)) __PYX_ERR(0, 99, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__4);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fem_ind, __pyx_tuple__5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 99, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 99, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 99, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tot_n_fem, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__4, __pyx_int_0); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 99, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0100</span>:     <span class="n">num_surf</span> <span class="o">=</span> <span class="n">fem_ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_fem_ind, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 100, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 100, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_num_surf = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">0101</span>:     <span class="n">jac_twist</span> <span class="o">=</span> <span class="n">get_bspline_mtx</span><span class="p">(</span><span class="n">num_twist</span><span class="p">,</span> <span class="n">num_y</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_get_bspline_mtx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 101, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 101, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (__pyx_t_2) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_twist);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_twist);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+__pyx_t_7, __pyx_v_num_twist);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_y);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1+__pyx_t_7, __pyx_v_num_y);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 101, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_jac_twist = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">0102</span>:     <span class="n">jac_thickness</span> <span class="o">=</span> <span class="n">get_bspline_mtx</span><span class="p">(</span><span class="n">num_thickness</span><span class="p">,</span> <span class="n">tot_n_fem</span> <span class="o">-</span> <span class="n">num_surf</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_get_bspline_mtx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 102, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_tot_n_fem, __pyx_v_num_surf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 102, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (__pyx_t_2) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_thickness);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_thickness);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_7, __pyx_v_num_thickness);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_7, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 102, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_jac_thickness = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0103</span>:     <span class="c"># # Define ...</span></pre>
<pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0104</span>:     <span class="n">twist_cp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_twist</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 104, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 104, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_num_twist); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 104, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_twist);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_twist);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_v_num_twist);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 104, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_twist_cp = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class="cython line score-65" onclick='toggleDiv(this)'>+<span class="">0105</span>:     <span class="n">thickness_cp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_thickness</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></pre>
<pre class='cython code score-65 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 105, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_ones); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_num_thickness); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 105, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 105, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_thickness);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_thickness);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_num_thickness);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 105, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 105, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_max); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 105, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_t);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_t);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_t);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 105, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_thickness_cp = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">0106</span>:     <span class="n">twist</span> <span class="o">=</span> <span class="n">cp2pt</span><span class="p">(</span><span class="n">twist_cp</span><span class="p">,</span> <span class="n">jac_twist</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_cp2pt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_9 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 106, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (__pyx_t_9) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9); __pyx_t_9 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_twist_cp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_twist_cp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_7, __pyx_v_twist_cp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_jac_twist);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_jac_twist);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_7, __pyx_v_jac_twist);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 106, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_twist = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">0107</span>:     <span class="n">thickness</span> <span class="o">=</span> <span class="n">cp2pt</span><span class="p">(</span><span class="n">thickness_cp</span><span class="p">,</span> <span class="n">jac_thickness</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_cp2pt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 107, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  if (__pyx_t_2) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_thickness_cp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_thickness_cp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_7, __pyx_v_thickness_cp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_jac_thickness);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_jac_thickness);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_7, __pyx_v_jac_thickness);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_9, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 107, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_thickness = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">0108</span>:     <span class="n">mesh</span> <span class="o">=</span> <span class="n">geometry_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">twist</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="n">span</span><span class="o">=</span><span class="mf">58.7630524</span><span class="p">)</span></pre>
<pre class='cython code score-35 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_geometry_mesh); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 108, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_twist);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_twist);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_v_twist);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 5, __pyx_int_1);
  __pyx_t_9 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 108, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_span, __pyx_float_58_7630524) &lt; 0) __PYX_ERR(0, 108, __pyx_L1_error)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_mesh, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">0109</span>:     <span class="n">def_mesh</span> <span class="o">=</span> <span class="n">transfer_displacements</span><span class="p">(</span></pre>
<pre class='cython code score-20 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_transfer_displacements); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 109, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_disp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_disp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_disp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fem_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 3, __pyx_v_fem_ind);
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 109, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_def_mesh = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0110</span>:         <span class="n">mesh</span><span class="p">,</span> <span class="n">disp</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">,</span> <span class="n">fem_origin</span><span class="o">=</span><span class="mf">0.35</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_fem_origin, __pyx_float_0_35) &lt; 0) __PYX_ERR(0, 110, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0111</span>:     <span class="c"># Output the def_mesh for the aero modules</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0112</span>:     <span class="c"># Other variables needed for aero and struct modules</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0113</span>:     <span class="n">params</span> <span class="o">=</span> <span class="p">{</span></pre>
<pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0114</span>:         <span class="s">&#39;mesh&#39;</span><span class="p">:</span> <span class="n">mesh</span><span class="p">,</span></pre>
<pre class='cython code score-10 '>  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_mesh, __pyx_v_mesh) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0115</span>:         <span class="s">&#39;num_x&#39;</span><span class="p">:</span> <span class="n">num_x</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_num_x, __pyx_v_num_x) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0116</span>:         <span class="s">&#39;num_y&#39;</span><span class="p">:</span> <span class="n">num_y</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_num_y, __pyx_v_num_y) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0117</span>:         <span class="s">&#39;span&#39;</span><span class="p">:</span> <span class="n">span</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_span); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_span, __pyx_t_1) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0118</span>:         <span class="s">&#39;twist_cp&#39;</span><span class="p">:</span> <span class="n">twist_cp</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_twist_cp, __pyx_v_twist_cp) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0119</span>:         <span class="s">&#39;thickness_cp&#39;</span><span class="p">:</span> <span class="n">thickness_cp</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_thickness_cp, __pyx_v_thickness_cp) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0120</span>:         <span class="s">&#39;v&#39;</span><span class="p">:</span> <span class="n">v</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_v); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_v, __pyx_t_1) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0121</span>:         <span class="s">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_alpha); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 121, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_alpha, __pyx_t_1) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0122</span>:         <span class="s">&#39;rho&#39;</span><span class="p">:</span> <span class="n">rho</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_rho); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 122, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_rho, __pyx_t_1) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0123</span>:         <span class="s">&#39;r&#39;</span><span class="p">:</span> <span class="n">r</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_r, __pyx_v_r) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0124</span>:         <span class="s">&#39;t&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, __pyx_v_t) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0125</span>:         <span class="s">&#39;aero_ind&#39;</span><span class="p">:</span> <span class="n">aero_ind</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_aero_ind, __pyx_v_aero_ind) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0126</span>:         <span class="s">&#39;fem_ind&#39;</span><span class="p">:</span> <span class="n">fem_ind</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_fem_ind, __pyx_v_fem_ind) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0127</span>:         <span class="s">&#39;num_thickness&#39;</span><span class="p">:</span> <span class="n">num_thickness</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_num_thickness, __pyx_v_num_thickness) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0128</span>:         <span class="s">&#39;num_twist&#39;</span><span class="p">:</span> <span class="n">num_twist</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_num_twist, __pyx_v_num_twist) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0129</span>:         <span class="s">&#39;sweep&#39;</span><span class="p">:</span> <span class="n">sweep</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sweep); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 129, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_sweep, __pyx_t_1) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0130</span>:         <span class="s">&#39;taper&#39;</span><span class="p">:</span> <span class="n">taper</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_taper); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 130, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_taper, __pyx_t_1) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0131</span>:         <span class="s">&#39;dihedral&#39;</span><span class="p">:</span> <span class="n">dihedral</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dihedral); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 131, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dihedral, __pyx_t_1) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0132</span>:         <span class="s">&#39;E&#39;</span><span class="p">:</span> <span class="n">E</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 132, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_E, __pyx_t_1) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0133</span>:         <span class="s">&#39;G&#39;</span><span class="p">:</span> <span class="n">G</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_G); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 133, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_G, __pyx_t_1) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0134</span>:         <span class="s">&#39;stress&#39;</span><span class="p">:</span> <span class="n">stress</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_stress); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 134, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_stress, __pyx_t_1) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0135</span>:         <span class="s">&#39;mrho&#39;</span><span class="p">:</span> <span class="n">mrho</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_mrho); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 135, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_mrho, __pyx_t_1) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0136</span>:         <span class="s">&#39;tot_n_fem&#39;</span><span class="p">:</span> <span class="n">tot_n_fem</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_tot_n_fem, __pyx_v_tot_n_fem) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0137</span>:         <span class="s">&#39;num_surf&#39;</span><span class="p">:</span> <span class="n">num_surf</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_num_surf, __pyx_v_num_surf) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0138</span>:         <span class="s">&#39;jac_twist&#39;</span><span class="p">:</span> <span class="n">jac_twist</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_jac_twist, __pyx_v_jac_twist) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0139</span>:         <span class="s">&#39;jac_thickness&#39;</span><span class="p">:</span> <span class="n">jac_thickness</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_jac_thickness, __pyx_v_jac_thickness) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0140</span>:         <span class="s">&#39;fem_origin&#39;</span><span class="p">:</span> <span class="n">fem_origin</span></pre>
<pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0141</span>:     <span class="p">}</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_fem_origin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 141, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_fem_origin, __pyx_t_1) &lt; 0) __PYX_ERR(0, 114, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_params = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0142</span>: </pre>
<pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0143</span>:     <span class="k">return</span> <span class="p">(</span><span class="n">def_mesh</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 143, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_def_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_def_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_def_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_params);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_params);
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0144</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0145</span>: </pre>
<pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0146</span>: <span class="k">def</span> <span class="nf">cp2pt</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span> <span class="n">jac</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_3cp2pt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_2cp2pt[] = "\n    General function to translate from control points to actual points\n    using a b-spline representation.\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_3cp2pt = {"cp2pt", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_3cp2pt, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_2cp2pt};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_3cp2pt(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_cp = 0;
  PyObject *__pyx_v_jac = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cp2pt (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_cp,&amp;__pyx_n_s_jac,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cp)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_jac)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cp2pt", 1, 2, 2, 1); __PYX_ERR(0, 146, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cp2pt") &lt; 0)) __PYX_ERR(0, 146, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_cp = values[0];
    __pyx_v_jac = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cp2pt", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 146, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.cp2pt", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_2cp2pt(__pyx_self, __pyx_v_cp, __pyx_v_jac);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_2cp2pt(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_cp, PyObject *__pyx_v_jac) {
  PyObject *__pyx_v_pt = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cp2pt", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.cp2pt", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pt);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__538 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_cp, __pyx_n_s_jac, __pyx_n_s_pt); if (unlikely(!__pyx_tuple__538)) __PYX_ERR(0, 146, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__538);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__538);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_3cp2pt, 0, __pyx_n_s_cp2pt, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__539)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 146, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cp2pt, __pyx_t_2) &lt; 0) __PYX_ERR(0, 146, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__539 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__538, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_cp2pt, 146, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__539)) __PYX_ERR(0, 146, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0147</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0148</span>: <span class="sd">    General function to translate from control points to actual points</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0149</span>: <span class="sd">    using a b-spline representation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0150</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0151</span>:     <span class="n">pt</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">jac</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-34 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 151, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 151, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_jac, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 151, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 151, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 151, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_pt = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0152</span>:     <span class="n">pt</span> <span class="o">=</span> <span class="n">jac</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_jac, __pyx_n_s_dot); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 152, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_cp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 152, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 152, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cp);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cp);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_cp);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 152, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_pt, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0153</span>:     <span class="k">return</span> <span class="n">pt</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pt);
  __pyx_r = __pyx_v_pt;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0154</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0155</span>: </pre>
<pre class="cython line score-87" onclick='toggleDiv(this)'>+<span class="">0156</span>: <span class="k">def</span> <span class="nf">get_bspline_mtx</span><span class="p">(</span><span class="n">num_cp</span><span class="p">,</span> <span class="n">num_pt</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mf">4</span><span class="p">):</span></pre>
<pre class='cython code score-87 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_5get_bspline_mtx(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_4get_bspline_mtx[] = " Create Jacobian to fit a bspline to a set of data.\n    ...from b_spline.py\n\n    Parameters\n    ----------\n    num_cp : int\n        Number of control points.\n    num_pt : int\n        Number of points.\n    order : int, optional\n        Order of b-spline fit.\n\n    Returns\n    -------\n    out : CSR sparse matrix\n        Matrix that gives the points vector when multiplied by the control\n        points vector.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_5get_bspline_mtx = {"get_bspline_mtx", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_5get_bspline_mtx, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_4get_bspline_mtx};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_5get_bspline_mtx(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_num_cp = 0;
  PyObject *__pyx_v_num_pt = 0;
  PyObject *__pyx_v_order = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_bspline_mtx (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_num_cp,&amp;__pyx_n_s_num_pt,&amp;__pyx_n_s_order,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject *)((PyObject *)__pyx_int_4));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_cp)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_pt)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_bspline_mtx", 0, 2, 3, 1); __PYX_ERR(0, 156, __pyx_L3_error)
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_order);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_bspline_mtx") &lt; 0)) __PYX_ERR(0, 156, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_num_cp = values[0];
    __pyx_v_num_pt = values[1];
    __pyx_v_order = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_bspline_mtx", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 156, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.get_bspline_mtx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_4get_bspline_mtx(__pyx_self, __pyx_v_num_cp, __pyx_v_num_pt, __pyx_v_order);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_4get_bspline_mtx(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_num_cp, PyObject *__pyx_v_num_pt, PyObject *__pyx_v_order) {
  PyObject *__pyx_v_knots = NULL;
  PyObject *__pyx_v_t_vec = NULL;
  PyObject *__pyx_v_basis = NULL;
  PyObject *__pyx_v_arange = NULL;
  PyObject *__pyx_v_data = NULL;
  PyObject *__pyx_v_rows = NULL;
  PyObject *__pyx_v_cols = NULL;
  PyObject *__pyx_v_ipt = NULL;
  PyObject *__pyx_v_t = NULL;
  PyObject *__pyx_v_i0 = NULL;
  PyObject *__pyx_v_ind = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_l = NULL;
  PyObject *__pyx_v_j1 = NULL;
  PyObject *__pyx_v_j2 = NULL;
  PyObject *__pyx_v_n = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_bspline_mtx", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.get_bspline_mtx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_knots);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_vec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_basis);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arange);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rows);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cols);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ipt);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_l);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__540 = <span class='py_c_api'>PyTuple_Pack</span>(20, __pyx_n_s_num_cp, __pyx_n_s_num_pt, __pyx_n_s_order, __pyx_n_s_knots, __pyx_n_s_t_vec, __pyx_n_s_basis, __pyx_n_s_arange, __pyx_n_s_data, __pyx_n_s_rows, __pyx_n_s_cols, __pyx_n_s_ipt, __pyx_n_s_t, __pyx_n_s_i0, __pyx_n_s_ind, __pyx_n_s_i, __pyx_n_s_l, __pyx_n_s_j1, __pyx_n_s_j2, __pyx_n_s_n, __pyx_n_s_j); if (unlikely(!__pyx_tuple__540)) __PYX_ERR(0, 156, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__540);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__540);
  __pyx_codeobj__541 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 20, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__540, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_get_bspline_mtx, 156, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__541)) __PYX_ERR(0, 156, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_5get_bspline_mtx, 0, __pyx_n_s_get_bspline_mtx, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__541)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 156, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__542);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_bspline_mtx, __pyx_t_2) &lt; 0) __PYX_ERR(0, 156, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__542 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_int_4)); if (unlikely(!__pyx_tuple__542)) __PYX_ERR(0, 156, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__542);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__542);
</pre><pre class="cython line score-0">&#xA0;<span class="">0157</span>:     <span class="sd">&quot;&quot;&quot; Create Jacobian to fit a bspline to a set of data.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0158</span>: <span class="sd">    ...from b_spline.py</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0159</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0160</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0161</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0162</span>: <span class="sd">    num_cp : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0163</span>: <span class="sd">        Number of control points.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0164</span>: <span class="sd">    num_pt : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0165</span>: <span class="sd">        Number of points.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0166</span>: <span class="sd">    order : int, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0167</span>: <span class="sd">        Order of b-spline fit.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0168</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0169</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0170</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0171</span>: <span class="sd">    out : CSR sparse matrix</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0172</span>: <span class="sd">        Matrix that gives the points vector when multiplied by the control</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0173</span>: <span class="sd">        points vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0174</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0175</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0176</span>:     <span class="n">knots</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_cp</span> <span class="o">+</span> <span class="n">order</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 176, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 176, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_num_cp, __pyx_v_order); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 176, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 176, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 176, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 176, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_knots = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">0177</span>:     <span class="n">knots</span><span class="p">[</span><span class="n">order</span> <span class="o">-</span> <span class="mf">1</span><span class="p">:</span><span class="n">num_cp</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="n">num_cp</span> <span class="o">-</span> <span class="n">order</span> <span class="o">+</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-47 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 177, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_linspace); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 177, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_num_cp, __pyx_v_order); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 177, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_3, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 177, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 177, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_6, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_6, __pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_6, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 177, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_order, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 177, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_num_cp, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 177, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_knots, __pyx_t_1, 0, 0, &amp;__pyx_t_5, &amp;__pyx_t_4, NULL, 0, 0, 1) &lt; 0) __PYX_ERR(0, 177, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0178</span>:     <span class="n">knots</span><span class="p">[</span><span class="n">num_cp</span> <span class="o">+</span> <span class="mf">1</span><span class="p">:]</span> <span class="o">=</span> <span class="mf">1.0</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_num_cp, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_knots, __pyx_float_1_0, 0, 0, &amp;__pyx_t_1, NULL, NULL, 0, 0, 1) &lt; 0) __PYX_ERR(0, 178, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-31" onclick='toggleDiv(this)'>+<span class="">0179</span>:     <span class="n">t_vec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="n">num_pt</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 179, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_linspace); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 179, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 179, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (__pyx_t_4) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_6, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_6, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_pt);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_pt);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2+__pyx_t_6, __pyx_v_num_pt);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 179, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_t_vec = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0180</span>:     <span class="n">basis</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">order</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 180, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 180, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_order); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 180, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 180, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_order);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_order);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_order);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 180, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_basis = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0181</span>:     <span class="n">arange</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">order</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 181, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_arange); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 181, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_order); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 181, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 181, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_order);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_order);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_order);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 181, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_arange = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0182</span>:     <span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_pt</span><span class="p">,</span> <span class="n">order</span><span class="p">))</span></pre>
<pre class='cython code score-38 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 182, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 182, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 182, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_pt);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_pt);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_num_pt);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_order);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_order);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_order);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 182, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 182, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 182, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_data = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-37" onclick='toggleDiv(this)'>+<span class="">0183</span>:     <span class="n">rows</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_pt</span><span class="p">,</span> <span class="n">order</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 183, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 183, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 183, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_pt);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_pt);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_num_pt);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_order);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_order);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_order);
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 183, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (__pyx_t_4) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_6, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyInt_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyInt_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_6, ((PyObject *)(&amp;PyInt_Type)));
  __pyx_t_5 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rows = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-37" onclick='toggleDiv(this)'>+<span class="">0184</span>:     <span class="n">cols</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_pt</span><span class="p">,</span> <span class="n">order</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 184, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 184, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 184, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_pt);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_pt);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_num_pt);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_order);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_order);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_order);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 184, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (__pyx_t_5) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_6, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyInt_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyInt_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_6, ((PyObject *)(&amp;PyInt_Type)));
  __pyx_t_3 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 184, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_cols = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0185</span>:     <span class="k">for</span> <span class="n">ipt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_pt</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 185, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_num_pt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 185, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_pt);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_pt);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_num_pt);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 185, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 185, __pyx_L1_error)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 185, __pyx_L1_error)
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 185, __pyx_L1_error)
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_7(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 185, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ipt, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0186</span>:         <span class="n">t</span> <span class="o">=</span> <span class="n">t_vec</span><span class="p">[</span><span class="n">ipt</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_t_vec, __pyx_v_ipt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 186, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0187</span>:         <span class="n">i0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i0, __pyx_int_neg_1);
</pre><pre class="cython line score-74" onclick='toggleDiv(this)'>+<span class="">0188</span>:         <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">num_cp</span> <span class="o">+</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-74 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 188, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_num_cp, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 188, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_8 = 1;
      }
    }
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 188, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_order);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_order);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_8, __pyx_v_order);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_8, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 188, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_8 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 188, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 188, __pyx_L1_error)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
          if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 188, __pyx_L1_error)
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 188, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 188, __pyx_L1_error)
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 188, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_10(__pyx_t_3);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else __PYX_ERR(0, 188, __pyx_L1_error)
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-31" onclick='toggleDiv(this)'>+<span class="">0189</span>:             <span class="k">if</span> <span class="p">(</span><span class="n">knots</span><span class="p">[</span><span class="n">ind</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">knots</span><span class="p">[</span><span class="n">ind</span><span class="p">]):</span></pre>
<pre class='cython code score-31 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_ind, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 189, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 189, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_9, __pyx_v_t, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 189, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_12 &lt; 0)) __PYX_ERR(0, 189, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_12) {
      } else {
        __pyx_t_11 = __pyx_t_12;
        goto __pyx_L8_bool_binop_done;
      }
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_v_ind); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 189, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_9 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_t, __pyx_t_1, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 189, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_9); if (unlikely(__pyx_t_12 &lt; 0)) __PYX_ERR(0, 189, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_11 = __pyx_t_12;
      __pyx_L8_bool_binop_done:;
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0190</span>:                 <span class="n">i0</span> <span class="o">=</span> <span class="n">ind</span> <span class="o">-</span> <span class="n">order</span></pre>
<pre class='cython code score-6 '>        __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_ind, __pyx_v_order); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 190, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_i0, __pyx_t_9);
        __pyx_t_9 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0191</span>:         <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="n">knots</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-11 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_knots, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 191, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_9 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_t, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 191, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_9); if (unlikely(__pyx_t_11 &lt; 0)) __PYX_ERR(0, 191, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (__pyx_t_11) {
/* … */
    }
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0192</span>:             <span class="n">i0</span> <span class="o">=</span> <span class="n">num_cp</span> <span class="o">-</span> <span class="n">order</span></pre>
<pre class='cython code score-6 '>      __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_num_cp, __pyx_v_order); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 192, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_i0, __pyx_t_9);
      __pyx_t_9 = 0;
</pre><pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">0193</span>:         <span class="n">basis</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-7 '>    if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_basis, __pyx_float_0_, 0, 0, NULL, NULL, &amp;__pyx_slice__6, 0, 0, 1) &lt; 0) __PYX_ERR(0, 193, __pyx_L1_error)
/* … */
  __pyx_slice__6 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__6)) __PYX_ERR(0, 193, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__6);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0194</span>:         <span class="n">basis</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span></pre>
<pre class='cython code score-2 '>    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_basis, -1L, __pyx_float_1_, long, 1, __Pyx_PyInt_From_long, 0, 1, 1) &lt; 0)) __PYX_ERR(0, 194, __pyx_L1_error)
</pre><pre class="cython line score-74" onclick='toggleDiv(this)'>+<span class="">0195</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span> <span class="n">order</span> <span class="o">+</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-74 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 195, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_order, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 195, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_8 = 1;
      }
    }
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 195, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_8, __pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_8, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 195, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_9)) {
      __pyx_t_3 = __pyx_t_9; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_8 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 195, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 195, __pyx_L1_error)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
          if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_8++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 195, __pyx_L1_error)
          #else
          __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 195, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          #endif
        } else {
          if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_8++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 195, __pyx_L1_error)
          #else
          __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 195, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          #endif
        }
      } else {
        __pyx_t_9 = __pyx_t_10(__pyx_t_3);
        if (unlikely(!__pyx_t_9)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else __PYX_ERR(0, 195, __pyx_L1_error)
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_9);
      __pyx_t_9 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-3" onclick='toggleDiv(this)'>+<span class="">0196</span>:             <span class="n">l</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 196, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_l, __pyx_t_9);
      __pyx_t_9 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0197</span>:             <span class="n">j1</span> <span class="o">=</span> <span class="n">order</span> <span class="o">-</span> <span class="n">l</span></pre>
<pre class='cython code score-6 '>      __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_order, __pyx_v_l); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 197, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j1, __pyx_t_9);
      __pyx_t_9 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0198</span>:             <span class="n">j2</span> <span class="o">=</span> <span class="n">order</span></pre>
<pre class='cython code score-2 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_order);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j2, __pyx_v_order);
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0199</span>:             <span class="n">n</span> <span class="o">=</span> <span class="n">i0</span> <span class="o">+</span> <span class="n">j1</span></pre>
<pre class='cython code score-6 '>      __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i0, __pyx_v_j1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 199, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n, __pyx_t_9);
      __pyx_t_9 = 0;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">0200</span>:             <span class="k">if</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="n">l</span><span class="p">]</span> <span class="o">!=</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span></pre>
<pre class='cython code score-26 '>      __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_n, __pyx_v_l); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 200, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 200, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_v_n); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 200, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_9, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 200, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_11 &lt; 0)) __PYX_ERR(0, 200, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_11) {
/* … */
        goto __pyx_L13;
      }
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">0201</span>:                 <span class="n">basis</span><span class="p">[</span><span class="n">j1</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="n">l</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> \</pre>
<pre class='cython code score-30 '>        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_n, __pyx_v_l); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 201, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 201, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_9, __pyx_v_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 201, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 201, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_j1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 201, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_basis, __pyx_t_4, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 201, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">0202</span>:                     <span class="p">(</span><span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="n">l</span><span class="p">]</span> <span class="o">-</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span><span class="p">])</span> <span class="o">*</span> <span class="n">basis</span><span class="p">[</span><span class="n">j1</span><span class="p">]</span></pre>
<pre class='cython code score-35 '>        __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_n, __pyx_v_l); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 202, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 202, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_v_n); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 202, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_5, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 202, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
        __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_basis, __pyx_v_j1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 202, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 202, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0203</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0204</span>:                 <span class="n">basis</span><span class="p">[</span><span class="n">j1</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-8 '>      /*else*/ {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_j1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 204, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_basis, __pyx_t_1, __pyx_float_0_) &lt; 0)) __PYX_ERR(0, 204, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L13:;
</pre><pre class="cython line score-74" onclick='toggleDiv(this)'>+<span class="">0205</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j1</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">j2</span><span class="p">):</span></pre>
<pre class='cython code score-74 '>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 205, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_j1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 205, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_5 = NULL;
      __pyx_t_13 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_13 = 1;
        }
      }
      __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 205, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      if (__pyx_t_5) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_5); __pyx_t_5 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_13, __pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_j2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_13, __pyx_v_j2);
      __pyx_t_9 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_14, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 205, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
        __pyx_t_4 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_13 = 0;
        __pyx_t_15 = NULL;
      } else {
        __pyx_t_13 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 205, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_15 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 205, __pyx_L1_error)
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      for (;;) {
        if (likely(!__pyx_t_15)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
            if (__pyx_t_13 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_13); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_13++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 205, __pyx_L1_error)
            #else
            __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 205, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            #endif
          } else {
            if (__pyx_t_13 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_13); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_13++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 205, __pyx_L1_error)
            #else
            __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 205, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            #endif
          }
        } else {
          __pyx_t_1 = __pyx_t_15(__pyx_t_4);
          if (unlikely(!__pyx_t_1)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else __PYX_ERR(0, 205, __pyx_L1_error)
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j, __pyx_t_1);
        __pyx_t_1 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0206</span>:                 <span class="n">n</span> <span class="o">=</span> <span class="n">i0</span> <span class="o">+</span> <span class="n">j</span></pre>
<pre class='cython code score-6 '>        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i0, __pyx_v_j); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 206, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_n, __pyx_t_1);
        __pyx_t_1 = 0;
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0207</span>:                 <span class="k">if</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="n">l</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-32 '>        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_n, __pyx_v_l); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_n, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        __pyx_t_14 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_9, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_14); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 207, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_14); if (unlikely(__pyx_t_11 &lt; 0)) __PYX_ERR(0, 207, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        if (__pyx_t_11) {
/* … */
          goto __pyx_L16;
        }
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0208</span>:                     <span class="n">basis</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1</span><span class="p">])</span> <span class="o">/</span> \</pre>
<pre class='cython code score-27 '>          __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_n, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 208, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 208, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          __pyx_t_14 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_t, __pyx_t_9); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 208, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_14, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 208, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
          __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_j, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 208, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_basis, __pyx_t_14, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 208, __pyx_L1_error)
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0209</span>:                         <span class="p">(</span><span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="n">l</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">basis</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-44 '>          __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_n, __pyx_v_l); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 209, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_9, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 209, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 209, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_n, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 209, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 209, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_9, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 209, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_j, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 209, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_14 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_basis, __pyx_t_1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 209, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 209, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0210</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0211</span>:                     <span class="n">basis</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-8 '>        /*else*/ {
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_j, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 211, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_basis, __pyx_t_1, __pyx_float_0_) &lt; 0)) __PYX_ERR(0, 211, __pyx_L1_error)
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        }
        __pyx_L16:;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">0212</span>:                 <span class="k">if</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="n">l</span><span class="p">]</span> <span class="o">!=</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span></pre>
<pre class='cython code score-26 '>        __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_n, __pyx_v_l); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_14 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 212, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_v_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_14, __pyx_t_1, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 212, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_11 &lt; 0)) __PYX_ERR(0, 212, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (__pyx_t_11) {
/* … */
        }
</pre><pre class="cython line score-42" onclick='toggleDiv(this)'>+<span class="">0213</span>:                     <span class="n">basis</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="n">l</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> \</pre>
<pre class='cython code score-42 '>          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_j, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 213, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_basis, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 213, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_n, __pyx_v_l); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 213, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 213, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          __pyx_t_14 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_9, __pyx_v_t); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 213, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_14, __pyx_t_17); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 213, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
/* … */
          __pyx_t_17 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_1, __pyx_t_14); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 213, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_basis, __pyx_t_5, __pyx_t_17) &lt; 0)) __PYX_ERR(0, 213, __pyx_L1_error)
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">0214</span>:                         <span class="p">(</span><span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="n">l</span><span class="p">]</span> <span class="o">-</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span><span class="p">])</span> <span class="o">*</span> <span class="n">basis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-35 '>          __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_n, __pyx_v_l); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 214, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_16 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_9); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 214, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_v_n); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 214, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_17 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_16, __pyx_t_9); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 214, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
          __pyx_t_17 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_basis, __pyx_v_j); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 214, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
          __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_17); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 214, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0215</span>:             <span class="n">n</span> <span class="o">=</span> <span class="n">i0</span> <span class="o">+</span> <span class="n">j2</span></pre>
<pre class='cython code score-6 '>      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i0, __pyx_v_j2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 215, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_n, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0216</span>:             <span class="k">if</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="n">l</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-32 '>      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_n, __pyx_v_l); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 216, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 216, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 216, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_n, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 216, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_17 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_5); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 216, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_t_17, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 216, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_11 &lt; 0)) __PYX_ERR(0, 216, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_11) {
/* … */
        goto __pyx_L18;
      }
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0217</span>:                 <span class="n">basis</span><span class="p">[</span><span class="n">j2</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1</span><span class="p">])</span> <span class="o">/</span> \</pre>
<pre class='cython code score-27 '>        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_n, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 217, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_17 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_5); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 217, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_t, __pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 217, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
/* … */
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 217, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_j2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 217, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_basis, __pyx_t_5, __pyx_t_4) &lt; 0)) __PYX_ERR(0, 217, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0218</span>:                     <span class="p">(</span><span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="n">l</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">knots</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">basis</span><span class="p">[</span><span class="n">j2</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-44 '>        __pyx_t_17 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_n, __pyx_v_l); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 218, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_17, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 218, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        __pyx_t_17 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_4); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 218, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_n, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 218, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_14 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_knots, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 218, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_17, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 218, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
/* … */
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_j2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 218, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_basis, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 218, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_14, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 218, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0219</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0220</span>:                 <span class="n">basis</span><span class="p">[</span><span class="n">j2</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-8 '>      /*else*/ {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_j2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 220, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_basis, __pyx_t_4, __pyx_float_0_) &lt; 0)) __PYX_ERR(0, 220, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      __pyx_L18:;
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">0221</span>:         <span class="n">data</span><span class="p">[</span><span class="n">ipt</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">basis</span></pre>
<pre class='cython code score-20 '>    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 221, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ipt);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ipt);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_ipt);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_slice__7);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_data, __pyx_t_3, __pyx_v_basis) &lt; 0)) __PYX_ERR(0, 221, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__7 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__7)) __PYX_ERR(0, 221, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__7);
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">0222</span>:         <span class="n">rows</span><span class="p">[</span><span class="n">ipt</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">ipt</span></pre>
<pre class='cython code score-20 '>    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 222, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ipt);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ipt);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_ipt);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_slice__8);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_rows, __pyx_t_3, __pyx_v_ipt) &lt; 0)) __PYX_ERR(0, 222, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__8 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__8)) __PYX_ERR(0, 222, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__8);
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">0223</span>:         <span class="n">cols</span><span class="p">[</span><span class="n">ipt</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">i0</span> <span class="o">+</span> <span class="n">arange</span></pre>
<pre class='cython code score-26 '>    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i0, __pyx_v_arange); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 223, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 223, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ipt);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ipt);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_ipt);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_slice__9);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_cols, __pyx_t_4, __pyx_t_3) &lt; 0)) __PYX_ERR(0, 223, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__9 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__9)) __PYX_ERR(0, 223, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
</pre><pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0224</span>:     <span class="n">data</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">rows</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">cols</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
<pre class='cython code score-57 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_flatten); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 224, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 224, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 224, __pyx_L1_error)
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_rows, __pyx_n_s_flatten); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 224, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 224, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 224, __pyx_L1_error)
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_cols, __pyx_n_s_flatten); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 224, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_14 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_14)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (__pyx_t_14) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 224, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  } else {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 224, __pyx_L1_error)
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_rows, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_cols, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0225</span>:     <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_pt</span><span class="p">,</span> <span class="n">num_cp</span><span class="p">))</span></pre>
<pre class='cython code score-57 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_scipy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 225, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sparse); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 225, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_csr_matrix); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 225, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 225, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rows);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rows);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_rows);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cols);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cols);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_cols);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 225, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_data);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 225, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 225, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 225, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_pt);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_pt);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_num_pt);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_cp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_cp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_num_cp);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_shape, __pyx_t_5) &lt; 0) __PYX_ERR(0, 225, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 225, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0226</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0227</span>: </pre>
<pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">0228</span>: <span class="k">def</span> <span class="nf">get_inds</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">):</span></pre>
<pre class='cython code score-61 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_7get_inds(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_6get_inds[] = "\n    Calculate and store indices to describe panels for aero and\n    structural analysis.\n\n    Takes in aero_ind with each row containing [nx, ny] and fem_ind with\n    each row containing [n_fem].\n\n    Each outputted row has information for each individually defined surface,\n    stored in the order [nx, ny, n, n_bpts, n_panels, i, i_bpts, i_panels]\n    with the indices    [ 0,  1, 2,      3,        4, 5,      6,        7]\n\n    nx : number of nodes in the chordwise direction\n    ny : number of nodes in the spanwise direction\n    n : total number of nodes\n    n_bpts : total number of b_pts nodes\n    n_panels : total number of panels\n    i : current index of nodes when considering all surfaces\n    i_bpts: current index of b_pts nodes when considering all surfaces\n    i_panels : current index of panels when considering all surfaces\n\n    Simpler than the aero case, the fem_ind array contains:\n    [n_fem, i_fem]\n\n    n_fem : number of fem nodes per surface\n    i_fem : current index of fem nodes when considering all fem nodes\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_7get_inds = {"get_inds", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_7get_inds, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_6get_inds};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_7get_inds(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_aero_ind = 0;
  PyObject *__pyx_v_fem_ind = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_inds (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_aero_ind,&amp;__pyx_n_s_fem_ind,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aero_ind)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_fem_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_inds", 1, 2, 2, 1); __PYX_ERR(0, 228, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_inds") &lt; 0)) __PYX_ERR(0, 228, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_aero_ind = values[0];
    __pyx_v_fem_ind = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_inds", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 228, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.get_inds", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_6get_inds(__pyx_self, __pyx_v_aero_ind, __pyx_v_fem_ind);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_6get_inds(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_aero_ind, PyObject *__pyx_v_fem_ind) {
  PyObject *__pyx_v_new_aero_ind = NULL;
  PyObject *__pyx_v_i = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_row = NULL;
  PyObject *__pyx_v_nx = NULL;
  PyObject *__pyx_v_ny = NULL;
  PyObject *__pyx_v_new_fem_ind = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_inds", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.get_inds", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_new_aero_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_new_fem_ind);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__543 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_aero_ind, __pyx_n_s_fem_ind, __pyx_n_s_new_aero_ind, __pyx_n_s_i, __pyx_n_s_row, __pyx_n_s_nx, __pyx_n_s_ny, __pyx_n_s_new_fem_ind); if (unlikely(!__pyx_tuple__543)) __PYX_ERR(0, 228, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__543);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__543);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_7get_inds, 0, __pyx_n_s_get_inds, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__544)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 228, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_inds, __pyx_t_2) &lt; 0) __PYX_ERR(0, 228, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__544 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__543, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_get_inds, 228, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__544)) __PYX_ERR(0, 228, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0229</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0230</span>: <span class="sd">    Calculate and store indices to describe panels for aero and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0231</span>: <span class="sd">    structural analysis.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0232</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0233</span>: <span class="sd">    Takes in aero_ind with each row containing [nx, ny] and fem_ind with</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0234</span>: <span class="sd">    each row containing [n_fem].</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0235</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0236</span>: <span class="sd">    Each outputted row has information for each individually defined surface,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0237</span>: <span class="sd">    stored in the order [nx, ny, n, n_bpts, n_panels, i, i_bpts, i_panels]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0238</span>: <span class="sd">    with the indices    [ 0,  1, 2,      3,        4, 5,      6,        7]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0239</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0240</span>: <span class="sd">    nx : number of nodes in the chordwise direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0241</span>: <span class="sd">    ny : number of nodes in the spanwise direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0242</span>: <span class="sd">    n : total number of nodes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0243</span>: <span class="sd">    n_bpts : total number of b_pts nodes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0244</span>: <span class="sd">    n_panels : total number of panels</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0245</span>: <span class="sd">    i : current index of nodes when considering all surfaces</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0246</span>: <span class="sd">    i_bpts: current index of b_pts nodes when considering all surfaces</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0247</span>: <span class="sd">    i_panels : current index of panels when considering all surfaces</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0248</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0249</span>: <span class="sd">    Simpler than the aero case, the fem_ind array contains:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0250</span>: <span class="sd">    [n_fem, i_fem]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0251</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0252</span>: <span class="sd">    n_fem : number of fem nodes per surface</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0253</span>: <span class="sd">    i_fem : current index of fem nodes when considering all fem nodes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0254</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0255</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-39" onclick='toggleDiv(this)'>+<span class="">0256</span>:     <span class="n">new_aero_ind</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">aero_ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="mf">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 256, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_aero_ind, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 256, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_8);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 256, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) __PYX_ERR(0, 256, __pyx_L1_error)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 256, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_new_aero_ind = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">0257</span>:     <span class="n">new_aero_ind</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">:</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">aero_ind</span></pre>
<pre class='cython code score-20 '>  __pyx_slice__10 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__10)) __PYX_ERR(0, 257, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__10);
  __pyx_slice__11 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_0, __pyx_int_2, Py_None); if (unlikely(!__pyx_slice__11)) __PYX_ERR(0, 257, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__11);
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_aero_ind, __pyx_tuple__12, __pyx_v_aero_ind) &lt; 0)) __PYX_ERR(0, 257, __pyx_L1_error)
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__10, __pyx_slice__11); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 257, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0258</span>:     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_4 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_aero_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_aero_ind)) {
    __pyx_t_1 = __pyx_v_aero_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_aero_ind); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 258, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 258, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 258, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 258, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 258, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 258, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 258, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4);
    __pyx_t_4 = __pyx_t_3;
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-69" onclick='toggleDiv(this)'>+<span class="">0259</span>:         <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">aero_ind</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-69 '>    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 259, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_slice__13);
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 259, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 259, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 259, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 259, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 259, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_9 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      index = 1; __pyx_t_7 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_7)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_8), 2) &lt; 0) __PYX_ERR(0, 259, __pyx_L1_error)
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 259, __pyx_L1_error)
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_nx, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ny, __pyx_t_7);
    __pyx_t_7 = 0;
/* … */
  __pyx_slice__13 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__13)) __PYX_ERR(0, 259, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__13);
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">0260</span>:         <span class="n">new_aero_ind</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span></pre>
<pre class='cython code score-21 '>    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_ny); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 260, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 260, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_int_2);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_aero_ind, __pyx_t_7, __pyx_t_2) &lt; 0)) __PYX_ERR(0, 260, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">0261</span>:         <span class="n">new_aero_ind</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ny</span></pre>
<pre class='cython code score-24 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nx, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 261, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_v_ny); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 261, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 261, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_3);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_aero_ind, __pyx_t_2, __pyx_t_7) &lt; 0)) __PYX_ERR(0, 261, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0262</span>:         <span class="n">new_aero_ind</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ny</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nx, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 262, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_ny, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 262, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 262, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 262, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_4);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_aero_ind, __pyx_t_2, __pyx_t_3) &lt; 0)) __PYX_ERR(0, 262, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0263</span>:         <span class="n">new_aero_ind</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-73 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 263, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_product); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 263, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_aero_ind, 0, 0, NULL, &amp;__pyx_v_i, NULL, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 263, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_1) &lt; 0) __PYX_ERR(0, 263, __pyx_L1_error)
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_10, __pyx_t_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 263, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    if (!__pyx_t_2) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 263, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_2); __pyx_t_2 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_t_11);
      __pyx_t_11 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 263, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_int_5);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_aero_ind, __pyx_t_7, __pyx_t_3) &lt; 0)) __PYX_ERR(0, 263, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-93" onclick='toggleDiv(this)'>+<span class="">0264</span>:         <span class="n">new_aero_ind</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">aero_ind</span><span class="p">[:</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">aero_ind</span><span class="p">[:</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-93 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 264, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_sum); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 264, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_v_i, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 264, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 264, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_int_0);
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_t_11); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 264, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_7, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 264, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_v_i, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 264, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 264, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 264, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_11, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 264, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 264, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 264, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_7); __pyx_t_7 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 264, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 264, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_int_6);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_aero_ind, __pyx_t_10, __pyx_t_3) &lt; 0)) __PYX_ERR(0, 264, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-76" onclick='toggleDiv(this)'>+<span class="">0265</span>:         <span class="n">new_aero_ind</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-76 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 265, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_sum); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 265, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 265, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_product); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 265, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_aero_ind, 0, 0, NULL, &amp;__pyx_v_i, NULL, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 265, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_10, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 265, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 265, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 265, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_axis, __pyx_int_1) &lt; 0) __PYX_ERR(0, 265, __pyx_L1_error)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_10, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 265, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
      }
    }
    if (!__pyx_t_7) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_t_8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 265, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    } else {
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 265, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_7); __pyx_t_7 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 265, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 265, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_int_7);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_aero_ind, __pyx_t_11, __pyx_t_3) &lt; 0)) __PYX_ERR(0, 265, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0266</span>:     <span class="n">new_fem_ind</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">),</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-44 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 266, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 266, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_fem_ind); if (unlikely(__pyx_t_5 == -1)) __PYX_ERR(0, 266, __pyx_L1_error)
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 266, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 266, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_2);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 266, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 266, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) __PYX_ERR(0, 266, __pyx_L1_error)
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 266, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_new_fem_ind = __pyx_t_11;
  __pyx_t_11 = 0;
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0267</span>:     <span class="n">new_fem_ind</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">fem_ind</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__14 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__14)) __PYX_ERR(0, 267, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__14);
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_fem_ind, __pyx_tuple__15, __pyx_v_fem_ind) &lt; 0)) __PYX_ERR(0, 267, __pyx_L1_error)
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__14, __pyx_int_0); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 267, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0268</span>:     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_11 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_fem_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_fem_ind)) {
    __pyx_t_3 = __pyx_v_fem_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_fem_ind); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 268, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 268, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 268, __pyx_L1_error)
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 268, __pyx_L1_error)
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 268, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_11);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_11, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11);
    __pyx_t_11 = __pyx_t_4;
    __pyx_t_4 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">0269</span>:         <span class="n">new_fem_ind</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span></pre>
<pre class='cython code score-47 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 269, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 269, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_fem_ind, 0, 0, NULL, &amp;__pyx_v_i, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 269, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
      }
    }
    if (!__pyx_t_8) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 269, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else {
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 269, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_8); __pyx_t_8 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_7, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 269, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 269, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_int_1);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_fem_ind, __pyx_t_10, __pyx_t_4) &lt; 0)) __PYX_ERR(0, 269, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0270</span>:     <span class="k">return</span> <span class="n">new_aero_ind</span><span class="p">,</span> <span class="n">new_fem_ind</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 270, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_new_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_new_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_fem_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_new_fem_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_v_new_fem_ind);
  __pyx_r = __pyx_t_11;
  __pyx_t_11 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0271</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0272</span>: </pre>
<pre class="cython line score-62" onclick='toggleDiv(this)'>+<span class="">0273</span>: <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">thetas</span><span class="p">):</span></pre>
<pre class='cython code score-62 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_9rotate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_8rotate[] = "\n    Compute rotation matrices given mesh and rotation angles in degrees.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_9rotate = {"rotate", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_9rotate, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_8rotate};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_9rotate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mesh = 0;
  PyObject *__pyx_v_thetas = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mesh,&amp;__pyx_n_s_thetas,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_thetas)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, 1); __PYX_ERR(0, 273, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rotate") &lt; 0)) __PYX_ERR(0, 273, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_mesh = values[0];
    __pyx_v_thetas = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 273, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_8rotate(__pyx_self, __pyx_v_mesh, __pyx_v_thetas);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_8rotate(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mesh, PyObject *__pyx_v_thetas) {
  PyObject *__pyx_v_te = NULL;
  PyObject *__pyx_v_le = NULL;
  PyObject *__pyx_v_quarter_chord = NULL;
  PyObject *__pyx_v_ny = NULL;
  PyObject *__pyx_v_nx = NULL;
  PyObject *__pyx_v_rad_thetas = NULL;
  PyObject *__pyx_v_mats = NULL;
  PyObject *__pyx_v_ix = NULL;
  PyObject *__pyx_v_row = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_te);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_le);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_quarter_chord);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rad_thetas);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mats);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ix);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__545 = <span class='py_c_api'>PyTuple_Pack</span>(11, __pyx_n_s_mesh, __pyx_n_s_thetas, __pyx_n_s_te, __pyx_n_s_le, __pyx_n_s_quarter_chord, __pyx_n_s_ny, __pyx_n_s_nx, __pyx_n_s_rad_thetas, __pyx_n_s_mats, __pyx_n_s_ix, __pyx_n_s_row); if (unlikely(!__pyx_tuple__545)) __PYX_ERR(0, 273, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__545);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__545);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_9rotate, 0, __pyx_n_s_rotate, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__546)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 273, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_rotate, __pyx_t_2) &lt; 0) __PYX_ERR(0, 273, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__546 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 11, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__545, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_rotate, 273, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__546)) __PYX_ERR(0, 273, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0274</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0275</span>: <span class="sd">    Compute rotation matrices given mesh and rotation angles in degrees.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0276</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0277</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0278</span>:     <span class="n">te</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_mesh, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_te = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0279</span>:     <span class="n">le</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_mesh, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_le = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0280</span>:     <span class="n">quarter_chord</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">te</span> <span class="o">+</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">le</span></pre>
<pre class='cython code score-17 '>  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_25, __pyx_v_te); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 280, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_75, __pyx_v_le); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 280, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 280, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_quarter_chord = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0281</span>:     <span class="n">ny</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 281, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 281, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_ny = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0282</span>:     <span class="n">nx</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 282, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 282, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_nx = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-14" onclick='toggleDiv(this)'>+<span class="">0283</span>:     <span class="n">rad_thetas</span> <span class="o">=</span> <span class="n">thetas</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span></pre>
<pre class='cython code score-14 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 283, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_pi); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 283, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_thetas, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 283, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideObjC</span>(__pyx_t_3, __pyx_float_180_, 180., 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 283, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rad_thetas = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">0284</span>:     <span class="n">mats</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 284, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 284, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 284, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 284, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 284, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) __PYX_ERR(0, 284, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 284, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_mats = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-45" onclick='toggleDiv(this)'>+<span class="">0285</span>:     <span class="n">mats</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rad_thetas</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 285, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cos); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_rad_thetas); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 285, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 285, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rad_thetas);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rad_thetas);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_rad_thetas);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 285, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__16 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__16)) __PYX_ERR(0, 285, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__16);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mats, __pyx_tuple__17, __pyx_t_4) &lt; 0)) __PYX_ERR(0, 285, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__16, __pyx_int_0, __pyx_int_0); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 285, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
</pre><pre class="cython line score-45" onclick='toggleDiv(this)'>+<span class="">0286</span>:     <span class="n">mats</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rad_thetas</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 286, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_rad_thetas); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 286, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rad_thetas);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rad_thetas);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_rad_thetas);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 286, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__18 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__18)) __PYX_ERR(0, 286, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__18);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mats, __pyx_tuple__19, __pyx_t_4) &lt; 0)) __PYX_ERR(0, 286, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__19 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__18, __pyx_int_0, __pyx_int_2); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 286, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__19);
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0287</span>:     <span class="n">mats</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__20 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__20)) __PYX_ERR(0, 287, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__20);
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mats, __pyx_tuple__21, __pyx_int_1) &lt; 0)) __PYX_ERR(0, 287, __pyx_L1_error)
  __pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__20, __pyx_int_1, __pyx_int_1); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 287, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);
</pre><pre class="cython line score-51" onclick='toggleDiv(this)'>+<span class="">0288</span>:     <span class="n">mats</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rad_thetas</span><span class="p">)</span></pre>
<pre class='cython code score-51 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 288, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sin); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_rad_thetas); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 288, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rad_thetas);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rad_thetas);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_v_rad_thetas);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 288, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_slice__22 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__22)) __PYX_ERR(0, 288, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__22);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mats, __pyx_tuple__23, __pyx_t_2) &lt; 0)) __PYX_ERR(0, 288, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__22, __pyx_int_2, __pyx_int_0); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 288, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
</pre><pre class="cython line score-45" onclick='toggleDiv(this)'>+<span class="">0289</span>:     <span class="n">mats</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rad_thetas</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_cos); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_rad_thetas); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 289, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 289, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rad_thetas);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rad_thetas);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_rad_thetas);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 289, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__24 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__24)) __PYX_ERR(0, 289, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__24);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mats, __pyx_tuple__25, __pyx_t_2) &lt; 0)) __PYX_ERR(0, 289, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__25 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__24, __pyx_int_2, __pyx_int_2); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 289, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__25);
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0290</span>:     <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 290, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_nx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 290, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 290, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_nx);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 290, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 290, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 290, __pyx_L1_error)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 290, __pyx_L1_error)
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 290, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 290, __pyx_L1_error)
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 290, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 290, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ix, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0291</span>:         <span class="n">row</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_v_ix); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 291, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-43" onclick='toggleDiv(this)'>+<span class="">0292</span>:         <span class="n">row</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s">&quot;ikj, ij -&gt; ik&quot;</span><span class="p">,</span> <span class="n">mats</span><span class="p">,</span> <span class="n">row</span> <span class="o">-</span> <span class="n">quarter_chord</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 292, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_einsum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 292, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_row, __pyx_v_quarter_chord); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 292, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_8 = 1;
      }
    }
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 292, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_7) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_ikj_ij_ik);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_ikj_ij_ik);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_8, __pyx_kp_s_ikj_ij_ik);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mats);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mats);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_8, __pyx_v_mats);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_8, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 292, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_row, __pyx_t_2, 0, 0, NULL, NULL, &amp;__pyx_slice__26, 0, 0, 1) &lt; 0) __PYX_ERR(0, 292, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__26 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__26)) __PYX_ERR(0, 292, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__26);
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0293</span>:         <span class="n">row</span> <span class="o">+=</span> <span class="n">quarter_chord</span></pre>
<pre class='cython code score-6 '>    __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_row, __pyx_v_quarter_chord); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 293, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_row, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0294</span>:     <span class="k">return</span> <span class="n">mesh</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
  __pyx_r = __pyx_v_mesh;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0295</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0296</span>: </pre>
<pre class="cython line score-64" onclick='toggleDiv(this)'>+<span class="">0297</span>: <span class="k">def</span> <span class="nf">sweep</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span></pre>
<pre class='cython code score-64 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_11sweep(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_10sweep[] = " Apply shearing sweep. Positive sweeps back. ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_11sweep = {"sweep", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_11sweep, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_10sweep};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_11sweep(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mesh = 0;
  PyObject *__pyx_v_angle = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sweep (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mesh,&amp;__pyx_n_s_angle,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_angle)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sweep", 1, 2, 2, 1); __PYX_ERR(0, 297, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sweep") &lt; 0)) __PYX_ERR(0, 297, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_mesh = values[0];
    __pyx_v_angle = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sweep", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 297, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.sweep", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_10sweep(__pyx_self, __pyx_v_mesh, __pyx_v_angle);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_10sweep(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mesh, PyObject *__pyx_v_angle) {
  PyObject *__pyx_v_num_x = NULL;
  PyObject *__pyx_v_num_y = NULL;
  CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
  PyObject *__pyx_v_ny2 = NULL;
  PyObject *__pyx_v_le = NULL;
  PyObject *__pyx_v_y0 = NULL;
  PyObject *__pyx_v_p180 = NULL;
  PyObject *__pyx_v_tan_theta = NULL;
  PyObject *__pyx_v_dx_right = NULL;
  PyObject *__pyx_v_dx_left = NULL;
  PyObject *__pyx_v_dx = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sweep", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.sweep", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_le);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_p180);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tan_theta);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dx_right);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dx_left);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__548 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_mesh, __pyx_n_s_angle, __pyx_n_s_num_x, __pyx_n_s_num_y, __pyx_n_s__547, __pyx_n_s_ny2, __pyx_n_s_le, __pyx_n_s_y0, __pyx_n_s_p180, __pyx_n_s_tan_theta, __pyx_n_s_dx_right, __pyx_n_s_dx_left, __pyx_n_s_dx, __pyx_n_s_i); if (unlikely(!__pyx_tuple__548)) __PYX_ERR(0, 297, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__548);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__548);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_11sweep, 0, __pyx_n_s_sweep, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__549)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sweep, __pyx_t_2) &lt; 0) __PYX_ERR(0, 297, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__549 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__548, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_sweep, 297, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__549)) __PYX_ERR(0, 297, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0298</span>:     <span class="sd">&quot;&quot;&quot; Apply shearing sweep. Positive sweeps back. &quot;&quot;&quot;</span></pre>
<pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0299</span>:     <span class="n">num_x</span><span class="p">,</span> <span class="n">num_y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">shape</span></pre>
<pre class='cython code score-53 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 299, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 3)) {
      if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 299, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 299, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 299, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 299, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 2; __pyx_t_4 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 3) &lt; 0) __PYX_ERR(0, 299, __pyx_L1_error)
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 299, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_num_x = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_num_y = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v__ = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0300</span>:     <span class="n">ny2</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_y</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_num_y, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 300, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_TrueDivideObjC</span>(__pyx_t_1, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 300, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ny2 = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0301</span>:     <span class="n">le</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_mesh, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 301, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_le = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0302</span>:     <span class="n">y0</span> <span class="o">=</span> <span class="n">le</span><span class="p">[</span><span class="n">ny2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-15 '>  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 302, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_ny2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_le, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_y0 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0303</span>:     <span class="n">p180</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_pi); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 303, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_TrueDivideObjC</span>(__pyx_t_4, __pyx_int_180, 0xB4, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_p180 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0304</span>:     <span class="n">tan_theta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">p180</span> <span class="o">*</span> <span class="n">angle</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 304, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_tan); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 304, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_p180, __pyx_v_angle); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 304, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 304, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 304, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 304, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_tan_theta = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-31" onclick='toggleDiv(this)'>+<span class="">0305</span>:     <span class="n">dx_right</span> <span class="o">=</span> <span class="p">(</span><span class="n">le</span><span class="p">[</span><span class="n">ny2</span><span class="p">:,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">tan_theta</span></pre>
<pre class='cython code score-31 '>  __pyx_t_1 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_ny2, Py_None, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 305, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_le, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_v_y0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 305, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_v_tan_theta); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dx_right = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-37" onclick='toggleDiv(this)'>+<span class="">0306</span>:     <span class="n">dx_left</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">le</span><span class="p">[:</span><span class="n">ny2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">tan_theta</span></pre>
<pre class='cython code score-37 '>  __pyx_t_1 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_v_ny2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_le, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_v_y0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_tan_theta); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dx_left = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0307</span>:     <span class="n">dx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">dx_left</span><span class="p">,</span> <span class="n">dx_right</span><span class="p">))</span></pre>
<pre class='cython code score-38 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 307, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_hstack); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 307, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 307, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dx_left);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dx_left);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_dx_left);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dx_right);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dx_right);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_dx_right);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 307, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 307, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 307, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_dx = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0308</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_x</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 308, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_num_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 308, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_x);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_v_num_x);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_5 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 308, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_8 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 308, __pyx_L1_error)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 308, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 308, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_8(__pyx_t_5);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 308, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0309</span>:         <span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dx</span></pre>
<pre class='cython code score-34 '>    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 309, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__27);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__27);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_slice__27);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_0);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 309, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_1, __pyx_v_dx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 309, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mesh, __pyx_t_3, __pyx_t_2) &lt; 0)) __PYX_ERR(0, 309, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__27 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__27)) __PYX_ERR(0, 309, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__27);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0310</span>:     <span class="k">return</span> <span class="n">mesh</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
  __pyx_r = __pyx_v_mesh;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0311</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0312</span>: </pre>
<pre class="cython line score-64" onclick='toggleDiv(this)'>+<span class="">0313</span>: <span class="k">def</span> <span class="nf">dihedral</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span></pre>
<pre class='cython code score-64 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_13dihedral(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_12dihedral[] = " Apply dihedral angle. Positive bends up. ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_13dihedral = {"dihedral", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_13dihedral, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_12dihedral};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_13dihedral(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mesh = 0;
  PyObject *__pyx_v_angle = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dihedral (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mesh,&amp;__pyx_n_s_angle,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_angle)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("dihedral", 1, 2, 2, 1); __PYX_ERR(0, 313, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "dihedral") &lt; 0)) __PYX_ERR(0, 313, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_mesh = values[0];
    __pyx_v_angle = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("dihedral", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 313, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.dihedral", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_12dihedral(__pyx_self, __pyx_v_mesh, __pyx_v_angle);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_12dihedral(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mesh, PyObject *__pyx_v_angle) {
  PyObject *__pyx_v_num_x = NULL;
  PyObject *__pyx_v_num_y = NULL;
  CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
  PyObject *__pyx_v_ny2 = NULL;
  PyObject *__pyx_v_le = NULL;
  PyObject *__pyx_v_y0 = NULL;
  PyObject *__pyx_v_p180 = NULL;
  PyObject *__pyx_v_tan_theta = NULL;
  PyObject *__pyx_v_dx_right = NULL;
  PyObject *__pyx_v_dx_left = NULL;
  PyObject *__pyx_v_dx = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dihedral", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.dihedral", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_le);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_p180);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tan_theta);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dx_right);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dx_left);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__550 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_mesh, __pyx_n_s_angle, __pyx_n_s_num_x, __pyx_n_s_num_y, __pyx_n_s__547, __pyx_n_s_ny2, __pyx_n_s_le, __pyx_n_s_y0, __pyx_n_s_p180, __pyx_n_s_tan_theta, __pyx_n_s_dx_right, __pyx_n_s_dx_left, __pyx_n_s_dx, __pyx_n_s_i); if (unlikely(!__pyx_tuple__550)) __PYX_ERR(0, 313, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__550);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__550);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_13dihedral, 0, __pyx_n_s_dihedral, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__551)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 313, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_dihedral, __pyx_t_2) &lt; 0) __PYX_ERR(0, 313, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__551 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__550, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_dihedral, 313, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__551)) __PYX_ERR(0, 313, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0314</span>:     <span class="sd">&quot;&quot;&quot; Apply dihedral angle. Positive bends up. &quot;&quot;&quot;</span></pre>
<pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0315</span>:     <span class="n">num_x</span><span class="p">,</span> <span class="n">num_y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">shape</span></pre>
<pre class='cython code score-53 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 315, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 3)) {
      if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 315, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 315, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 315, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 315, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 315, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 2; __pyx_t_4 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 3) &lt; 0) __PYX_ERR(0, 315, __pyx_L1_error)
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 315, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_num_x = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_num_y = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v__ = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0316</span>:     <span class="n">ny2</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_y</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_num_y, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 316, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_TrueDivideObjC</span>(__pyx_t_1, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 316, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ny2 = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0317</span>:     <span class="n">le</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_mesh, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 317, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_le = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0318</span>:     <span class="n">y0</span> <span class="o">=</span> <span class="n">le</span><span class="p">[</span><span class="n">ny2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-15 '>  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_ny2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_le, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_y0 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0319</span>:     <span class="n">p180</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_pi); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 319, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_TrueDivideObjC</span>(__pyx_t_4, __pyx_int_180, 0xB4, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_p180 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0320</span>:     <span class="n">tan_theta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">p180</span> <span class="o">*</span> <span class="n">angle</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 320, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_tan); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 320, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_p180, __pyx_v_angle); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 320, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 320, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 320, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 320, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_tan_theta = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-31" onclick='toggleDiv(this)'>+<span class="">0321</span>:     <span class="n">dx_right</span> <span class="o">=</span> <span class="p">(</span><span class="n">le</span><span class="p">[</span><span class="n">ny2</span><span class="p">:,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">tan_theta</span></pre>
<pre class='cython code score-31 '>  __pyx_t_1 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_ny2, Py_None, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 321, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_le, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_v_y0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 321, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_v_tan_theta); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dx_right = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-37" onclick='toggleDiv(this)'>+<span class="">0322</span>:     <span class="n">dx_left</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">le</span><span class="p">[:</span><span class="n">ny2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">tan_theta</span></pre>
<pre class='cython code score-37 '>  __pyx_t_1 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_v_ny2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 322, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 322, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_le, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 322, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_v_y0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 322, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 322, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_tan_theta); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 322, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dx_left = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0323</span>:     <span class="n">dx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">dx_left</span><span class="p">,</span> <span class="n">dx_right</span><span class="p">))</span></pre>
<pre class='cython code score-38 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 323, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_hstack); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 323, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 323, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dx_left);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dx_left);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_dx_left);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dx_right);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dx_right);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_dx_right);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 323, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_dx = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0324</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_x</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 324, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_num_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 324, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_x);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_v_num_x);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_5 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 324, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_8 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 324, __pyx_L1_error)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 324, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 324, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_8(__pyx_t_5);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 324, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0325</span>:         <span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dx</span></pre>
<pre class='cython code score-34 '>    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__28);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__28);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_slice__28);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 325, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_1, __pyx_v_dx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mesh, __pyx_t_3, __pyx_t_2) &lt; 0)) __PYX_ERR(0, 325, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__28 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__28)) __PYX_ERR(0, 325, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__28);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0326</span>:     <span class="k">return</span> <span class="n">mesh</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
  __pyx_r = __pyx_v_mesh;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0327</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0328</span>: </pre>
<pre class="cython line score-59" onclick='toggleDiv(this)'>+<span class="">0329</span>: <span class="k">def</span> <span class="nf">stretch</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span></pre>
<pre class='cython code score-59 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_15stretch(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_14stretch[] = " Stretch mesh in spanwise direction to reach specified length. ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_15stretch = {"stretch", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_15stretch, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_14stretch};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_15stretch(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mesh = 0;
  PyObject *__pyx_v_length = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("stretch (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mesh,&amp;__pyx_n_s_length,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("stretch", 1, 2, 2, 1); __PYX_ERR(0, 329, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "stretch") &lt; 0)) __PYX_ERR(0, 329, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_mesh = values[0];
    __pyx_v_length = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("stretch", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 329, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.stretch", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_14stretch(__pyx_self, __pyx_v_mesh, __pyx_v_length);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_14stretch(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mesh, PyObject *__pyx_v_length) {
  PyObject *__pyx_v_le = NULL;
  PyObject *__pyx_v_num_x = NULL;
  PyObject *__pyx_v_num_y = NULL;
  CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
  PyObject *__pyx_v_span = NULL;
  PyObject *__pyx_v_dy = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("stretch", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.stretch", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_le);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_span);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__552 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_mesh, __pyx_n_s_length, __pyx_n_s_le, __pyx_n_s_num_x, __pyx_n_s_num_y, __pyx_n_s__547, __pyx_n_s_span, __pyx_n_s_dy, __pyx_n_s_i); if (unlikely(!__pyx_tuple__552)) __PYX_ERR(0, 329, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__552);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__552);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_15stretch, 0, __pyx_n_s_stretch, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__553)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 329, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_stretch, __pyx_t_2) &lt; 0) __PYX_ERR(0, 329, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__553 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 9, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__552, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_stretch, 329, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__553)) __PYX_ERR(0, 329, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0330</span>:     <span class="sd">&quot;&quot;&quot; Stretch mesh in spanwise direction to reach specified length. &quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0331</span>:     <span class="n">le</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_mesh, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 331, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_le = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0332</span>:     <span class="n">num_x</span><span class="p">,</span> <span class="n">num_y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">shape</span></pre>
<pre class='cython code score-53 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 332, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 3)) {
      if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 332, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 332, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 332, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 332, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 2; __pyx_t_4 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 3) &lt; 0) __PYX_ERR(0, 332, __pyx_L1_error)
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 332, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_num_x = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_num_y = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v__ = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0333</span>:     <span class="n">span</span> <span class="o">=</span> <span class="n">le</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">le</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-27 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_le, __pyx_tuple__29); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_neg_1, __pyx_int_1); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 333, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
  __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_le, __pyx_tuple__30); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 333, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_span = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_tuple__30 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_1); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 333, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__30);
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">0334</span>:     <span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="n">span</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">num_y</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">num_y</span><span class="p">)</span></pre>
<pre class='cython code score-47 '>  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_length, __pyx_v_span); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 334, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_num_y, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 334, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 334, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 334, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_arange); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 334, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 334, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_7, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_y);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_7, __pyx_v_num_y);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 334, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 334, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_dy = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0335</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_x</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 335, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_num_x); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 335, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 335, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_x);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_num_x);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 335, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_4 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 335, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 335, __pyx_L1_error)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_7++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 335, __pyx_L1_error)
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 335, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_7++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 335, __pyx_L1_error)
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 335, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_8(__pyx_t_4);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 335, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0336</span>:         <span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">:,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dy</span></pre>
<pre class='cython code score-34 '>    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 336, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__31);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__31);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_slice__31);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_1);
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 336, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_5, __pyx_v_dy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 336, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mesh, __pyx_t_2, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 336, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__31 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__31)) __PYX_ERR(0, 336, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__31);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__31);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0337</span>:     <span class="k">return</span> <span class="n">mesh</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
  __pyx_r = __pyx_v_mesh;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0338</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0339</span>: </pre>
<pre class="cython line score-64" onclick='toggleDiv(this)'>+<span class="">0340</span>: <span class="k">def</span> <span class="nf">taper</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">taper_ratio</span><span class="p">):</span></pre>
<pre class='cython code score-64 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_17taper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_16taper[] = " Alter the spanwise chord to produce a tapered wing. ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_17taper = {"taper", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_17taper, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_16taper};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_17taper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mesh = 0;
  PyObject *__pyx_v_taper_ratio = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("taper (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mesh,&amp;__pyx_n_s_taper_ratio,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_taper_ratio)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("taper", 1, 2, 2, 1); __PYX_ERR(0, 340, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "taper") &lt; 0)) __PYX_ERR(0, 340, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_mesh = values[0];
    __pyx_v_taper_ratio = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("taper", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 340, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.taper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_16taper(__pyx_self, __pyx_v_mesh, __pyx_v_taper_ratio);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_16taper(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mesh, PyObject *__pyx_v_taper_ratio) {
  PyObject *__pyx_v_le = NULL;
  PyObject *__pyx_v_te = NULL;
  PyObject *__pyx_v_num_x = NULL;
  PyObject *__pyx_v_num_y = NULL;
  CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
  PyObject *__pyx_v_ny2 = NULL;
  PyObject *__pyx_v_center_chord = NULL;
  PyObject *__pyx_v_taper = NULL;
  PyObject *__pyx_v_jac = NULL;
  PyObject *__pyx_v_dx = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_ind = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("taper", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.taper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_le);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_te);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_center_chord);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_taper);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_jac);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__554 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_mesh, __pyx_n_s_taper_ratio, __pyx_n_s_le, __pyx_n_s_te, __pyx_n_s_num_x, __pyx_n_s_num_y, __pyx_n_s__547, __pyx_n_s_ny2, __pyx_n_s_center_chord, __pyx_n_s_taper, __pyx_n_s_jac, __pyx_n_s_dx, __pyx_n_s_i, __pyx_n_s_ind); if (unlikely(!__pyx_tuple__554)) __PYX_ERR(0, 340, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__554);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__554);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_17taper, 0, __pyx_n_s_taper, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__555)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 340, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_taper, __pyx_t_2) &lt; 0) __PYX_ERR(0, 340, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__555 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__554, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_taper, 340, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__555)) __PYX_ERR(0, 340, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0341</span>:     <span class="sd">&quot;&quot;&quot; Alter the spanwise chord to produce a tapered wing. &quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0342</span>:     <span class="n">le</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_mesh, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 342, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_le = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0343</span>:     <span class="n">te</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_mesh, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 343, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_te = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0344</span>:     <span class="n">num_x</span><span class="p">,</span> <span class="n">num_y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">shape</span></pre>
<pre class='cython code score-53 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 3)) {
      if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 344, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 344, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 344, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 344, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 344, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 2; __pyx_t_4 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 3) &lt; 0) __PYX_ERR(0, 344, __pyx_L1_error)
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 344, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_num_x = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_num_y = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v__ = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0345</span>:     <span class="n">ny2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">num_y</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_num_y, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 345, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_TrueDivideObjC</span>(__pyx_t_1, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 345, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 345, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_ny2 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0346</span>:     <span class="n">center_chord</span> <span class="o">=</span> <span class="o">.</span><span class="mf">5</span> <span class="o">*</span> <span class="n">te</span> <span class="o">+</span> <span class="o">.</span><span class="mf">5</span> <span class="o">*</span> <span class="n">le</span></pre>
<pre class='cython code score-17 '>  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float__5, __pyx_v_te); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 346, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float__5, __pyx_v_le); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 346, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 346, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_center_chord = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-42" onclick='toggleDiv(this)'>+<span class="">0347</span>:     <span class="n">taper</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">taper_ratio</span><span class="p">,</span> <span class="n">ny2</span><span class="p">)[::</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-42 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 347, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_linspace); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 347, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 347, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (__pyx_t_4) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_7, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_taper_ratio);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_taper_ratio);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_7, __pyx_v_taper_ratio);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2+__pyx_t_7, __pyx_v_ny2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 347, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_3, __pyx_slice__32); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 347, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_taper = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_slice__32 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__32)) __PYX_ERR(0, 347, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__32);
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">0348</span>:     <span class="n">jac</span> <span class="o">=</span> <span class="n">get_bspline_mtx</span><span class="p">(</span><span class="n">ny2</span><span class="p">,</span> <span class="n">ny2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_get_bspline_mtx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 348, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 348, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_ny2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_ny2);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 348, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_order, __pyx_int_2) &lt; 0) __PYX_ERR(0, 348, __pyx_L1_error)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 348, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_jac = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0349</span>:     <span class="n">taper</span> <span class="o">=</span> <span class="n">jac</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">taper</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_jac, __pyx_n_s_dot); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 349, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_taper); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 349, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 349, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_taper);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_taper);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_v_taper);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 349, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_taper, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-55" onclick='toggleDiv(this)'>+<span class="">0350</span>:     <span class="n">dx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">taper</span><span class="p">,</span> <span class="n">taper</span><span class="p">[::</span><span class="o">-</span><span class="mf">1</span><span class="p">][</span><span class="mf">1</span><span class="p">:]))</span></pre>
<pre class='cython code score-55 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 350, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_hstack); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 350, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_taper, __pyx_slice__33); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 350, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_slice__33 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__33)) __PYX_ERR(0, 350, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__33);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__33);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_2, 1, 0, NULL, NULL, &amp;__pyx_slice__34, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 350, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 350, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_taper);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_taper);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_taper);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 350, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 350, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 350, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dx = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_slice__34 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__34)) __PYX_ERR(0, 350, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__34);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__34);
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0351</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_x</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 351, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_num_x); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 351, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 351, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_x);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_num_x);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 351, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
    __pyx_t_1 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 351, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 351, __pyx_L1_error)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_7++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 351, __pyx_L1_error)
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 351, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_7++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 351, __pyx_L1_error)
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 351, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_8(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 351, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0352</span>:         <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-57 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 352, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__35, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 352, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      __pyx_t_4 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 352, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_10 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 352, __pyx_L1_error)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
          if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_9++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 352, __pyx_L1_error)
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 352, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          #endif
        } else {
          if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_9++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 352, __pyx_L1_error)
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 352, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          #endif
        }
      } else {
        __pyx_t_2 = __pyx_t_10(__pyx_t_4);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else __PYX_ERR(0, 352, __pyx_L1_error)
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_2);
      __pyx_t_2 = 0;
/* … */
  __pyx_tuple__35 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 352, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__35);
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-23" onclick='toggleDiv(this)'>+<span class="">0353</span>:             <span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-23 '>      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 353, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_i);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__39);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__39);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_slice__39);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_v_ind);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mesh, __pyx_t_5, __pyx_t_2) &lt; 0)) __PYX_ERR(0, 353, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__39 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__39)) __PYX_ERR(0, 353, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__39);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__39);
</pre><pre class="cython line score-82" onclick='toggleDiv(this)'>+<span class="">0354</span>:                 <span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">]</span> <span class="o">-</span> <span class="n">center_chord</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">])</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">center_chord</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span></pre>
<pre class='cython code score-82 '>      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 354, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_i);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__36);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__36);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_slice__36);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_ind);
      __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 354, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__36 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__36)) __PYX_ERR(0, 354, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__36);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__36);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 354, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__37);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__37);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_slice__37);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_ind);
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_center_chord, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 354, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 354, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_v_dx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 354, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_slice__37 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__37)) __PYX_ERR(0, 354, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__37);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__37);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 354, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__38);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__38);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_slice__38);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_ind);
      __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_center_chord, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 354, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 354, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_slice__38 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__38)) __PYX_ERR(0, 354, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__38);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__38);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0355</span>:     <span class="k">return</span> <span class="n">mesh</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
  __pyx_r = __pyx_v_mesh;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0356</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0357</span>: </pre>
<pre class="cython line score-64" onclick='toggleDiv(this)'>+<span class="">0358</span>: <span class="k">def</span> <span class="nf">mirror</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">right_side</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span></pre>
<pre class='cython code score-64 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_19mirror(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_18mirror[] = "\n    Take a half geometry and mirror it across the symmetry plane.\n\n    If right_side==True, it mirrors from right to left,\n    assuming that the first point is on the symmetry plane. Else\n    it mirrors from left to right, assuming the last point is on the\n    symmetry plane.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_19mirror = {"mirror", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_19mirror, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_18mirror};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_19mirror(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mesh = 0;
  PyObject *__pyx_v_right_side = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("mirror (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mesh,&amp;__pyx_n_s_right_side,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)((PyObject *)Py_True));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_right_side);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "mirror") &lt; 0)) __PYX_ERR(0, 358, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_mesh = values[0];
    __pyx_v_right_side = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("mirror", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 358, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.mirror", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_18mirror(__pyx_self, __pyx_v_mesh, __pyx_v_right_side);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_18mirror(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mesh, PyObject *__pyx_v_right_side) {
  PyObject *__pyx_v_num_x = NULL;
  PyObject *__pyx_v_num_y = NULL;
  CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
  PyObject *__pyx_v_new_mesh = NULL;
  PyObject *__pyx_v_mirror_y = NULL;
  PyObject *__pyx_v_y0 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("mirror", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.mirror", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_new_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mirror_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y0);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__556 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_mesh, __pyx_n_s_right_side, __pyx_n_s_num_x, __pyx_n_s_num_y, __pyx_n_s__547, __pyx_n_s_new_mesh, __pyx_n_s_mirror_y, __pyx_n_s_y0); if (unlikely(!__pyx_tuple__556)) __PYX_ERR(0, 358, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__556);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__556);
  __pyx_codeobj__557 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 8, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__556, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_mirror, 358, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__557)) __PYX_ERR(0, 358, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_19mirror, 0, __pyx_n_s_mirror, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__557)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 358, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__558);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_mirror, __pyx_t_2) &lt; 0) __PYX_ERR(0, 358, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__558 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)Py_True)); if (unlikely(!__pyx_tuple__558)) __PYX_ERR(0, 358, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__558);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__558);
</pre><pre class="cython line score-0">&#xA0;<span class="">0359</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0360</span>: <span class="sd">    Take a half geometry and mirror it across the symmetry plane.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0361</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0362</span>: <span class="sd">    If right_side==True, it mirrors from right to left,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0363</span>: <span class="sd">    assuming that the first point is on the symmetry plane. Else</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0364</span>: <span class="sd">    it mirrors from left to right, assuming the last point is on the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0365</span>: <span class="sd">    symmetry plane.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0366</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0367</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0368</span>:     <span class="n">num_x</span><span class="p">,</span> <span class="n">num_y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">shape</span></pre>
<pre class='cython code score-53 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 368, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 3)) {
      if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 368, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 368, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 368, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 368, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 368, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 2; __pyx_t_4 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 3) &lt; 0) __PYX_ERR(0, 368, __pyx_L1_error)
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 368, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_num_x = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_num_y = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v__ = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">0369</span>:     <span class="n">new_mesh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">num_x</span><span class="p">,</span> <span class="mf">2</span> <span class="o">*</span> <span class="n">num_y</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-47 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 369, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 369, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_v_num_y); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 369, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 369, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 369, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_x);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_num_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_3);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 369, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_new_mesh = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-31" onclick='toggleDiv(this)'>+<span class="">0370</span>:     <span class="n">mirror_y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 370, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ones); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 370, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 370, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 370, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 370, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 370, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_mirror_y = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0371</span>:     <span class="n">mirror_y</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span></pre>
<pre class='cython code score-34 '>  __pyx_slice__40 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__40)) __PYX_ERR(0, 371, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__40);
  __pyx_slice__41 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__41)) __PYX_ERR(0, 371, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__41);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__41);
/* … */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__42);
  __pyx_t_7 = __pyx_tuple__42;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mirror_y, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_1, __pyx_float_neg_1_0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 371, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mirror_y, __pyx_t_7, __pyx_t_5) &lt; 0)) __PYX_ERR(0, 371, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_tuple__42 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__40, __pyx_slice__41, __pyx_int_1); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 371, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__42);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__42);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0372</span>:     <span class="k">if</span> <span class="n">right_side</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_right_side); if (unlikely(__pyx_t_8 &lt; 0)) __PYX_ERR(0, 372, __pyx_L1_error)
  if (__pyx_t_8) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-63" onclick='toggleDiv(this)'>+<span class="">0373</span>:         <span class="n">new_mesh</span><span class="p">[:,</span> <span class="p">:</span><span class="n">num_y</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[:,</span> <span class="p">::</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">mirror_y</span></pre>
<pre class='cython code score-63 '>  __pyx_slice__43 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__43)) __PYX_ERR(0, 373, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__43);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__43);
  __pyx_slice__44 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__44)) __PYX_ERR(0, 373, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__44);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__44);
  __pyx_slice__45 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__45)) __PYX_ERR(0, 373, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__45);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__45);
/* … */
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__46); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 373, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_v_mirror_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 373, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_tuple__46 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__43, __pyx_slice__44, __pyx_slice__45); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 373, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__46);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__46);
    __pyx_t_5 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_v_num_y, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 373, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_slice__47 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__47)) __PYX_ERR(0, 373, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__47);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__47);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 373, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__47);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__47);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_slice__47);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__48);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__48);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_slice__48);
    __pyx_t_5 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_mesh, __pyx_t_2, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 373, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_slice__48 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__48)) __PYX_ERR(0, 373, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__48);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__48);
</pre><pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0374</span>:         <span class="n">new_mesh</span><span class="p">[:,</span> <span class="n">num_y</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[:,</span>   <span class="mf">1</span><span class="p">:,</span> <span class="p">:]</span></pre>
<pre class='cython code score-57 '>  __pyx_slice__49 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__49)) __PYX_ERR(0, 374, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__49);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__49);
  __pyx_slice__50 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__50)) __PYX_ERR(0, 374, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__50);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__50);
  __pyx_slice__51 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__51)) __PYX_ERR(0, 374, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__51);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__51);
/* … */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__52); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_tuple__52 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__49, __pyx_slice__50, __pyx_slice__51); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 374, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__52);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__52);
    __pyx_t_2 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_num_y, Py_None, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 374, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_slice__53 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__53)) __PYX_ERR(0, 374, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__53);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__53);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 374, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__53);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__53);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_slice__53);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__54);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__54);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_slice__54);
    __pyx_t_2 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_mesh, __pyx_t_5, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 374, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_slice__54 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__54)) __PYX_ERR(0, 374, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__54);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__54);
</pre><pre class="cython line score-0">&#xA0;<span class="">0375</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0376</span>:         <span class="n">new_mesh</span><span class="p">[:,</span> <span class="p">:</span><span class="n">num_y</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[:,</span> <span class="p">::</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-57 '>  /*else*/ {
/* … */
  __pyx_slice__55 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__55)) __PYX_ERR(0, 376, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__55);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__55);
  __pyx_slice__56 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__56)) __PYX_ERR(0, 376, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__56);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__56);
  __pyx_slice__57 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__57)) __PYX_ERR(0, 376, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__57);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__57);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__58); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 376, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_tuple__58 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__55, __pyx_slice__56, __pyx_slice__57); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(0, 376, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__58);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__58);
    __pyx_t_5 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_v_num_y, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 376, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_slice__59 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__59)) __PYX_ERR(0, 376, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__59);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__59);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 376, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__59);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__59);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_slice__59);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__60);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__60);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_slice__60);
    __pyx_t_5 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_mesh, __pyx_t_2, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 376, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_slice__60 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__60)) __PYX_ERR(0, 376, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__60);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__60);
</pre><pre class="cython line score-89" onclick='toggleDiv(this)'>+<span class="">0377</span>:         <span class="n">new_mesh</span><span class="p">[:,</span> <span class="n">num_y</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[:,</span>   <span class="mf">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">mirror_y</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">:,</span> <span class="p">:]</span></pre>
<pre class='cython code score-89 '>  __pyx_slice__61 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__61)) __PYX_ERR(0, 377, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__61);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__61);
  __pyx_slice__62 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__62)) __PYX_ERR(0, 377, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__62);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__62);
  __pyx_slice__63 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__63)) __PYX_ERR(0, 377, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__63);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__63);
/* … */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 377, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_tuple__64 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__61, __pyx_slice__62, __pyx_slice__63); if (unlikely(!__pyx_tuple__64)) __PYX_ERR(0, 377, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__64);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__64);
  __pyx_slice__65 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__65)) __PYX_ERR(0, 377, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__65);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__65);
  __pyx_slice__66 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__66)) __PYX_ERR(0, 377, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__66);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__66);
  __pyx_slice__67 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__67)) __PYX_ERR(0, 377, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__67);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__67);
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mirror_y, __pyx_tuple__68); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 377, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 377, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__68 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__65, __pyx_slice__66, __pyx_slice__67); if (unlikely(!__pyx_tuple__68)) __PYX_ERR(0, 377, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__68);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__68);
    __pyx_t_2 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_num_y, Py_None, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 377, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_slice__69 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__69)) __PYX_ERR(0, 377, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__69);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__69);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 377, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__69);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__69);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__69);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__70);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__70);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_slice__70);
    __pyx_t_2 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_mesh, __pyx_t_1, __pyx_t_5) &lt; 0)) __PYX_ERR(0, 377, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_L5:;
  __pyx_slice__70 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__70)) __PYX_ERR(0, 377, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__70);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__70);
</pre><pre class="cython line score-0">&#xA0;<span class="">0378</span>:     <span class="c"># shift so 0 is at the left wing tip (structures wants it that way)</span></pre>
<pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0379</span>:     <span class="n">y0</span> <span class="o">=</span> <span class="n">new_mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>  __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_new_mesh, __pyx_tuple__71); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 379, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_v_y0 = __pyx_t_5;
  __pyx_t_5 = 0;
/* … */
  __pyx_tuple__71 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_0, __pyx_int_1); if (unlikely(!__pyx_tuple__71)) __PYX_ERR(0, 379, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__71);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__71);
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0380</span>:     <span class="n">new_mesh</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">y0</span></pre>
<pre class='cython code score-34 '>  __pyx_slice__72 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__72)) __PYX_ERR(0, 380, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__72);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__72);
  __pyx_slice__73 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__73)) __PYX_ERR(0, 380, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__73);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__73);
/* … */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__74);
  __pyx_t_7 = __pyx_tuple__74;
  __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_new_mesh, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 380, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceSubtract</span>(__pyx_t_5, __pyx_v_y0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 380, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_mesh, __pyx_t_7, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 380, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_tuple__74 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__72, __pyx_slice__73, __pyx_int_1); if (unlikely(!__pyx_tuple__74)) __PYX_ERR(0, 380, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__74);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__74);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0381</span>:     <span class="k">return</span> <span class="n">new_mesh</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_mesh);
  __pyx_r = __pyx_v_new_mesh;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0382</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0383</span>: </pre>
<pre class="cython line score-104" onclick='toggleDiv(this)'>+<span class="">0384</span>: <span class="k">def</span> <span class="nf">gen_crm_mesh</span><span class="p">(</span><span class="n">n_points_inboard</span><span class="o">=</span><span class="mf">3</span><span class="p">,</span> <span class="n">n_points_outboard</span><span class="o">=</span><span class="mf">4</span><span class="p">,</span></pre>
<pre class='cython code score-104 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_21gen_crm_mesh(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_20gen_crm_mesh[] = "\n    Build the right hand side of the CRM wing with specified number\n    of inboard and outboard panels.\n\n    n_points_inboard : int\n        Number of spanwise points between the wing root and yehudi break per\n        wing side.\n    n_points_outboard : int\n        Number of spanwise points between the yehudi break and wingtip per\n        wing side.\n    num_x : int\n        Number of chordwise points.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_21gen_crm_mesh = {"gen_crm_mesh", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_21gen_crm_mesh, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_20gen_crm_mesh};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_21gen_crm_mesh(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_n_points_inboard = 0;
  PyObject *__pyx_v_n_points_outboard = 0;
  PyObject *__pyx_v_num_x = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gen_crm_mesh (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n_points_inboard,&amp;__pyx_n_s_n_points_outboard,&amp;__pyx_n_s_num_x,0};
    PyObject* values[3] = {0,0,0};
    values[0] = ((PyObject *)((PyObject *)__pyx_int_3));
    values[1] = ((PyObject *)((PyObject *)__pyx_int_4));
    values[2] = ((PyObject *)((PyObject *)__pyx_int_2));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_n_points_inboard);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_n_points_outboard);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_x);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gen_crm_mesh") &lt; 0)) __PYX_ERR(0, 384, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_n_points_inboard = values[0];
    __pyx_v_n_points_outboard = values[1];
    __pyx_v_num_x = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gen_crm_mesh", 0, 0, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 384, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.gen_crm_mesh", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_20gen_crm_mesh(__pyx_self, __pyx_v_n_points_inboard, __pyx_v_n_points_outboard, __pyx_v_num_x);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_20gen_crm_mesh(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n_points_inboard, PyObject *__pyx_v_n_points_outboard, PyObject *__pyx_v_num_x) {
  PyObject *__pyx_v_raw_crm_points = NULL;
  PyObject *__pyx_v_crm_base_points = NULL;
  PyObject *__pyx_v_le_base = NULL;
  PyObject *__pyx_v_te_base = NULL;
  PyObject *__pyx_v_mesh = NULL;
  PyObject *__pyx_v_s1 = NULL;
  PyObject *__pyx_v_o1 = NULL;
  PyObject *__pyx_v_s2 = NULL;
  PyObject *__pyx_v_o2 = NULL;
  PyObject *__pyx_v_s3 = NULL;
  PyObject *__pyx_v_o3 = NULL;
  PyObject *__pyx_v_s4 = NULL;
  PyObject *__pyx_v_o4 = NULL;
  PyObject *__pyx_v_n_points_total = NULL;
  PyObject *__pyx_v_half_mesh = NULL;
  PyObject *__pyx_v_dy = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_v_yehudi_break = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_full_mesh = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gen_crm_mesh", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.gen_crm_mesh", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_raw_crm_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_crm_base_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_le_base);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_te_base);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_o1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_o2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_o3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_o4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_points_total);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_half_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yehudi_break);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_full_mesh);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__559 = <span class='py_c_api'>PyTuple_Pack</span>(24, __pyx_n_s_n_points_inboard, __pyx_n_s_n_points_outboard, __pyx_n_s_num_x, __pyx_n_s_raw_crm_points, __pyx_n_s_crm_base_points, __pyx_n_s_le_base, __pyx_n_s_te_base, __pyx_n_s_mesh, __pyx_n_s_s1, __pyx_n_s_o1, __pyx_n_s_s2, __pyx_n_s_o2, __pyx_n_s_s3, __pyx_n_s_o3, __pyx_n_s_s4, __pyx_n_s_o4, __pyx_n_s_n_points_total, __pyx_n_s_half_mesh, __pyx_n_s_dy, __pyx_n_s_i, __pyx_n_s_y, __pyx_n_s_yehudi_break, __pyx_n_s_j, __pyx_n_s_full_mesh); if (unlikely(!__pyx_tuple__559)) __PYX_ERR(0, 384, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__559);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__559);
  __pyx_codeobj__560 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 24, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__559, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_gen_crm_mesh, 384, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__560)) __PYX_ERR(0, 384, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_21gen_crm_mesh, 0, __pyx_n_s_gen_crm_mesh, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__560)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 384, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__561);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_gen_crm_mesh, __pyx_t_2) &lt; 0) __PYX_ERR(0, 384, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__561 = <span class='py_c_api'>PyTuple_Pack</span>(3, ((PyObject *)__pyx_int_3), ((PyObject *)__pyx_int_4), ((PyObject *)__pyx_int_2)); if (unlikely(!__pyx_tuple__561)) __PYX_ERR(0, 384, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__561);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__561);
</pre><pre class="cython line score-0">&#xA0;<span class="">0385</span>:                  <span class="n">num_x</span><span class="o">=</span><span class="mf">2</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0386</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0387</span>: <span class="sd">    Build the right hand side of the CRM wing with specified number</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0388</span>: <span class="sd">    of inboard and outboard panels.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0389</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0390</span>: <span class="sd">    n_points_inboard : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0391</span>: <span class="sd">        Number of spanwise points between the wing root and yehudi break per</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0392</span>: <span class="sd">        wing side.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0393</span>: <span class="sd">    n_points_outboard : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0394</span>: <span class="sd">        Number of spanwise points between the yehudi break and wingtip per</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0395</span>: <span class="sd">        wing side.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0396</span>: <span class="sd">    num_x : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0397</span>: <span class="sd">        Number of chordwise points.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0398</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0399</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0400</span>:     <span class="c">#   crm base mesh from crm_data.py</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0401</span>:     <span class="c"># eta, xle, yle, zle, twist, chord</span></pre>
<pre class="cython line score-54" onclick='toggleDiv(this)'>+<span class="">0402</span>:     <span class="n">raw_crm_points</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span></pre>
<pre class='cython code score-54 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 402, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 402, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_23 = <span class='py_c_api'>PyList_New</span>(20); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 402, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 2, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 3, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 4, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 5, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 6, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 7, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 8, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 9, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 10, __pyx_t_13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 11, __pyx_t_14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 12, __pyx_t_15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_16);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 13, __pyx_t_16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 14, __pyx_t_17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 15, __pyx_t_18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 16, __pyx_t_19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 17, __pyx_t_20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 18, __pyx_t_21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_23, 19, __pyx_t_22);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
  __pyx_t_7 = 0;
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_10 = 0;
  __pyx_t_11 = 0;
  __pyx_t_12 = 0;
  __pyx_t_13 = 0;
  __pyx_t_14 = 0;
  __pyx_t_15 = 0;
  __pyx_t_16 = 0;
  __pyx_t_17 = 0;
  __pyx_t_18 = 0;
  __pyx_t_19 = 0;
  __pyx_t_20 = 0;
  __pyx_t_21 = 0;
  __pyx_t_22 = 0;
  __pyx_t_22 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_22 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_22)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_22);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_22) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_23); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 402, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 402, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_22); __pyx_t_22 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0+1, __pyx_t_23);
    __pyx_t_23 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_21, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 402, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_raw_crm_points = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0403</span>:         <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">904.294</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">174.126</span><span class="p">,</span> <span class="mf">6.7166</span><span class="p">,</span> <span class="mf">536.181</span><span class="p">],</span>  <span class="c"># 0</span></pre>
<pre class='cython code score-17 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 403, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_float_0_);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_904_294);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_904_294);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_float_904_294);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_float_0_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_174_126);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_174_126);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, __pyx_float_174_126);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_6_7166);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_6_7166);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, __pyx_float_6_7166);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_536_181);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_536_181);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, __pyx_float_536_181);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0404</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">1</span><span class="p">,</span> <span class="mf">989.505</span><span class="p">,</span> <span class="mf">115.675</span><span class="p">,</span> <span class="mf">175.722</span><span class="p">,</span> <span class="mf">4.4402</span><span class="p">,</span> <span class="mf">468.511</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 404, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_float__1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_989_505);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_989_505);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_float_989_505);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_115_675);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_115_675);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_float_115_675);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_175_722);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_175_722);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, __pyx_float_175_722);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_4_4402);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_4_4402);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 4, __pyx_float_4_4402);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_468_511);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_468_511);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 5, __pyx_float_468_511);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0405</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">15</span><span class="p">,</span> <span class="mf">1032.133</span><span class="p">,</span> <span class="mf">173.513</span><span class="p">,</span> <span class="mf">176.834</span><span class="p">,</span> <span class="mf">3.6063</span><span class="p">,</span> <span class="mf">434.764</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 405, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__15);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_float__15);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1032_133);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1032_133);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_float_1032_133);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_173_513);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_173_513);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, __pyx_float_173_513);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_176_834);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_176_834);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, __pyx_float_176_834);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_3_6063);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_3_6063);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 4, __pyx_float_3_6063);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_434_764);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_434_764);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 5, __pyx_float_434_764);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0406</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">2</span><span class="p">,</span> <span class="mf">1076.030</span><span class="p">,</span> <span class="mf">231.351</span><span class="p">,</span> <span class="mf">177.912</span><span class="p">,</span> <span class="mf">2.2419</span><span class="p">,</span> <span class="mf">400.835</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 406, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_float__2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1076_030);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1076_030);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_float_1076_030);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_231_351);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_231_351);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_float_231_351);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_177_912);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_177_912);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_float_177_912);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_2_2419);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_2_2419);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 4, __pyx_float_2_2419);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_400_835);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_400_835);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 5, __pyx_float_400_835);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0407</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">25</span><span class="p">,</span> <span class="mf">1120.128</span><span class="p">,</span> <span class="mf">289.188</span><span class="p">,</span> <span class="mf">177.912</span><span class="p">,</span> <span class="mf">2.2419</span><span class="p">,</span> <span class="mf">366.996</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 407, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__25);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 0, __pyx_float__25);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1120_128);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1120_128);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 1, __pyx_float_1120_128);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_289_188);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_289_188);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 2, __pyx_float_289_188);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_177_912);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_177_912);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 3, __pyx_float_177_912);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_2_2419);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_2_2419);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 4, __pyx_float_2_2419);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_366_996);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_366_996);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 5, __pyx_float_366_996);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0408</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">3</span><span class="p">,</span> <span class="mf">1164.153</span><span class="p">,</span> <span class="mf">347.026</span><span class="p">,</span> <span class="mf">178.886</span><span class="p">,</span> <span class="mf">1.5252</span><span class="p">,</span> <span class="mf">333.157</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 408, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_float__3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1164_153);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1164_153);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_float_1164_153);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_347_026);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_347_026);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 2, __pyx_float_347_026);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_178_886);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_178_886);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 3, __pyx_float_178_886);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1_5252);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1_5252);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 4, __pyx_float_1_5252);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_333_157);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_333_157);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 5, __pyx_float_333_157);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0409</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">35</span><span class="p">,</span> <span class="mf">1208.203</span><span class="p">,</span> <span class="mf">404.864</span><span class="p">,</span> <span class="mf">180.359</span><span class="p">,</span> <span class="o">.</span><span class="mf">9379</span><span class="p">,</span> <span class="mf">299.317</span><span class="p">],</span>  <span class="c"># 6 yehudi break</span></pre>
<pre class='cython code score-17 '>  __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 409, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__35);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_float__35);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1208_203);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1208_203);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 1, __pyx_float_1208_203);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_404_864);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_404_864);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 2, __pyx_float_404_864);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_180_359);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_180_359);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 3, __pyx_float_180_359);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__9379);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__9379);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 4, __pyx_float__9379);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_299_317);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_299_317);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 5, __pyx_float_299_317);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0410</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">4</span><span class="p">,</span> <span class="mf">1252.246</span><span class="p">,</span> <span class="mf">462.701</span><span class="p">,</span> <span class="mf">182.289</span><span class="p">,</span> <span class="o">.</span><span class="mf">4285</span><span class="p">,</span> <span class="mf">277.288</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 410, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_float__4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1252_246);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1252_246);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_float_1252_246);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_462_701);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_462_701);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 2, __pyx_float_462_701);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_182_289);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_182_289);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 3, __pyx_float_182_289);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__4285);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__4285);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 4, __pyx_float__4285);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_277_288);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_277_288);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 5, __pyx_float_277_288);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0411</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">45</span><span class="p">,</span> <span class="mf">1296.289</span><span class="p">,</span> <span class="mf">520.539</span><span class="p">,</span> <span class="mf">184.904</span><span class="p">,</span> <span class="o">-.</span><span class="mf">2621</span><span class="p">,</span> <span class="mf">263</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_11 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 411, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__45);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__45);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 0, __pyx_float__45);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1296_289);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1296_289);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 1, __pyx_float_1296_289);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_520_539);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_520_539);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 2, __pyx_float_520_539);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_184_904);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_184_904);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 3, __pyx_float_184_904);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_neg__2621);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_neg__2621);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 4, __pyx_float_neg__2621);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_263);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_263);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 5, __pyx_int_263);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0412</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">5</span><span class="p">,</span> <span class="mf">1340.329</span><span class="p">,</span> <span class="mf">578.377</span><span class="p">,</span> <span class="mf">188.389</span><span class="p">,</span> <span class="o">-.</span><span class="mf">6782</span><span class="p">,</span> <span class="mf">248.973</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_12 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 412, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 0, __pyx_float__5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1340_329);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1340_329);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 1, __pyx_float_1340_329);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_578_377);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_578_377);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 2, __pyx_float_578_377);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_188_389);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_188_389);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 3, __pyx_float_188_389);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_neg__6782);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_neg__6782);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 4, __pyx_float_neg__6782);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_248_973);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_248_973);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 5, __pyx_float_248_973);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0413</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">55</span><span class="p">,</span> <span class="mf">1384.375</span><span class="p">,</span> <span class="mf">636.214</span><span class="p">,</span> <span class="mf">192.736</span><span class="p">,</span> <span class="o">-.</span><span class="mf">9436</span><span class="p">,</span> <span class="mf">234.816</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_13 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 413, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__55);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__55);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 0, __pyx_float__55);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1384_375);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1384_375);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 1, __pyx_float_1384_375);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_636_214);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_636_214);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 2, __pyx_float_636_214);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_192_736);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_192_736);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 3, __pyx_float_192_736);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_neg__9436);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_neg__9436);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 4, __pyx_float_neg__9436);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_234_816);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_234_816);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 5, __pyx_float_234_816);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0414</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">60</span><span class="p">,</span> <span class="mf">1428.416</span><span class="p">,</span> <span class="mf">694.052</span><span class="p">,</span> <span class="mf">197.689</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2067</span><span class="p">,</span> <span class="mf">220.658</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_14 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 414, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__60);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__60);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 0, __pyx_float__60);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1428_416);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1428_416);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 1, __pyx_float_1428_416);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_694_052);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_694_052);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 2, __pyx_float_694_052);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_197_689);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_197_689);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 3, __pyx_float_197_689);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_neg_1_2067);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_neg_1_2067);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 4, __pyx_float_neg_1_2067);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_220_658);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_220_658);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 5, __pyx_float_220_658);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0415</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">65</span><span class="p">,</span> <span class="mf">1472.458</span><span class="p">,</span> <span class="mf">751.890</span><span class="p">,</span> <span class="mf">203.294</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4526</span><span class="p">,</span> <span class="mf">206.501</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_15 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 415, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__65);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__65);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 0, __pyx_float__65);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1472_458);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1472_458);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 1, __pyx_float_1472_458);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_751_890);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_751_890);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 2, __pyx_float_751_890);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_203_294);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_203_294);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 3, __pyx_float_203_294);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_neg_1_4526);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_neg_1_4526);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 4, __pyx_float_neg_1_4526);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_206_501);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_206_501);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 5, __pyx_float_206_501);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0416</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">7</span><span class="p">,</span> <span class="mf">1516.504</span><span class="p">,</span> <span class="mf">809.727</span><span class="p">,</span> <span class="mf">209.794</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6350</span><span class="p">,</span> <span class="mf">192.344</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_16 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 416, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_16, 0, __pyx_float__7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1516_504);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1516_504);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_16, 1, __pyx_float_1516_504);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_809_727);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_809_727);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_16, 2, __pyx_float_809_727);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_209_794);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_209_794);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_16, 3, __pyx_float_209_794);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_neg_1_6350);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_neg_1_6350);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_16, 4, __pyx_float_neg_1_6350);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_192_344);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_192_344);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_16, 5, __pyx_float_192_344);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0417</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">75</span><span class="p">,</span> <span class="mf">1560.544</span><span class="p">,</span> <span class="mf">867.565</span><span class="p">,</span> <span class="mf">217.084</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8158</span><span class="p">,</span> <span class="mf">178.186</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_17 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 417, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__75);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__75);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_17, 0, __pyx_float__75);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1560_544);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1560_544);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_17, 1, __pyx_float_1560_544);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_867_565);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_867_565);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_17, 2, __pyx_float_867_565);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_217_084);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_217_084);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_17, 3, __pyx_float_217_084);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_neg_1_8158);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_neg_1_8158);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_17, 4, __pyx_float_neg_1_8158);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_178_186);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_178_186);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_17, 5, __pyx_float_178_186);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0418</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">8</span><span class="p">,</span> <span class="mf">1604.576</span><span class="p">,</span> <span class="mf">925.402</span><span class="p">,</span> <span class="mf">225.188</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0301</span><span class="p">,</span> <span class="mf">164.029</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_18 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 418, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_18, 0, __pyx_float__8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1604_576);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1604_576);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_18, 1, __pyx_float_1604_576);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_925_402);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_925_402);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_18, 2, __pyx_float_925_402);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_225_188);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_225_188);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_18, 3, __pyx_float_225_188);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_neg_2_0301);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_neg_2_0301);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_18, 4, __pyx_float_neg_2_0301);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_164_029);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_164_029);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_18, 5, __pyx_float_164_029);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0419</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">85</span><span class="p">,</span> <span class="mf">1648.616</span><span class="p">,</span> <span class="mf">983.240</span><span class="p">,</span> <span class="mf">234.082</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.2772</span><span class="p">,</span> <span class="mf">149.872</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_19 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 419, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__85);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__85);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_19, 0, __pyx_float__85);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1648_616);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1648_616);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_19, 1, __pyx_float_1648_616);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_983_240);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_983_240);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_19, 2, __pyx_float_983_240);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_234_082);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_234_082);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_19, 3, __pyx_float_234_082);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_neg_2_2772);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_neg_2_2772);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_19, 4, __pyx_float_neg_2_2772);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_149_872);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_149_872);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_19, 5, __pyx_float_149_872);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0420</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">9</span><span class="p">,</span> <span class="mf">1692.659</span><span class="p">,</span> <span class="mf">1041.078</span><span class="p">,</span> <span class="mf">243.625</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5773</span><span class="p">,</span> <span class="mf">135.714</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_20 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 420, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 0, __pyx_float__9);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1692_659);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1692_659);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 1, __pyx_float_1692_659);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1041_078);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1041_078);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 2, __pyx_float_1041_078);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_243_625);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_243_625);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 3, __pyx_float_243_625);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_neg_2_5773);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_neg_2_5773);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 4, __pyx_float_neg_2_5773);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_135_714);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_135_714);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 5, __pyx_float_135_714);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0421</span>:         <span class="p">[</span><span class="o">.</span><span class="mf">95</span><span class="p">,</span> <span class="mf">1736.710</span><span class="p">,</span> <span class="mf">1098.915</span><span class="p">,</span> <span class="mf">253.691</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.1248</span><span class="p">,</span> <span class="mf">121.557</span><span class="p">],</span></pre>
<pre class='cython code score-17 '>  __pyx_t_21 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 421, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__95);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__95);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_21, 0, __pyx_float__95);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1736_710);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1736_710);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_21, 1, __pyx_float_1736_710);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1098_915);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1098_915);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_21, 2, __pyx_float_1098_915);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_253_691);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_253_691);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_21, 3, __pyx_float_253_691);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_neg_3_1248);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_neg_3_1248);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_21, 4, __pyx_float_neg_3_1248);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_121_557);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_121_557);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_21, 5, __pyx_float_121_557);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0422</span>:         <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1780.737</span><span class="p">,</span> <span class="mf">1156.753</span><span class="p">,</span> <span class="mf">263.827</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.75</span><span class="p">,</span> <span class="mf">107.4</span><span class="p">]</span>  <span class="c"># 19</span></pre>
<pre class='cython code score-17 '>  __pyx_t_22 = <span class='py_c_api'>PyList_New</span>(6); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 422, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1_);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_22, 0, __pyx_float_1_);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1780_737);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1780_737);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_22, 1, __pyx_float_1780_737);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_1156_753);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_1156_753);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_22, 2, __pyx_float_1156_753);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_263_827);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_263_827);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_22, 3, __pyx_float_263_827);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_neg_3_75);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_neg_3_75);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_22, 4, __pyx_float_neg_3_75);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_107_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_107_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_22, 5, __pyx_float_107_4);
</pre><pre class="cython line score-0">&#xA0;<span class="">0423</span>:     <span class="p">])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0424</span>:     <span class="c"># le = numpy.vstack((raw_crm_points[:,1],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0425</span>:     <span class="c">#                 raw_crm_points[:,2],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>:     <span class="c">#                 raw_crm_points[:,3]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>:     <span class="c"># te = numpy.vstack((raw_crm_points[:,1]+raw_crm_points[:,5],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0428</span>:     <span class="c">#                 raw_crm_points[:,2],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0429</span>:     <span class="c">#                 raw_crm_points[:,3]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0430</span>:     <span class="c"># mesh = numpy.empty((2,20,3))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0431</span>:     <span class="c"># mesh[0,:,:] = le.T</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0432</span>:     <span class="c"># mesh[1,:,:] = te.T</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0433</span>:     <span class="c"># mesh *= 0.0254 # convert to meters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0434</span>:     <span class="c"># pull out the 3 key y-locations to define the two linear regions of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0435</span>:     <span class="c"># wing</span></pre>
<pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">0436</span>:     <span class="n">crm_base_points</span> <span class="o">=</span> <span class="n">raw_crm_points</span><span class="p">[(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">6</span><span class="p">,</span> <span class="mf">19</span><span class="p">),</span> <span class="p">:]</span></pre>
<pre class='cython code score-20 '>  __pyx_tuple__75 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_6, __pyx_int_19); if (unlikely(!__pyx_tuple__75)) __PYX_ERR(0, 436, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__75);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__75);
  __pyx_slice__76 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__76)) __PYX_ERR(0, 436, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__76);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__76);
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_raw_crm_points, __pyx_tuple__77); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 436, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_crm_base_points = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__77 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_tuple__75, __pyx_slice__76); if (unlikely(!__pyx_tuple__77)) __PYX_ERR(0, 436, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__77);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__77);
</pre><pre class="cython line score-52" onclick='toggleDiv(this)'>+<span class="">0437</span>:     <span class="n">le_base</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">crm_base_points</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">],</span></pre>
<pre class='cython code score-52 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 437, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_vstack); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 437, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__78 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__78)) __PYX_ERR(0, 437, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__78);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__78);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_crm_base_points, __pyx_tuple__79); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 437, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_tuple__79 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__78, __pyx_int_1); if (unlikely(!__pyx_tuple__79)) __PYX_ERR(0, 437, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__79);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__79);
/* … */
  __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 437, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 1, __pyx_t_23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 2, __pyx_t_22);
  __pyx_t_3 = 0;
  __pyx_t_23 = 0;
  __pyx_t_22 = 0;
  __pyx_t_22 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
    __pyx_t_22 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
    if (likely(__pyx_t_22)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_22);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
    }
  }
  if (!__pyx_t_22) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_20); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 437, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 437, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_22); __pyx_t_22 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0+1, __pyx_t_20);
    __pyx_t_20 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_21, __pyx_t_23, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 437, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_v_le_base = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0438</span>:                             <span class="n">crm_base_points</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__80 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__80)) __PYX_ERR(0, 438, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__80);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__80);
/* … */
  __pyx_t_23 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_crm_base_points, __pyx_tuple__81); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 438, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_tuple__81 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__80, __pyx_int_2); if (unlikely(!__pyx_tuple__81)) __PYX_ERR(0, 438, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__81);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__81);
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0439</span>:                             <span class="n">crm_base_points</span><span class="p">[:,</span> <span class="mf">3</span><span class="p">]))</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__82 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__82)) __PYX_ERR(0, 439, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__82);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__82);
/* … */
  __pyx_t_22 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_crm_base_points, __pyx_tuple__83); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 439, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
  __pyx_tuple__83 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__82, __pyx_int_3); if (unlikely(!__pyx_tuple__83)) __PYX_ERR(0, 439, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__83);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__83);
</pre><pre class="cython line score-74" onclick='toggleDiv(this)'>+<span class="">0440</span>:     <span class="n">te_base</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">crm_base_points</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">crm_base_points</span><span class="p">[:,</span> <span class="mf">5</span><span class="p">],</span></pre>
<pre class='cython code score-74 '>  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 440, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_vstack); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 440, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
/* … */
  __pyx_slice__84 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__84)) __PYX_ERR(0, 440, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__84);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__84);
  __pyx_t_21 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_crm_base_points, __pyx_tuple__85); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 440, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_tuple__85 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__84, __pyx_int_1); if (unlikely(!__pyx_tuple__85)) __PYX_ERR(0, 440, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__85);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__85);
  __pyx_slice__86 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__86)) __PYX_ERR(0, 440, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__86);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__86);
  __pyx_t_20 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_crm_base_points, __pyx_tuple__87); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 440, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  __pyx_t_22 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_21, __pyx_t_20); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 440, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  __pyx_tuple__87 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__86, __pyx_int_5); if (unlikely(!__pyx_tuple__87)) __PYX_ERR(0, 440, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__87);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__87);
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 440, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_22);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_21);
  __pyx_t_22 = 0;
  __pyx_t_20 = 0;
  __pyx_t_21 = 0;
  __pyx_t_21 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_23))) {
    __pyx_t_21 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_23);
    if (likely(__pyx_t_21)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_23);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_23, function);
    }
  }
  if (!__pyx_t_21) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_23, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 440, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 440, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_21); __pyx_t_21 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_23, __pyx_t_20, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 440, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_v_te_base = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0441</span>:                             <span class="n">crm_base_points</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__88 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__88)) __PYX_ERR(0, 441, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__88);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__88);
/* … */
  __pyx_t_20 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_crm_base_points, __pyx_tuple__89); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 441, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  __pyx_tuple__89 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__88, __pyx_int_2); if (unlikely(!__pyx_tuple__89)) __PYX_ERR(0, 441, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__89);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__89);
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0442</span>:                             <span class="n">crm_base_points</span><span class="p">[:,</span> <span class="mf">3</span><span class="p">]))</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__90 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__90)) __PYX_ERR(0, 442, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__90);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__90);
/* … */
  __pyx_t_21 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_crm_base_points, __pyx_tuple__91); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 442, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_tuple__91 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__90, __pyx_int_3); if (unlikely(!__pyx_tuple__91)) __PYX_ERR(0, 442, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__91);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__91);
</pre><pre class="cython line score-18" onclick='toggleDiv(this)'>+<span class="">0443</span>:     <span class="n">mesh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-18 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 443, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 443, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__92 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_2, __pyx_int_3, __pyx_int_3); if (unlikely(!__pyx_tuple__92)) __PYX_ERR(0, 443, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__92);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__92);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_23, __pyx_tuple__93, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 443, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_v_mesh = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__93 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__92); if (unlikely(!__pyx_tuple__93)) __PYX_ERR(0, 443, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__93);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__93);
</pre><pre class="cython line score-23" onclick='toggleDiv(this)'>+<span class="">0444</span>:     <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">le_base</span><span class="o">.</span><span class="n">T</span></pre>
<pre class='cython code score-23 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_le_base, __pyx_n_s_T); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_slice__94 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__94)) __PYX_ERR(0, 444, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__94);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__94);
  __pyx_slice__95 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__95)) __PYX_ERR(0, 444, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__95);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__95);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mesh, __pyx_tuple__96, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 444, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_tuple__96 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_slice__94, __pyx_slice__95); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 444, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__96);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__96);
</pre><pre class="cython line score-23" onclick='toggleDiv(this)'>+<span class="">0445</span>:     <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">te_base</span><span class="o">.</span><span class="n">T</span></pre>
<pre class='cython code score-23 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_te_base, __pyx_n_s_T); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_slice__97 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__97)) __PYX_ERR(0, 445, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__97);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__97);
  __pyx_slice__98 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__98)) __PYX_ERR(0, 445, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__98);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__98);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mesh, __pyx_tuple__99, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 445, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_tuple__99 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_slice__97, __pyx_slice__98); if (unlikely(!__pyx_tuple__99)) __PYX_ERR(0, 445, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__99);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__99);
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">0446</span>:     <span class="n">mesh</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span>  <span class="c"># get rid of the z deflection</span></pre>
<pre class='cython code score-20 '>  __pyx_slice__100 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__100)) __PYX_ERR(0, 446, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__100);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__100);
  __pyx_slice__101 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__101)) __PYX_ERR(0, 446, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__101);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__101);
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mesh, __pyx_tuple__102, __pyx_int_0) &lt; 0)) __PYX_ERR(0, 446, __pyx_L1_error)
  __pyx_tuple__102 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__100, __pyx_slice__101, __pyx_int_2); if (unlikely(!__pyx_tuple__102)) __PYX_ERR(0, 446, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__102);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__102);
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0447</span>:     <span class="n">mesh</span> <span class="o">*=</span> <span class="mf">0.0254</span>  <span class="c"># convert to meters</span></pre>
<pre class='cython code score-6 '>  __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_v_mesh, __pyx_float_0_0254); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 447, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_mesh, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0448</span>:     <span class="c"># LE pre-yehudi</span></pre>
<pre class="cython line score-58" onclick='toggleDiv(this)'>+<span class="">0449</span>:     <span class="n">s1</span> <span class="o">=</span> <span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-58 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__103); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_tuple__103 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_1, __pyx_int_0); if (unlikely(!__pyx_tuple__103)) __PYX_ERR(0, 449, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__103);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__103);
  __pyx_t_23 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__104); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 449, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_20 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_23); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 449, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_tuple__104 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_0, __pyx_int_0); if (unlikely(!__pyx_tuple__104)) __PYX_ERR(0, 449, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__104);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__104);
  __pyx_t_23 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__105); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 449, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_tuple__105 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_1, __pyx_int_1); if (unlikely(!__pyx_tuple__105)) __PYX_ERR(0, 449, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__105);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__105);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__106); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_23, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 449, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_20, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_s1 = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__106 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_0, __pyx_int_1); if (unlikely(!__pyx_tuple__106)) __PYX_ERR(0, 449, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__106);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__106);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0450</span>:     <span class="n">o1</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__107); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_o1 = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__107 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_0, __pyx_int_0); if (unlikely(!__pyx_tuple__107)) __PYX_ERR(0, 450, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__107);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__107);
</pre><pre class="cython line score-0">&#xA0;<span class="">0451</span>:     <span class="c"># TE pre-yehudi</span></pre>
<pre class="cython line score-58" onclick='toggleDiv(this)'>+<span class="">0452</span>:     <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-58 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__108); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_tuple__108 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_1, __pyx_int_0); if (unlikely(!__pyx_tuple__108)) __PYX_ERR(0, 452, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__108);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__108);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__109); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_20 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 452, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__109 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_0, __pyx_int_0); if (unlikely(!__pyx_tuple__109)) __PYX_ERR(0, 452, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__109);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__109);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__110); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_tuple__110 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_1, __pyx_int_1); if (unlikely(!__pyx_tuple__110)) __PYX_ERR(0, 452, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__110);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__110);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__111); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_23 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 452, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_20, __pyx_t_23); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_v_s2 = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__111 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_0, __pyx_int_1); if (unlikely(!__pyx_tuple__111)) __PYX_ERR(0, 452, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__111);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__111);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0453</span>:     <span class="n">o2</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__112); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 453, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_o2 = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__112 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_0, __pyx_int_0); if (unlikely(!__pyx_tuple__112)) __PYX_ERR(0, 453, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__112);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__112);
</pre><pre class="cython line score-0">&#xA0;<span class="">0454</span>:     <span class="c"># LE post-yehudi</span></pre>
<pre class="cython line score-58" onclick='toggleDiv(this)'>+<span class="">0455</span>:     <span class="n">s3</span> <span class="o">=</span> <span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-58 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__113); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 455, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_tuple__113 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_2, __pyx_int_0); if (unlikely(!__pyx_tuple__113)) __PYX_ERR(0, 455, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__113);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__113);
  __pyx_t_23 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__114); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 455, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_20 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_23); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 455, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_tuple__114 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_1, __pyx_int_0); if (unlikely(!__pyx_tuple__114)) __PYX_ERR(0, 455, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__114);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__114);
  __pyx_t_23 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__115); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 455, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_tuple__115 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_2, __pyx_int_1); if (unlikely(!__pyx_tuple__115)) __PYX_ERR(0, 455, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__115);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__115);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__116); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 455, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_23, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 455, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_20, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 455, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_s3 = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__116 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_1, __pyx_int_1); if (unlikely(!__pyx_tuple__116)) __PYX_ERR(0, 455, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__116);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__116);
</pre><pre class="cython line score-33" onclick='toggleDiv(this)'>+<span class="">0456</span>:     <span class="n">o3</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">s3</span> <span class="o">*</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-33 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__117); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 456, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_tuple__117 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_2, __pyx_int_0); if (unlikely(!__pyx_tuple__117)) __PYX_ERR(0, 456, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__117);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__117);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__118); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 456, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_20 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_s3, __pyx_t_3); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 456, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_20); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 456, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  __pyx_v_o3 = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_tuple__118 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_2, __pyx_int_1); if (unlikely(!__pyx_tuple__118)) __PYX_ERR(0, 456, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__118);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__118);
</pre><pre class="cython line score-0">&#xA0;<span class="">0457</span>:     <span class="c"># TE post-yehudi</span></pre>
<pre class="cython line score-58" onclick='toggleDiv(this)'>+<span class="">0458</span>:     <span class="n">s4</span> <span class="o">=</span> <span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-58 '>  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__119); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 458, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_tuple__119 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_2, __pyx_int_0); if (unlikely(!__pyx_tuple__119)) __PYX_ERR(0, 458, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__119);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__119);
  __pyx_t_20 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__120); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 458, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_20); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 458, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  __pyx_tuple__120 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_1, __pyx_int_0); if (unlikely(!__pyx_tuple__120)) __PYX_ERR(0, 458, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__120);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__120);
  __pyx_t_20 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__121); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 458, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
  __pyx_tuple__121 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_2, __pyx_int_1); if (unlikely(!__pyx_tuple__121)) __PYX_ERR(0, 458, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__121);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__121);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__122); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 458, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_23 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_20, __pyx_t_3); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 458, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_23); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 458, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_v_s4 = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_tuple__122 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_1, __pyx_int_1); if (unlikely(!__pyx_tuple__122)) __PYX_ERR(0, 458, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__122);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__122);
</pre><pre class="cython line score-33" onclick='toggleDiv(this)'>+<span class="">0459</span>:     <span class="n">o4</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">s4</span> <span class="o">*</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-33 '>  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__123); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 459, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_tuple__123 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_2, __pyx_int_0); if (unlikely(!__pyx_tuple__123)) __PYX_ERR(0, 459, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__123);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__123);
  __pyx_t_23 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__124); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 459, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_s4, __pyx_t_23); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 459, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_t_23 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 459, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_o4 = __pyx_t_23;
  __pyx_t_23 = 0;
  __pyx_tuple__124 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_1, __pyx_int_2, __pyx_int_1); if (unlikely(!__pyx_tuple__124)) __PYX_ERR(0, 459, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__124);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__124);
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0460</span>:     <span class="n">n_points_total</span> <span class="o">=</span> <span class="n">n_points_inboard</span> <span class="o">+</span> <span class="n">n_points_outboard</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-8 '>  __pyx_t_23 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_n_points_inboard, __pyx_v_n_points_outboard); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 460, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_23, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 460, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_v_n_points_total = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">0461</span>:     <span class="n">half_mesh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="n">n_points_total</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-40 '>  __pyx_t_23 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 461, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_23, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 461, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 461, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_int_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n_points_total);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n_points_total);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 1, __pyx_v_n_points_total);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 2, __pyx_int_3);
  __pyx_t_20 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_20)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_20) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_23); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 461, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 461, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_20); __pyx_t_20 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0+1, __pyx_t_23);
    __pyx_t_23 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_21, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 461, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_half_mesh = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0462</span>:     <span class="c"># generate inboard points</span></pre>
<pre class="cython line score-33" onclick='toggleDiv(this)'>+<span class="">0463</span>:     <span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_points_inboard</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-33 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__125); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 463, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_tuple__125 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_1, __pyx_int_1); if (unlikely(!__pyx_tuple__125)) __PYX_ERR(0, 463, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__125);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__125);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__126); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 463, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_21 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 463, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_n_points_inboard, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 463, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_21, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 463, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dy = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__126 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_0, __pyx_int_1); if (unlikely(!__pyx_tuple__126)) __PYX_ERR(0, 463, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__126);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__126);
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0464</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points_inboard</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 464, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_21 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_21 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_21)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_21) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_n_points_inboard); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 464, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_21); __pyx_t_21 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n_points_inboard);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n_points_inboard);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0+1, __pyx_v_n_points_inboard);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_23, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_24 = 0;
    __pyx_t_25 = NULL;
  } else {
    __pyx_t_24 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 464, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_25 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext; if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 464, __pyx_L1_error)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_25)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_24 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_24); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_24++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 464, __pyx_L1_error)
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_24); __pyx_t_24++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_24 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_24); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_24++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 464, __pyx_L1_error)
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_24); __pyx_t_24++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_25(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 464, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">0465</span>:         <span class="n">y</span> <span class="o">=</span> <span class="n">half_mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">dy</span></pre>
<pre class='cython code score-25 '>    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_v_dy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_y, __pyx_t_1);
    __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 465, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 1, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 2, __pyx_int_1);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_half_mesh, __pyx_t_23, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 465, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0466</span>:         <span class="n">half_mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">o1</span>  <span class="c"># le point</span></pre>
<pre class='cython code score-29 '>    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_s1, __pyx_v_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 466, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_23 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_o1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 466, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 466, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_0);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_half_mesh, __pyx_t_1, __pyx_t_23) &lt; 0)) __PYX_ERR(0, 466, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0467</span>:         <span class="n">half_mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span></pre>
<pre class='cython code score-17 '>    __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 467, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 1, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 2, __pyx_int_1);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_half_mesh, __pyx_t_23, __pyx_v_y) &lt; 0)) __PYX_ERR(0, 467, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0468</span>:         <span class="n">half_mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s2</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">o2</span>  <span class="c"># te point</span></pre>
<pre class='cython code score-29 '>    __pyx_t_23 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_s2, __pyx_v_y); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 468, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_23, __pyx_v_o2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 468, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 1, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 2, __pyx_int_0);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_half_mesh, __pyx_t_23, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 468, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0469</span>:     <span class="n">yehudi_break</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__127); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 469, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_yehudi_break = __pyx_t_3;
  __pyx_t_3 = 0;
/* … */
  __pyx_tuple__127 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_1, __pyx_int_1); if (unlikely(!__pyx_tuple__127)) __PYX_ERR(0, 469, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__127);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__127);
</pre><pre class="cython line score-0">&#xA0;<span class="">0470</span>:     <span class="c"># generate outboard points</span></pre>
<pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0471</span>:     <span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_points_outboard</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__128); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 471, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_tuple__128 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_2, __pyx_int_1); if (unlikely(!__pyx_tuple__128)) __PYX_ERR(0, 471, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__128);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__128);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__129); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 471, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_23 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 471, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_n_points_outboard, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 471, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_23, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 471, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_dy, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_tuple__129 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_int_1, __pyx_int_1); if (unlikely(!__pyx_tuple__129)) __PYX_ERR(0, 471, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__129);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__129);
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0472</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points_outboard</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 472, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_23 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_23 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_23)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_23);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_23) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_n_points_outboard); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 472, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_23); __pyx_t_23 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n_points_outboard);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n_points_outboard);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0+1, __pyx_v_n_points_outboard);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_21, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_1 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_24 = 0;
    __pyx_t_25 = NULL;
  } else {
    __pyx_t_24 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 472, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_25 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext; if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 472, __pyx_L1_error)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_25)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_24 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_24); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_24++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 472, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_24); __pyx_t_24++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_24 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_24); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_24++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 472, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_24); __pyx_t_24++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_25(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 472, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">0473</span>:         <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">n_points_inboard</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-9 '>    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_j, __pyx_v_n_points_inboard); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 473, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 473, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_21);
    __pyx_t_21 = 0;
</pre><pre class="cython line score-31" onclick='toggleDiv(this)'>+<span class="">0474</span>:         <span class="n">y</span> <span class="o">=</span> <span class="n">half_mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">+</span> <span class="n">yehudi_break</span></pre>
<pre class='cython code score-31 '>    __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_j, __pyx_v_dy); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 474, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_21, __pyx_v_yehudi_break); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 474, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_y, __pyx_t_3);
    __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 474, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 2, __pyx_int_1);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_half_mesh, __pyx_t_21, __pyx_t_3) &lt; 0)) __PYX_ERR(0, 474, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0475</span>:         <span class="n">half_mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s3</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">o3</span>  <span class="c"># le point</span></pre>
<pre class='cython code score-29 '>    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_s3, __pyx_v_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 475, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_21 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_o3); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 475, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 475, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_0);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_half_mesh, __pyx_t_3, __pyx_t_21) &lt; 0)) __PYX_ERR(0, 475, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">0476</span>:         <span class="n">half_mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span></pre>
<pre class='cython code score-17 '>    __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 476, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 2, __pyx_int_1);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_half_mesh, __pyx_t_21, __pyx_v_y) &lt; 0)) __PYX_ERR(0, 476, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0477</span>:         <span class="n">half_mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s4</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">o4</span>  <span class="c"># te point</span></pre>
<pre class='cython code score-29 '>    __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_s4, __pyx_v_y); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 477, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_21, __pyx_v_o4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 477, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 2, __pyx_int_0);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_half_mesh, __pyx_t_21, __pyx_t_3) &lt; 0)) __PYX_ERR(0, 477, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">0478</span>:     <span class="n">full_mesh</span> <span class="o">=</span> <span class="n">mirror</span><span class="p">(</span><span class="n">half_mesh</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_mirror); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 478, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_21 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_21 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_21)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_21) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_half_mesh); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 478, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 478, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_t_21); __pyx_t_21 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_half_mesh);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_half_mesh);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0+1, __pyx_v_half_mesh);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_23, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 478, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_full_mesh = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0479</span>:     <span class="n">full_mesh</span> <span class="o">=</span> <span class="n">add_chordwise_panels</span><span class="p">(</span><span class="n">full_mesh</span><span class="p">,</span> <span class="n">num_x</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_add_chordwise_panels); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 479, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_23 = NULL;
  __pyx_t_24 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_23 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_23)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_23);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_24 = 1;
    }
  }
  __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_24); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 479, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  if (__pyx_t_23) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_23); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_23); __pyx_t_23 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_full_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_full_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0+__pyx_t_24, __pyx_v_full_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_x);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1+__pyx_t_24, __pyx_v_num_x);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_21, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 479, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_full_mesh, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-84" onclick='toggleDiv(this)'>+<span class="">0480</span>:     <span class="n">full_mesh</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">full_mesh</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-84 '>  __pyx_slice__130 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__130)) __PYX_ERR(0, 480, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__130);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__130);
  __pyx_slice__131 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__131)) __PYX_ERR(0, 480, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__131);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__131);
/* … */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__132);
  __pyx_t_26 = __pyx_tuple__132;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_full_mesh, __pyx_t_26); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 480, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 480, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_mean); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 480, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_tuple__132 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__130, __pyx_slice__131, __pyx_int_1); if (unlikely(!__pyx_tuple__132)) __PYX_ERR(0, 480, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__132);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__132);
  __pyx_slice__133 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__133)) __PYX_ERR(0, 480, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__133);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__133);
  __pyx_slice__134 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__134)) __PYX_ERR(0, 480, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__134);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__134);
  __pyx_t_21 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_full_mesh, __pyx_tuple__135); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 480, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_t_20 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_23))) {
    __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_23);
    if (likely(__pyx_t_20)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_23);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_23, function);
    }
  }
  if (!__pyx_t_20) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_23, __pyx_t_21); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_22 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 480, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0, __pyx_t_20); __pyx_t_20 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_22, 0+1, __pyx_t_21);
    __pyx_t_21 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_23, __pyx_t_22, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_t_23 = <span class='py_c_api'>PyNumber_InPlaceSubtract</span>(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 480, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_full_mesh, __pyx_t_26, __pyx_t_23) &lt; 0)) __PYX_ERR(0, 480, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
  __pyx_tuple__135 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__133, __pyx_slice__134, __pyx_int_1); if (unlikely(!__pyx_tuple__135)) __PYX_ERR(0, 480, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__135);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__135);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0481</span>:     <span class="k">return</span> <span class="n">full_mesh</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_full_mesh);
  __pyx_r = __pyx_v_full_mesh;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0482</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0483</span>: </pre>
<pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0484</span>: <span class="k">def</span> <span class="nf">add_chordwise_panels</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">num_x</span><span class="p">):</span></pre>
<pre class='cython code score-57 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_23add_chordwise_panels(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_22add_chordwise_panels[] = " Divide the wing into multiple chordwise panels. ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_23add_chordwise_panels = {"add_chordwise_panels", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_23add_chordwise_panels, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_22add_chordwise_panels};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_23add_chordwise_panels(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mesh = 0;
  PyObject *__pyx_v_num_x = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_chordwise_panels (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mesh,&amp;__pyx_n_s_num_x,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_x)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("add_chordwise_panels", 1, 2, 2, 1); __PYX_ERR(0, 484, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "add_chordwise_panels") &lt; 0)) __PYX_ERR(0, 484, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_mesh = values[0];
    __pyx_v_num_x = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("add_chordwise_panels", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 484, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.add_chordwise_panels", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_22add_chordwise_panels(__pyx_self, __pyx_v_mesh, __pyx_v_num_x);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_22add_chordwise_panels(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mesh, PyObject *__pyx_v_num_x) {
  PyObject *__pyx_v_le = NULL;
  PyObject *__pyx_v_te = NULL;
  PyObject *__pyx_v_new_mesh = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_w = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("add_chordwise_panels", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.add_chordwise_panels", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_le);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_te);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_new_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_w);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__562 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_mesh, __pyx_n_s_num_x, __pyx_n_s_le, __pyx_n_s_te, __pyx_n_s_new_mesh, __pyx_n_s_i, __pyx_n_s_w); if (unlikely(!__pyx_tuple__562)) __PYX_ERR(0, 484, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__562);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__562);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_23add_chordwise_panels, 0, __pyx_n_s_add_chordwise_panels, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__563)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 484, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_add_chordwise_panels, __pyx_t_2) &lt; 0) __PYX_ERR(0, 484, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__563 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__562, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_add_chordwise_panels, 484, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__563)) __PYX_ERR(0, 484, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0485</span>:     <span class="sd">&quot;&quot;&quot; Divide the wing into multiple chordwise panels. &quot;&quot;&quot;</span></pre>
<pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">0486</span>:     <span class="n">le</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span></pre>
<pre class='cython code score-20 '>  __pyx_slice__136 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__136)) __PYX_ERR(0, 486, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__136);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__136);
  __pyx_slice__137 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__137)) __PYX_ERR(0, 486, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__137);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__137);
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__138); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 486, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_le = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__138 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_slice__136, __pyx_slice__137); if (unlikely(!__pyx_tuple__138)) __PYX_ERR(0, 486, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__138);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__138);
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">0487</span>:     <span class="n">te</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span></pre>
<pre class='cython code score-20 '>  __pyx_slice__139 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__139)) __PYX_ERR(0, 487, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__139);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__139);
  __pyx_slice__140 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__140)) __PYX_ERR(0, 487, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__140);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__140);
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__141); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 487, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_te = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__141 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_neg_1, __pyx_slice__139, __pyx_slice__140); if (unlikely(!__pyx_tuple__141)) __PYX_ERR(0, 487, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__141);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__141);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0488</span>:     <span class="n">new_mesh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_x</span><span class="p">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-44 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 488, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 488, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 488, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 488, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 488, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_x);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_num_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_3);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 488, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_new_mesh = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">0489</span>:     <span class="n">new_mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">le</span></pre>
<pre class='cython code score-20 '>  __pyx_slice__142 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__142)) __PYX_ERR(0, 489, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__142);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__142);
  __pyx_slice__143 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__143)) __PYX_ERR(0, 489, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__143);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__143);
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_mesh, __pyx_tuple__144, __pyx_v_le) &lt; 0)) __PYX_ERR(0, 489, __pyx_L1_error)
  __pyx_tuple__144 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_slice__142, __pyx_slice__143); if (unlikely(!__pyx_tuple__144)) __PYX_ERR(0, 489, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__144);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__144);
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">0490</span>:     <span class="n">new_mesh</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">te</span></pre>
<pre class='cython code score-20 '>  __pyx_slice__145 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__145)) __PYX_ERR(0, 490, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__145);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__145);
  __pyx_slice__146 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__146)) __PYX_ERR(0, 490, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__146);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__146);
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_mesh, __pyx_tuple__147, __pyx_v_te) &lt; 0)) __PYX_ERR(0, 490, __pyx_L1_error)
  __pyx_tuple__147 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_neg_1, __pyx_slice__145, __pyx_slice__146); if (unlikely(!__pyx_tuple__147)) __PYX_ERR(0, 490, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__147);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__147);
</pre><pre class="cython line score-74" onclick='toggleDiv(this)'>+<span class="">0491</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">num_x</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-74 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_num_x, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 491, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 491, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (__pyx_t_2) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_6, __pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_6, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 491, __pyx_L1_error)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 491, __pyx_L1_error)
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 491, __pyx_L1_error)
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_7(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 491, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">0492</span>:         <span class="n">w</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">num_x</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Float</span>(__pyx_v_i); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 492, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_num_x, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 492, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 492, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_w, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-48" onclick='toggleDiv(this)'>+<span class="">0493</span>:         <span class="n">new_mesh</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">le</span> <span class="o">+</span> <span class="n">w</span> <span class="o">*</span> <span class="n">te</span></pre>
<pre class='cython code score-48 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_w, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 493, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_v_le); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 493, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_w, __pyx_v_te); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 493, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 493, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_slice__148 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__148)) __PYX_ERR(0, 493, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__148);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__148);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 493, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_i);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__148);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__148);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_slice__148);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__149);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__149);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_slice__149);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_new_mesh, __pyx_t_5, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 493, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_slice__149 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__149)) __PYX_ERR(0, 493, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__149);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__149);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0494</span>:     <span class="k">return</span> <span class="n">new_mesh</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_mesh);
  __pyx_r = __pyx_v_new_mesh;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0495</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0496</span>: </pre>
<pre class="cython line score-93" onclick='toggleDiv(this)'>+<span class="">0497</span>: <span class="k">def</span> <span class="nf">gen_mesh</span><span class="p">(</span><span class="n">num_x</span><span class="p">,</span> <span class="n">num_y</span><span class="p">,</span> <span class="n">span</span><span class="p">,</span> <span class="n">chord</span><span class="p">,</span> <span class="n">cosine_spacing</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span></pre>
<pre class='cython code score-93 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_25gen_mesh(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_24gen_mesh[] = " Generate simple rectangular wing mesh. ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_25gen_mesh = {"gen_mesh", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_25gen_mesh, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_24gen_mesh};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_25gen_mesh(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_num_x = 0;
  PyObject *__pyx_v_num_y = 0;
  PyObject *__pyx_v_span = 0;
  PyObject *__pyx_v_chord = 0;
  PyObject *__pyx_v_cosine_spacing = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gen_mesh (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_num_x,&amp;__pyx_n_s_num_y,&amp;__pyx_n_s_span,&amp;__pyx_n_s_chord,&amp;__pyx_n_s_cosine_spacing,0};
    PyObject* values[5] = {0,0,0,0,0};
    values[4] = ((PyObject *)((PyObject*)__pyx_float_0_));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_x)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gen_mesh", 0, 4, 5, 1); __PYX_ERR(0, 497, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_span)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gen_mesh", 0, 4, 5, 2); __PYX_ERR(0, 497, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_chord)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gen_mesh", 0, 4, 5, 3); __PYX_ERR(0, 497, __pyx_L3_error)
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cosine_spacing);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gen_mesh") &lt; 0)) __PYX_ERR(0, 497, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_num_x = values[0];
    __pyx_v_num_y = values[1];
    __pyx_v_span = values[2];
    __pyx_v_chord = values[3];
    __pyx_v_cosine_spacing = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gen_mesh", 0, 4, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 497, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.gen_mesh", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_24gen_mesh(__pyx_self, __pyx_v_num_x, __pyx_v_num_y, __pyx_v_span, __pyx_v_chord, __pyx_v_cosine_spacing);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_24gen_mesh(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_num_x, PyObject *__pyx_v_num_y, PyObject *__pyx_v_span, PyObject *__pyx_v_chord, PyObject *__pyx_v_cosine_spacing) {
  PyObject *__pyx_v_mesh = NULL;
  PyObject *__pyx_v_ny2 = NULL;
  PyObject *__pyx_v_beta = NULL;
  PyObject *__pyx_v_cosine = NULL;
  PyObject *__pyx_v_uniform = NULL;
  PyObject *__pyx_v_half_wing = NULL;
  PyObject *__pyx_v_full_wing = NULL;
  PyObject *__pyx_v_ind_x = NULL;
  PyObject *__pyx_v_ind_y = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gen_mesh", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.gen_mesh", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_beta);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cosine);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_uniform);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_half_wing);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_full_wing);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind_y);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__564 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_num_x, __pyx_n_s_num_y, __pyx_n_s_span, __pyx_n_s_chord, __pyx_n_s_cosine_spacing, __pyx_n_s_mesh, __pyx_n_s_ny2, __pyx_n_s_beta, __pyx_n_s_cosine, __pyx_n_s_uniform, __pyx_n_s_half_wing, __pyx_n_s_full_wing, __pyx_n_s_ind_x, __pyx_n_s_ind_y); if (unlikely(!__pyx_tuple__564)) __PYX_ERR(0, 497, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__564);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__564);
  __pyx_codeobj__565 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__564, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_gen_mesh, 497, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__565)) __PYX_ERR(0, 497, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_25gen_mesh, 0, __pyx_n_s_gen_mesh, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__565)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 497, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__566);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_gen_mesh, __pyx_t_2) &lt; 0) __PYX_ERR(0, 497, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__566 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject*)__pyx_float_0_)); if (unlikely(!__pyx_tuple__566)) __PYX_ERR(0, 497, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__566);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__566);
</pre><pre class="cython line score-0">&#xA0;<span class="">0498</span>:     <span class="sd">&quot;&quot;&quot; Generate simple rectangular wing mesh. &quot;&quot;&quot;</span></pre>
<pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">0499</span>:     <span class="n">mesh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_x</span><span class="p">,</span> <span class="n">num_y</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-40 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 499, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 499, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 499, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_x);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_num_x);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_y);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_num_y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_3);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 499, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 499, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 499, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_mesh = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0500</span>:     <span class="n">ny2</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_y</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_num_y, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 500, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_TrueDivideObjC</span>(__pyx_t_1, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 500, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ny2 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0501</span>:     <span class="n">beta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2</span><span class="p">,</span> <span class="n">ny2</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linspace); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 501, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_pi); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 501, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_TrueDivideObjC</span>(__pyx_t_2, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 501, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (__pyx_t_2) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_6, __pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_6, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_6, __pyx_v_ny2);
  __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 501, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_beta = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0502</span>:     <span class="c"># mixed spacing with w as a weighting factor</span></pre>
<pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">0503</span>:     <span class="n">cosine</span> <span class="o">=</span> <span class="o">.</span><span class="mf">5</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>  <span class="c"># cosine spacing</span></pre>
<pre class='cython code score-35 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 503, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_cos); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 503, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_beta); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 503, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_beta);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_beta);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_v_beta);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 503, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float__5, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 503, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_cosine = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-42" onclick='toggleDiv(this)'>+<span class="">0504</span>:     <span class="n">uniform</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="o">.</span><span class="mf">5</span><span class="p">,</span> <span class="n">ny2</span><span class="p">)[::</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span>  <span class="c"># uniform spacing</span></pre>
<pre class='cython code score-42 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 504, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_linspace); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 504, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_6, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float__5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_6, __pyx_float__5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_6, __pyx_v_ny2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 504, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_4, __pyx_slice__150); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_uniform = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_slice__150 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__150)) __PYX_ERR(0, 504, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__150);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__150);
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">0505</span>:     <span class="n">half_wing</span> <span class="o">=</span> <span class="n">cosine</span> <span class="o">*</span> <span class="n">cosine_spacing</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">cosine_spacing</span><span class="p">)</span> <span class="o">*</span> <span class="n">uniform</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_cosine, __pyx_v_cosine_spacing); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 505, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_cosine_spacing, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 505, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_v_uniform); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 505, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 505, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_half_wing = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-65" onclick='toggleDiv(this)'>+<span class="">0506</span>:     <span class="n">full_wing</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="o">-</span><span class="n">half_wing</span><span class="p">[:</span><span class="o">-</span><span class="mf">1</span><span class="p">],</span> <span class="n">half_wing</span><span class="p">[::</span><span class="o">-</span><span class="mf">1</span><span class="p">]))</span> <span class="o">*</span> <span class="n">span</span></pre>
<pre class='cython code score-65 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 506, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_hstack); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_half_wing, 0, -1L, NULL, NULL, &amp;__pyx_slice__151, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 506, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_slice__151 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__151)) __PYX_ERR(0, 506, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__151);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__151);
  __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_half_wing, __pyx_slice__152); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 506, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 506, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 506, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 506, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_v_span); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_full_wing = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_slice__152 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__152)) __PYX_ERR(0, 506, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__152);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__152);
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0507</span>:     <span class="k">for</span> <span class="n">ind_x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_x</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 507, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_num_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 507, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_x);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_num_x);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_4 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 507, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 507, __pyx_L1_error)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 507, __pyx_L1_error)
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 507, __pyx_L1_error)
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_7(__pyx_t_4);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 507, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind_x, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0508</span>:         <span class="k">for</span> <span class="n">ind_y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_y</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 508, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_num_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 508, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_y);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_y);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_num_y);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 508, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_9 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 508, __pyx_L1_error)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 508, __pyx_L1_error)
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_8++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 508, __pyx_L1_error)
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_9(__pyx_t_2);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else __PYX_ERR(0, 508, __pyx_L1_error)
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind_y, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-43" onclick='toggleDiv(this)'>+<span class="">0509</span>:             <span class="n">mesh</span><span class="p">[</span><span class="n">ind_x</span><span class="p">,</span> <span class="n">ind_y</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ind_x</span> <span class="o">/</span> <span class="p">(</span><span class="n">num_x</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">chord</span><span class="p">,</span></pre>
<pre class='cython code score-43 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_num_x, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_ind_x, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 509, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_v_chord); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
      __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 509, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_0);
      __pyx_t_1 = 0;
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 509, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind_x);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind_x);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_ind_x);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind_y);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind_y);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_ind_y);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__153);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__153);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_slice__153);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mesh, __pyx_t_5, __pyx_t_3) &lt; 0)) __PYX_ERR(0, 509, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__153 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__153)) __PYX_ERR(0, 509, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__153);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__153);
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0510</span>:                                      <span class="n">full_wing</span><span class="p">[</span><span class="n">ind_y</span><span class="p">],</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>      __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_full_wing, __pyx_v_ind_y); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 510, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0511</span>:     <span class="k">return</span> <span class="n">mesh</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
  __pyx_r = __pyx_v_mesh;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0512</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0513</span>: </pre>
<pre class="cython line score-101" onclick='toggleDiv(this)'>+<span class="">0514</span>: <span class="k">def</span> <span class="nf">geometry_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">twist</span><span class="p">,</span> <span class="n">sweep_angle</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">taper_ratio</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">span</span><span class="o">=</span><span class="mf">58.7630524</span><span class="p">):</span></pre>
<pre class='cython code score-101 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_27geometry_mesh(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_27geometry_mesh = {"geometry_mesh", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_27geometry_mesh, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_27geometry_mesh(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mesh = 0;
  PyObject *__pyx_v_aero_ind = 0;
  PyObject *__pyx_v_twist = 0;
  PyObject *__pyx_v_sweep_angle = 0;
  PyObject *__pyx_v_dihedral_angle = 0;
  PyObject *__pyx_v_taper_ratio = 0;
  CYTHON_UNUSED PyObject *__pyx_v_span = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("geometry_mesh (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mesh,&amp;__pyx_n_s_aero_ind,&amp;__pyx_n_s_twist,&amp;__pyx_n_s_sweep_angle,&amp;__pyx_n_s_dihedral_angle,&amp;__pyx_n_s_taper_ratio,&amp;__pyx_n_s_span,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    values[3] = ((PyObject *)((PyObject *)__pyx_int_0));
    values[4] = ((PyObject *)((PyObject *)__pyx_int_0));
    values[5] = ((PyObject *)((PyObject *)__pyx_int_1));
    values[6] = ((PyObject *)((PyObject*)__pyx_float_58_7630524));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aero_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("geometry_mesh", 0, 3, 7, 1); __PYX_ERR(0, 514, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_twist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("geometry_mesh", 0, 3, 7, 2); __PYX_ERR(0, 514, __pyx_L3_error)
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sweep_angle);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_dihedral_angle);
          if (value) { values[4] = value; kw_args--; }
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_taper_ratio);
          if (value) { values[5] = value; kw_args--; }
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_span);
          if (value) { values[6] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "geometry_mesh") &lt; 0)) __PYX_ERR(0, 514, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_mesh = values[0];
    __pyx_v_aero_ind = values[1];
    __pyx_v_twist = values[2];
    __pyx_v_sweep_angle = values[3];
    __pyx_v_dihedral_angle = values[4];
    __pyx_v_taper_ratio = values[5];
    __pyx_v_span = values[6];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("geometry_mesh", 0, 3, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 514, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.geometry_mesh", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_26geometry_mesh(__pyx_self, __pyx_v_mesh, __pyx_v_aero_ind, __pyx_v_twist, __pyx_v_sweep_angle, __pyx_v_dihedral_angle, __pyx_v_taper_ratio, __pyx_v_span);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_26geometry_mesh(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mesh, PyObject *__pyx_v_aero_ind, PyObject *__pyx_v_twist, PyObject *__pyx_v_sweep_angle, PyObject *__pyx_v_dihedral_angle, PyObject *__pyx_v_taper_ratio, CYTHON_UNUSED PyObject *__pyx_v_span) {
  PyObject *__pyx_v_ny = NULL;
  PyObject *__pyx_v_nx = NULL;
  PyObject *__pyx_v_n = NULL;
  PyObject *__pyx_v_wing_mesh = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("geometry_mesh", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_twist);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.geometry_mesh", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_wing_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_twist);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__567 = <span class='py_c_api'>PyTuple_Pack</span>(11, __pyx_n_s_mesh, __pyx_n_s_aero_ind, __pyx_n_s_twist, __pyx_n_s_sweep_angle, __pyx_n_s_dihedral_angle, __pyx_n_s_taper_ratio, __pyx_n_s_span, __pyx_n_s_ny, __pyx_n_s_nx, __pyx_n_s_n, __pyx_n_s_wing_mesh); if (unlikely(!__pyx_tuple__567)) __PYX_ERR(0, 514, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__567);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__567);
  __pyx_codeobj__568 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 11, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__567, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_geometry_mesh, 514, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__568)) __PYX_ERR(0, 514, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_27geometry_mesh, 0, __pyx_n_s_geometry_mesh, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__568)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 514, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__569);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_geometry_mesh, __pyx_t_2) &lt; 0) __PYX_ERR(0, 514, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__569 = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject *)__pyx_int_0), ((PyObject *)__pyx_int_0), ((PyObject *)__pyx_int_1), ((PyObject*)__pyx_float_58_7630524)); if (unlikely(!__pyx_tuple__569)) __PYX_ERR(0, 514, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__569);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__569);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0515</span>:     <span class="n">ny</span> <span class="o">=</span> <span class="n">aero_ind</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__154); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 515, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_ny = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__154 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_1); if (unlikely(!__pyx_tuple__154)) __PYX_ERR(0, 515, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__154);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__154);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0516</span>:     <span class="n">nx</span> <span class="o">=</span> <span class="n">aero_ind</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__155); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 516, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_nx = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__155 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_0); if (unlikely(!__pyx_tuple__155)) __PYX_ERR(0, 516, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__155);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__155);
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0517</span>:     <span class="n">n</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_ny); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 517, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_n = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-64" onclick='toggleDiv(this)'>+<span class="">0518</span>:     <span class="n">wing_mesh</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[:</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;complex&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-64 '>  __pyx_t_2 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_v_n, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 518, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 518, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__156);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__156);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_slice__156);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 518, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_reshape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 518, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 518, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_2) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_4, __pyx_int_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 518, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__156 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__156)) __PYX_ERR(0, 518, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__156);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__156);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__157, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_wing_mesh = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__157 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_complex); if (unlikely(!__pyx_tuple__157)) __PYX_ERR(0, 518, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__157);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__157);
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">0519</span>:     <span class="n">twist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ny</span><span class="p">)</span>  <span class="c"># default option</span></pre>
<pre class='cython code score-30 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 519, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 519, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_ny); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 519, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_ny);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 519, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_twist, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-65" onclick='toggleDiv(this)'>+<span class="">0520</span>:     <span class="n">wing_mesh</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[:</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;complex&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-65 '>  __pyx_t_5 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_v_n, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 520, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 520, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__158);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__158);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_slice__158);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 520, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_reshape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 520, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 520, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_5) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_4, __pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_4, __pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2+__pyx_t_4, __pyx_int_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 520, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 520, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__158 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__158)) __PYX_ERR(0, 520, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__158);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__158);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__159, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 520, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_wing_mesh, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_tuple__159 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_complex); if (unlikely(!__pyx_tuple__159)) __PYX_ERR(0, 520, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__159);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__159);
</pre><pre class="cython line score-0">&#xA0;<span class="">0521</span>:     <span class="c"># stretch(wing_mesh, params[&#39;span&#39;])</span></pre>
<pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0522</span>:     <span class="n">sweep</span><span class="p">(</span><span class="n">wing_mesh</span><span class="p">,</span> <span class="n">sweep_angle</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sweep); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 522, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 522, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wing_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_wing_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_wing_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sweep_angle);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sweep_angle);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_sweep_angle);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 522, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0523</span>:     <span class="n">rotate</span><span class="p">(</span><span class="n">wing_mesh</span><span class="p">,</span> <span class="n">twist</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_rotate); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 523, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 523, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_5) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wing_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_wing_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_4, __pyx_v_wing_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_twist);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_twist);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_4, __pyx_v_twist);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 523, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0524</span>:     <span class="n">dihedral</span><span class="p">(</span><span class="n">wing_mesh</span><span class="p">,</span> <span class="n">dihedral_angle</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_dihedral); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 524, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 524, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wing_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_wing_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_wing_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dihedral_angle);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dihedral_angle);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_dihedral_angle);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 524, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0525</span>:     <span class="n">taper</span><span class="p">(</span><span class="n">wing_mesh</span><span class="p">,</span> <span class="n">taper_ratio</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_taper); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 525, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 525, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_5) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wing_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_wing_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_4, __pyx_v_wing_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_taper_ratio);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_taper_ratio);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_4, __pyx_v_taper_ratio);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 525, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-62" onclick='toggleDiv(this)'>+<span class="">0526</span>:     <span class="n">mesh</span><span class="p">[:</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">wing_mesh</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;complex&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-62 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_wing_mesh, __pyx_n_s_reshape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 526, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 526, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_int_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 526, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 526, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__160, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 526, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_v_n, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 526, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_tuple__160 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_complex); if (unlikely(!__pyx_tuple__160)) __PYX_ERR(0, 526, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__160);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__160);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 526, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__161);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__161);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_slice__161);
  __pyx_t_2 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mesh, __pyx_t_5, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 526, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_slice__161 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__161)) __PYX_ERR(0, 526, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__161);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__161);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0527</span>:     <span class="k">return</span> <span class="n">mesh</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
  __pyx_r = __pyx_v_mesh;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0528</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0529</span>: </pre>
<pre class="cython line score-123" onclick='toggleDiv(this)'>+<span class="">0530</span>: <span class="k">def</span> <span class="nf">transfer_displacements</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">disp</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">,</span> <span class="n">fem_origin</span><span class="o">=</span><span class="mf">0.35</span><span class="p">):</span></pre>
<pre class='cython code score-123 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_29transfer_displacements(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_28transfer_displacements[] = "\n    Perform displacement transfer.\n\n    Apply the computed displacements on the original mesh to obtain\n    the deformed mesh.\n\n    Parameters\n    ----------\n    mesh : array_like\n        Flattened array defining the lifting surfaces.\n    disp : array_like\n        Flattened array containing displacements on the FEM component.\n        Contains displacements for all six degrees of freedom, including\n        displacements in the x, y, and z directions, and rotations about the\n        x, y, and z axes.\n\n    Returns\n    -------\n    def_mesh : array_like\n        Flattened array defining the lifting surfaces after deformation.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_29transfer_displacements = {"transfer_displacements", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_29transfer_displacements, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_28transfer_displacements};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_29transfer_displacements(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mesh = 0;
  PyObject *__pyx_v_disp = 0;
  PyObject *__pyx_v_aero_ind = 0;
  PyObject *__pyx_v_fem_ind = 0;
  PyObject *__pyx_v_fem_origin = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("transfer_displacements (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mesh,&amp;__pyx_n_s_disp,&amp;__pyx_n_s_aero_ind,&amp;__pyx_n_s_fem_ind,&amp;__pyx_n_s_fem_origin,0};
    PyObject* values[5] = {0,0,0,0,0};
    values[4] = ((PyObject *)((PyObject*)__pyx_float_0_35));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_disp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("transfer_displacements", 0, 4, 5, 1); __PYX_ERR(0, 530, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aero_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("transfer_displacements", 0, 4, 5, 2); __PYX_ERR(0, 530, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_fem_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("transfer_displacements", 0, 4, 5, 3); __PYX_ERR(0, 530, __pyx_L3_error)
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_fem_origin);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "transfer_displacements") &lt; 0)) __PYX_ERR(0, 530, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_mesh = values[0];
    __pyx_v_disp = values[1];
    __pyx_v_aero_ind = values[2];
    __pyx_v_fem_ind = values[3];
    __pyx_v_fem_origin = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("transfer_displacements", 0, 4, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 530, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.transfer_displacements", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_28transfer_displacements(__pyx_self, __pyx_v_mesh, __pyx_v_disp, __pyx_v_aero_ind, __pyx_v_fem_ind, __pyx_v_fem_origin);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_28transfer_displacements(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mesh, PyObject *__pyx_v_disp, PyObject *__pyx_v_aero_ind, PyObject *__pyx_v_fem_ind, PyObject *__pyx_v_fem_origin) {
  PyObject *__pyx_v_tot_n = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_tot_n_fem = NULL;
  PyObject *__pyx_v_out_def_mesh = NULL;
  PyObject *__pyx_v_i_surf = NULL;
  PyObject *__pyx_v_row = NULL;
  PyObject *__pyx_v_nx = NULL;
  PyObject *__pyx_v_ny = NULL;
  PyObject *__pyx_v_n = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_n_bpts = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_n_panels = NULL;
  PyObject *__pyx_v_i = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i_bpts = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i_panels = NULL;
  PyObject *__pyx_v_n_fem = NULL;
  PyObject *__pyx_v_i_fem = NULL;
  PyObject *__pyx_v_mesh2 = NULL;
  PyObject *__pyx_v_disp2 = NULL;
  PyObject *__pyx_v_w = NULL;
  PyObject *__pyx_v_ref_curve = NULL;
  PyObject *__pyx_v_Smesh = NULL;
  PyObject *__pyx_v_ind = NULL;
  PyObject *__pyx_v_def_mesh = NULL;
  PyObject *__pyx_v_cos = NULL;
  PyObject *__pyx_v_sin = NULL;
  PyObject *__pyx_v_dx = NULL;
  PyObject *__pyx_v_dy = NULL;
  PyObject *__pyx_v_dz = NULL;
  PyObject *__pyx_v_rx = NULL;
  PyObject *__pyx_v_ry = NULL;
  PyObject *__pyx_v_rz = NULL;
  PyObject *__pyx_v_T = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("transfer_displacements", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.transfer_displacements", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out_def_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mesh2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_disp2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_w);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ref_curve);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Smesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_def_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cos);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sin);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dz);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ry);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rz);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_T);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__570 = <span class='py_c_api'>PyTuple_Pack</span>(36, __pyx_n_s_mesh, __pyx_n_s_disp, __pyx_n_s_aero_ind, __pyx_n_s_fem_ind, __pyx_n_s_fem_origin, __pyx_n_s_tot_n, __pyx_n_s_tot_n_fem, __pyx_n_s_out_def_mesh, __pyx_n_s_i_surf, __pyx_n_s_row, __pyx_n_s_nx, __pyx_n_s_ny, __pyx_n_s_n, __pyx_n_s_n_bpts, __pyx_n_s_n_panels, __pyx_n_s_i, __pyx_n_s_i_bpts, __pyx_n_s_i_panels, __pyx_n_s_n_fem, __pyx_n_s_i_fem, __pyx_n_s_mesh2, __pyx_n_s_disp2, __pyx_n_s_w, __pyx_n_s_ref_curve, __pyx_n_s_Smesh, __pyx_n_s_ind, __pyx_n_s_def_mesh, __pyx_n_s_cos, __pyx_n_s_sin, __pyx_n_s_dx, __pyx_n_s_dy, __pyx_n_s_dz, __pyx_n_s_rx, __pyx_n_s_ry, __pyx_n_s_rz, __pyx_n_s_T); if (unlikely(!__pyx_tuple__570)) __PYX_ERR(0, 530, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__570);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__570);
  __pyx_codeobj__571 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 36, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__570, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_transfer_displacements, 530, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__571)) __PYX_ERR(0, 530, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_29transfer_displacements, 0, __pyx_n_s_transfer_displacements, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__571)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 530, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__572);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_transfer_displacements, __pyx_t_2) &lt; 0) __PYX_ERR(0, 530, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__572 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject*)__pyx_float_0_35)); if (unlikely(!__pyx_tuple__572)) __PYX_ERR(0, 530, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__572);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__572);
</pre><pre class="cython line score-0">&#xA0;<span class="">0531</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0532</span>: <span class="sd">    Perform displacement transfer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0533</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0534</span>: <span class="sd">    Apply the computed displacements on the original mesh to obtain</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0535</span>: <span class="sd">    the deformed mesh.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0536</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0537</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0538</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0539</span>: <span class="sd">    mesh : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>: <span class="sd">        Flattened array defining the lifting surfaces.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>: <span class="sd">    disp : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>: <span class="sd">        Flattened array containing displacements on the FEM component.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>: <span class="sd">        Contains displacements for all six degrees of freedom, including</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0544</span>: <span class="sd">        displacements in the x, y, and z directions, and rotations about the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>: <span class="sd">        x, y, and z axes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0546</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0547</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0548</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0549</span>: <span class="sd">    def_mesh : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0550</span>: <span class="sd">        Flattened array defining the lifting surfaces after deformation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0551</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0552</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0553</span>:     <span class="n">tot_n</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 553, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 553, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__162 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__162)) __PYX_ERR(0, 553, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__162);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__162);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__163); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 553, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 553, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 553, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 553, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_tot_n = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__163 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__162, __pyx_int_2); if (unlikely(!__pyx_tuple__163)) __PYX_ERR(0, 553, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__163);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__163);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0554</span>:     <span class="n">tot_n_fem</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 554, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 554, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__164 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__164)) __PYX_ERR(0, 554, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__164);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__164);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fem_ind, __pyx_tuple__165); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 554, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 554, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 554, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 554, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_tot_n_fem = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__165 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__164, __pyx_int_0); if (unlikely(!__pyx_tuple__165)) __PYX_ERR(0, 554, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__165);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__165);
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0555</span>:     <span class="n">out_def_mesh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_n</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 555, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 555, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 555, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_n);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_n);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_tot_n);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 555, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 555, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 555, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) __PYX_ERR(0, 555, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 555, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_out_def_mesh = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0556</span>:     <span class="k">for</span> <span class="n">i_surf</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_3 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_fem_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_fem_ind)) {
    __pyx_t_1 = __pyx_v_fem_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_fem_ind); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 556, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 556, __pyx_L1_error)
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 556, __pyx_L1_error)
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_7(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 556, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_surf, __pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3);
    __pyx_t_3 = __pyx_t_4;
    __pyx_t_4 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-92" onclick='toggleDiv(this)'>+<span class="">0557</span>:         <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_bpts</span><span class="p">,</span> <span class="n">n_panels</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_bpts</span><span class="p">,</span> <span class="n">i_panels</span> <span class="o">=</span> <span class="n">aero_ind</span><span class="p">[</span><span class="n">i_surf</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-92 '>    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 557, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i_surf);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i_surf);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_i_surf);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__166);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__166);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_slice__166);
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 557, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
      PyObject* sequence = __pyx_t_5;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 8)) {
        if (size &gt; 8) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(8);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 557, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
        __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 6); 
        __pyx_t_13 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 7); 
      } else {
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
        __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 6); 
        __pyx_t_13 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 7); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[8] = {&amp;__pyx_t_4,&amp;__pyx_t_2,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_13};
        for (i=0; i &lt; 8; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 557, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[8] = {&amp;__pyx_t_4,&amp;__pyx_t_2,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_13};
      __pyx_t_14 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 557, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_15 = Py_TYPE(__pyx_t_14)-&gt;tp_iternext;
      for (index=0; index &lt; 8; index++) {
        PyObject* item = __pyx_t_15(__pyx_t_14); if (unlikely(!item)) goto __pyx_L5_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_14), 8) &lt; 0) __PYX_ERR(0, 557, __pyx_L1_error)
      __pyx_t_15 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 557, __pyx_L1_error)
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_nx, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ny, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_bpts, __pyx_t_9);
    __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_panels, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_11);
    __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_bpts, __pyx_t_12);
    __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_panels, __pyx_t_13);
    __pyx_t_13 = 0;
/* … */
  __pyx_slice__166 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__166)) __PYX_ERR(0, 557, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__166);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__166);
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">0558</span>:         <span class="n">n_fem</span><span class="p">,</span> <span class="n">i_fem</span> <span class="o">=</span> <span class="n">row</span></pre>
<pre class='cython code score-47 '>    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_row))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_row))) {
      PyObject* sequence = __pyx_v_row;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 558, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_13 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_13 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 558, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_13 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 558, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      #endif
    } else {
      Py_ssize_t index = -1;
      __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_row); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 558, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_15 = Py_TYPE(__pyx_t_12)-&gt;tp_iternext;
      index = 0; __pyx_t_5 = __pyx_t_15(__pyx_t_12); if (unlikely(!__pyx_t_5)) goto __pyx_L7_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      index = 1; __pyx_t_13 = __pyx_t_15(__pyx_t_12); if (unlikely(!__pyx_t_13)) goto __pyx_L7_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_12), 2) &lt; 0) __PYX_ERR(0, 558, __pyx_L1_error)
      __pyx_t_15 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      goto __pyx_L8_unpacking_done;
      __pyx_L7_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_15 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 558, __pyx_L1_error)
      __pyx_L8_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_fem, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_fem, __pyx_t_13);
    __pyx_t_13 = 0;
</pre><pre class="cython line score-60" onclick='toggleDiv(this)'>+<span class="">0559</span>:         <span class="n">mesh2</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-60 '>    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i, __pyx_v_n); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 559, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_12 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i, __pyx_t_5, Py_None); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 559, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 559, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__167);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__167);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_slice__167);
    __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 559, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_reshape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 559, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    __pyx_t_16 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_16 = 1;
      }
    }
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_16); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 559, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (__pyx_t_12) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_16, __pyx_v_nx);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_16, __pyx_v_ny);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2+__pyx_t_16, __pyx_int_3);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 559, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_mesh2, __pyx_t_13);
    __pyx_t_13 = 0;
/* … */
  __pyx_slice__167 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__167)) __PYX_ERR(0, 559, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__167);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__167);
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">0560</span>:         <span class="n">disp2</span> <span class="o">=</span> <span class="n">disp</span><span class="p">[</span><span class="n">i_fem</span><span class="p">:</span> <span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span><span class="p">]</span></pre>
<pre class='cython code score-9 '>    __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 560, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_disp, 0, 0, &amp;__pyx_v_i_fem, &amp;__pyx_t_13, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 560, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_disp2, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0561</span>:         <span class="n">w</span> <span class="o">=</span> <span class="n">fem_origin</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_origin);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_w, __pyx_v_fem_origin);
</pre><pre class="cython line score-63" onclick='toggleDiv(this)'>+<span class="">0562</span>:         <span class="n">ref_curve</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">mesh2</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">w</span> <span class="o">*</span> <span class="n">mesh2</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span></pre>
<pre class='cython code score-63 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_w, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 562, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* … */
  __pyx_slice__168 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__168)) __PYX_ERR(0, 562, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__168);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__168);
  __pyx_slice__169 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__169)) __PYX_ERR(0, 562, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__169);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__169);
    __pyx_t_13 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh2, __pyx_tuple__170); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 562, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_13); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 562, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_tuple__170 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_slice__168, __pyx_slice__169); if (unlikely(!__pyx_tuple__170)) __PYX_ERR(0, 562, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__170);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__170);
  __pyx_slice__171 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__171)) __PYX_ERR(0, 562, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__171);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__171);
  __pyx_slice__172 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__172)) __PYX_ERR(0, 562, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__172);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__172);
    __pyx_t_13 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh2, __pyx_tuple__173); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 562, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_w, __pyx_t_13); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 562, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_11, __pyx_t_5); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 562, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ref_curve, __pyx_t_13);
    __pyx_t_13 = 0;
  __pyx_tuple__173 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_neg_1, __pyx_slice__171, __pyx_slice__172); if (unlikely(!__pyx_tuple__173)) __PYX_ERR(0, 562, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__173);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__173);
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0563</span>:         <span class="n">Smesh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">mesh2</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 563, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 563, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh2, __pyx_n_s_shape); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 563, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 563, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_13);
    __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 563, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 563, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_dtype, __pyx_t_12) &lt; 0) __PYX_ERR(0, 563, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_11, __pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 563, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_Smesh, __pyx_t_12);
    __pyx_t_12 = 0;
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0564</span>:         <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 564, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_11 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
      }
    }
    if (!__pyx_t_11) {
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_13, __pyx_v_nx); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 564, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    } else {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 564, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_11); __pyx_t_11 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_nx);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_5, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 564, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_12)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_12)) {
      __pyx_t_13 = __pyx_t_12; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13); __pyx_t_16 = 0;
      __pyx_t_17 = NULL;
    } else {
      __pyx_t_16 = -1; __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 564, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_17 = Py_TYPE(__pyx_t_13)-&gt;tp_iternext; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 564, __pyx_L1_error)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    for (;;) {
      if (likely(!__pyx_t_17)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_13))) {
          if (__pyx_t_16 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_13)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_13, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_16++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 564, __pyx_L1_error)
          #else
          __pyx_t_12 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_13, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 564, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          #endif
        } else {
          if (__pyx_t_16 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_13)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_13, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_16++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 564, __pyx_L1_error)
          #else
          __pyx_t_12 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_13, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 564, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          #endif
        }
      } else {
        __pyx_t_12 = __pyx_t_17(__pyx_t_13);
        if (unlikely(!__pyx_t_12)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else __PYX_ERR(0, 564, __pyx_L1_error)
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_12);
      __pyx_t_12 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">0565</span>:             <span class="n">Smesh</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">mesh2</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">ref_curve</span></pre>
<pre class='cython code score-61 '>  __pyx_slice__174 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__174)) __PYX_ERR(0, 565, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__174);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__174);
/* … */
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 565, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_v_ind);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__174);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__174);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_slice__174);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__175);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__175);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_slice__175);
      __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh2, __pyx_t_12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 565, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_5, __pyx_v_ref_curve); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 565, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_slice__175 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__175)) __PYX_ERR(0, 565, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__175);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__175);
  __pyx_slice__176 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__176)) __PYX_ERR(0, 565, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__176);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__176);
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 565, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_ind);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__176);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__176);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_slice__176);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__177);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__177);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_slice__177);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_Smesh, __pyx_t_5, __pyx_t_12) &lt; 0)) __PYX_ERR(0, 565, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_slice__177 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__177)) __PYX_ERR(0, 565, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__177);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__177);
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0566</span>:         <span class="n">def_mesh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">mesh2</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 566, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 566, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh2, __pyx_n_s_shape); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 566, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 566, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_13);
    __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 566, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 566, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_dtype, __pyx_t_11) &lt; 0) __PYX_ERR(0, 566, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_5, __pyx_t_13); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 566, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_def_mesh, __pyx_t_11);
    __pyx_t_11 = 0;
</pre><pre class="cython line score-12" onclick='toggleDiv(this)'>+<span class="">0567</span>:         <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span></pre>
<pre class='cython code score-12 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 567, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_cos); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 567, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 567, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_sin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 567, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cos, __pyx_t_13);
    __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sin, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">0568</span>:         <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ny</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 568, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_11 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
      }
    }
    if (!__pyx_t_11) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_13, __pyx_v_ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 568, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else {
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 568, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_11); __pyx_t_11 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+1, __pyx_v_ny);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_12, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 568, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5)) {
      __pyx_t_13 = __pyx_t_5; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13); __pyx_t_16 = 0;
      __pyx_t_17 = NULL;
    } else {
      __pyx_t_16 = -1; __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 568, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_17 = Py_TYPE(__pyx_t_13)-&gt;tp_iternext; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 568, __pyx_L1_error)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    for (;;) {
      if (likely(!__pyx_t_17)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_13))) {
          if (__pyx_t_16 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_13)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_13, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_16++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 568, __pyx_L1_error)
          #else
          __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_13, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 568, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          #endif
        } else {
          if (__pyx_t_16 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_13)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_13, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_16++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 568, __pyx_L1_error)
          #else
          __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_13, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 568, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          #endif
        }
      } else {
        __pyx_t_5 = __pyx_t_17(__pyx_t_13);
        if (unlikely(!__pyx_t_5)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else __PYX_ERR(0, 568, __pyx_L1_error)
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_5);
      __pyx_t_5 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-84" onclick='toggleDiv(this)'>+<span class="">0569</span>:             <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span> <span class="o">=</span> <span class="n">disp2</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-84 '>      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 569, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_ind);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__178);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__178);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_slice__178);
      __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_disp2, __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 569, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_12))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_12))) {
        PyObject* sequence = __pyx_t_12;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 6)) {
          if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          __PYX_ERR(0, 569, __pyx_L1_error)
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
          __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
          __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
          __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
        } else {
          __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
          __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
          __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
          __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        #else
        {
          Py_ssize_t i;
          PyObject** temps[6] = {&amp;__pyx_t_5,&amp;__pyx_t_11,&amp;__pyx_t_10,&amp;__pyx_t_9,&amp;__pyx_t_8,&amp;__pyx_t_2};
          for (i=0; i &lt; 6; i++) {
            PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 569, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(item);
            *(temps[i]) = item;
          }
        }
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      } else {
        Py_ssize_t index = -1;
        PyObject** temps[6] = {&amp;__pyx_t_5,&amp;__pyx_t_11,&amp;__pyx_t_10,&amp;__pyx_t_9,&amp;__pyx_t_8,&amp;__pyx_t_2};
        __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 569, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_15 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
        for (index=0; index &lt; 6; index++) {
          PyObject* item = __pyx_t_15(__pyx_t_4); if (unlikely(!item)) goto __pyx_L13_unpacking_failed;
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[index]) = item;
        }
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_4), 6) &lt; 0) __PYX_ERR(0, 569, __pyx_L1_error)
        __pyx_t_15 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        goto __pyx_L14_unpacking_done;
        __pyx_L13_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_15 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        __PYX_ERR(0, 569, __pyx_L1_error)
        __pyx_L14_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dx, __pyx_t_5);
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dy, __pyx_t_11);
      __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dz, __pyx_t_10);
      __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rx, __pyx_t_9);
      __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ry, __pyx_t_8);
      __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rz, __pyx_t_2);
      __pyx_t_2 = 0;
/* … */
  __pyx_slice__178 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__178)) __PYX_ERR(0, 569, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__178);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__178);
</pre><pre class="cython line score-0">&#xA0;<span class="">0570</span>:             <span class="c"># 1 eye from the axis rotation matrices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0571</span>:             <span class="c"># -3 eye from subtracting Smesh three times</span></pre>
<pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0572</span>:             <span class="n">T</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 572, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_eye); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 572, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 572, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) __PYX_ERR(0, 572, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__179, __pyx_t_12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 572, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_neg_2, __pyx_t_8); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 572, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_T, __pyx_t_12);
      __pyx_t_12 = 0;
/* … */
  __pyx_tuple__179 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3); if (unlikely(!__pyx_tuple__179)) __PYX_ERR(0, 572, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__179);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__179);
</pre><pre class="cython line score-162" onclick='toggleDiv(this)'>+<span class="">0573</span>:             <span class="n">T</span><span class="p">[</span><span class="mf">1</span><span class="p">:,</span>  <span class="mf">1</span><span class="p">:]</span> <span class="o">+=</span> <span class="p">[[</span><span class="n">cos</span><span class="p">(</span><span class="n">rx</span><span class="p">),</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">rx</span><span class="p">)],</span> <span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="n">rx</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">rx</span><span class="p">)]]</span></pre>
<pre class='cython code score-162 '>  __pyx_slice__180 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__180)) __PYX_ERR(0, 573, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__180);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__180);
  __pyx_slice__181 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__181)) __PYX_ERR(0, 573, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__181);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__181);
/* … */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__182);
      __pyx_t_18 = __pyx_tuple__182;
      __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_T, __pyx_t_18); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 573, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cos);
      __pyx_t_2 = __pyx_v_cos; __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_rx); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 573, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      } else {
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 573, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_9); __pyx_t_9 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rx);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rx);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_v_rx);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 573, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sin);
      __pyx_t_10 = __pyx_v_sin; __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_v_rx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 573, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      } else {
        __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 573, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rx);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rx);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, __pyx_v_rx);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_11, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 573, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 573, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 573, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_10);
      __pyx_t_8 = 0;
      __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sin);
      __pyx_t_8 = __pyx_v_sin; __pyx_t_11 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        }
      }
      if (!__pyx_t_11) {
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_v_rx); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 573, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      } else {
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 573, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_11); __pyx_t_11 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rx);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rx);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_rx);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_9, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 573, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cos);
      __pyx_t_9 = __pyx_v_cos; __pyx_t_11 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      if (!__pyx_t_11) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_rx); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 573, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      } else {
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 573, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_11); __pyx_t_11 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rx);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rx);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_rx);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 573, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 573, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_8);
      __pyx_t_10 = 0;
      __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 573, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_9);
      __pyx_t_2 = 0;
      __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_12, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 573, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_T, __pyx_t_18, __pyx_t_9) &lt; 0)) __PYX_ERR(0, 573, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_tuple__182 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__180, __pyx_slice__181); if (unlikely(!__pyx_tuple__182)) __PYX_ERR(0, 573, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__182);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__182);
</pre><pre class="cython line score-162" onclick='toggleDiv(this)'>+<span class="">0574</span>:             <span class="n">T</span><span class="p">[::</span> <span class="mf">2</span><span class="p">,</span> <span class="p">::</span> <span class="mf">2</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[[</span><span class="n">cos</span><span class="p">(</span><span class="n">ry</span><span class="p">),</span>  <span class="n">sin</span><span class="p">(</span><span class="n">ry</span><span class="p">)],</span> <span class="p">[</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">ry</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">ry</span><span class="p">)]]</span></pre>
<pre class='cython code score-162 '>  __pyx_slice__183 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, __pyx_int_2); if (unlikely(!__pyx_slice__183)) __PYX_ERR(0, 574, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__183);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__183);
  __pyx_slice__184 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, __pyx_int_2); if (unlikely(!__pyx_slice__184)) __PYX_ERR(0, 574, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__184);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__184);
/* … */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__185);
      __pyx_t_18 = __pyx_tuple__185;
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_T, __pyx_t_18); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 574, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cos);
      __pyx_t_12 = __pyx_v_cos; __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, __pyx_v_ry); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 574, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      } else {
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 574, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_2); __pyx_t_2 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ry);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ry);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_v_ry);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 574, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sin);
      __pyx_t_10 = __pyx_v_sin; __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_v_ry); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 574, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      } else {
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 574, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ry);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ry);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_ry);
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 574, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 574, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_12);
      __pyx_t_8 = 0;
      __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sin);
      __pyx_t_8 = __pyx_v_sin; __pyx_t_5 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        }
      }
      if (!__pyx_t_5) {
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_v_ry); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 574, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      } else {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ry);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ry);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_ry);
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_2, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 574, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 574, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cos);
      __pyx_t_2 = __pyx_v_cos; __pyx_t_5 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_5) {
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_ry); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 574, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      } else {
        __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 574, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_5); __pyx_t_5 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ry);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ry);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, __pyx_v_ry);
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_11, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 574, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_12);
      __pyx_t_8 = 0;
      __pyx_t_12 = 0;
      __pyx_t_12 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 574, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_2);
      __pyx_t_10 = 0;
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_9, __pyx_t_12); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_T, __pyx_t_18, __pyx_t_2) &lt; 0)) __PYX_ERR(0, 574, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_tuple__185 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__183, __pyx_slice__184); if (unlikely(!__pyx_tuple__185)) __PYX_ERR(0, 574, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__185);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__185);
</pre><pre class="cython line score-162" onclick='toggleDiv(this)'>+<span class="">0575</span>:             <span class="n">T</span><span class="p">[:</span> <span class="mf">2</span><span class="p">,</span> <span class="p">:</span> <span class="mf">2</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[[</span><span class="n">cos</span><span class="p">(</span><span class="n">rz</span><span class="p">),</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">rz</span><span class="p">)],</span> <span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="n">rz</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">rz</span><span class="p">)]]</span></pre>
<pre class='cython code score-162 '>  __pyx_slice__186 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_2, Py_None); if (unlikely(!__pyx_slice__186)) __PYX_ERR(0, 575, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__186);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__186);
  __pyx_slice__187 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_2, Py_None); if (unlikely(!__pyx_slice__187)) __PYX_ERR(0, 575, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__187);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__187);
/* … */
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__188);
      __pyx_t_18 = __pyx_tuple__188;
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_T, __pyx_t_18); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 575, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cos);
      __pyx_t_9 = __pyx_v_cos; __pyx_t_10 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      if (!__pyx_t_10) {
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_rz); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 575, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      } else {
        __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 575, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_10); __pyx_t_10 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rz);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rz);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, __pyx_v_rz);
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_8, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 575, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sin);
      __pyx_t_8 = __pyx_v_sin; __pyx_t_10 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        }
      }
      if (!__pyx_t_10) {
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_v_rz); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 575, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      } else {
        __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 575, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_10); __pyx_t_10 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rz);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rz);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, __pyx_v_rz);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_11, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 575, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 575, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 575, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_8);
      __pyx_t_12 = 0;
      __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sin);
      __pyx_t_12 = __pyx_v_sin; __pyx_t_11 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
        }
      }
      if (!__pyx_t_11) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, __pyx_v_rz); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 575, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      } else {
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 575, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_11); __pyx_t_11 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rz);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rz);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_v_rz);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_10, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 575, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cos);
      __pyx_t_10 = __pyx_v_cos; __pyx_t_11 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        }
      }
      if (!__pyx_t_11) {
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_v_rz); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 575, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      } else {
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 575, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_11); __pyx_t_11 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rz);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rz);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_rz);
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 575, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 575, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_12);
      __pyx_t_8 = 0;
      __pyx_t_12 = 0;
      __pyx_t_12 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 575, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_10);
      __pyx_t_9 = 0;
      __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_2, __pyx_t_12); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 575, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_T, __pyx_t_18, __pyx_t_10) &lt; 0)) __PYX_ERR(0, 575, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_tuple__188 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__186, __pyx_slice__187); if (unlikely(!__pyx_tuple__188)) __PYX_ERR(0, 575, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__188);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__188);
</pre><pre class="cython line score-94" onclick='toggleDiv(this)'>+<span class="">0576</span>:             <span class="n">def_mesh</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">Smesh</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-94 '>  __pyx_slice__189 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__189)) __PYX_ERR(0, 576, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__189);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__189);
/* … */
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 576, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__189);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__189);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_slice__189);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_ind);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__190);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__190);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_slice__190);
      __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_def_mesh, __pyx_t_10); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 576, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_slice__190 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__190)) __PYX_ERR(0, 576, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__190);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__190);
  __pyx_slice__191 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__191)) __PYX_ERR(0, 576, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__191);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__191);
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 576, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__191);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__191);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_slice__191);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_ind);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__192);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__192);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_slice__192);
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Smesh, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 576, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_dot); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 576, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      if (!__pyx_t_8) {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_T); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 576, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      } else {
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 576, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_8); __pyx_t_8 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_T);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_T);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_T);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 576, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_12, __pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 576, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_def_mesh, __pyx_t_10, __pyx_t_9) &lt; 0)) __PYX_ERR(0, 576, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_slice__192 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__192)) __PYX_ERR(0, 576, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__192);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__192);
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0577</span>:             <span class="n">def_mesh</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dx</span></pre>
<pre class='cython code score-34 '>      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 577, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__193);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__193);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_slice__193);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_ind);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_int_0);
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_def_mesh, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 577, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_9, __pyx_v_dx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 577, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_def_mesh, __pyx_t_10, __pyx_t_2) &lt; 0)) __PYX_ERR(0, 577, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
/* … */
  __pyx_slice__193 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__193)) __PYX_ERR(0, 577, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__193);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__193);
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0578</span>:             <span class="n">def_mesh</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dy</span></pre>
<pre class='cython code score-34 '>      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 578, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__194);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__194);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_slice__194);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_ind);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_int_1);
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_def_mesh, __pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 578, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_2, __pyx_v_dy); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 578, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_def_mesh, __pyx_t_10, __pyx_t_9) &lt; 0)) __PYX_ERR(0, 578, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
/* … */
  __pyx_slice__194 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__194)) __PYX_ERR(0, 578, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__194);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__194);
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0579</span>:             <span class="n">def_mesh</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dz</span></pre>
<pre class='cython code score-34 '>      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 579, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__195);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__195);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_slice__195);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_ind);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_int_2);
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_def_mesh, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 579, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_9, __pyx_v_dz); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 579, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_def_mesh, __pyx_t_10, __pyx_t_2) &lt; 0)) __PYX_ERR(0, 579, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
/* … */
  __pyx_slice__195 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__195)) __PYX_ERR(0, 579, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__195);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__195);
</pre><pre class="cython line score-63" onclick='toggleDiv(this)'>+<span class="">0580</span>:         <span class="n">out_def_mesh</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">def_mesh</span> <span class="o">+</span> <span class="n">mesh2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-63 '>    __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_def_mesh, __pyx_v_mesh2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 580, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_reshape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 580, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = NULL;
    __pyx_t_16 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_16 = 1;
      }
    }
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_16); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 580, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_10) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_10); __pyx_t_10 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_16, __pyx_v_n);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_16, __pyx_int_3);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, NULL); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 580, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i, __pyx_v_n); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 580, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_9 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 580, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 580, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__196);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__196);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_slice__196);
    __pyx_t_9 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out_def_mesh, __pyx_t_2, __pyx_t_13) &lt; 0)) __PYX_ERR(0, 580, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
/* … */
  __pyx_slice__196 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__196)) __PYX_ERR(0, 580, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__196);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__196);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0581</span>:     <span class="k">return</span> <span class="n">out_def_mesh</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out_def_mesh);
  __pyx_r = __pyx_v_out_def_mesh;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0582</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0583</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0584</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0585</span>: <span class="sd">--------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0586</span>: <span class="sd">--------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0587</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0588</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>: <span class="sd">                                    AERODYNAMICS</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0591</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0592</span>: <span class="sd">--------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0593</span>: <span class="sd">--------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0594</span>: <span class="sd">From vlm.py: &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0595</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0596</span>: </pre>
<pre class="cython line score-75" onclick='toggleDiv(this)'>+<span class="">0597</span>: <span class="k">def</span> <span class="nf">aero</span><span class="p">(</span><span class="n">def_mesh</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-75 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_31aero(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_31aero = {"aero", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_31aero, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_31aero(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_def_mesh = 0;
  PyObject *__pyx_v_params = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("aero (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_def_mesh,&amp;__pyx_n_s_params,0};
    PyObject* values[2] = {0,0};
    values[0] = ((PyObject *)((PyObject *)Py_None));
    values[1] = ((PyObject *)((PyObject *)Py_None));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_def_mesh);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_params);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "aero") &lt; 0)) __PYX_ERR(0, 597, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_def_mesh = values[0];
    __pyx_v_params = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("aero", 0, 0, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 597, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.aero", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_30aero(__pyx_self, __pyx_v_def_mesh, __pyx_v_params);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_30aero(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_def_mesh, PyObject *__pyx_v_params) {
  PyObject *__pyx_v_aero_ind = NULL;
  PyObject *__pyx_v_alpha = NULL;
  PyObject *__pyx_v_v = NULL;
  PyObject *__pyx_v_rho = NULL;
  PyObject *__pyx_v_fem_ind = NULL;
  PyObject *__pyx_v_fem_origin = NULL;
  PyObject *__pyx_v_b_pts = NULL;
  PyObject *__pyx_v_mid_b = NULL;
  PyObject *__pyx_v_c_pts = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_widths = NULL;
  PyObject *__pyx_v_normals = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_S_ref = NULL;
  PyObject *__pyx_v_circulations = NULL;
  PyObject *__pyx_v_sec_forces = NULL;
  PyObject *__pyx_v_loads = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("aero", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.aero", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_alpha);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rho);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fem_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fem_origin);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_b_pts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mid_b);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_c_pts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_widths);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_normals);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_S_ref);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_circulations);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sec_forces);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_loads);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__573 = <span class='py_c_api'>PyTuple_Pack</span>(17, __pyx_n_s_def_mesh, __pyx_n_s_params, __pyx_n_s_aero_ind, __pyx_n_s_alpha, __pyx_n_s_v, __pyx_n_s_rho, __pyx_n_s_fem_ind, __pyx_n_s_fem_origin, __pyx_n_s_b_pts, __pyx_n_s_mid_b, __pyx_n_s_c_pts, __pyx_n_s_widths, __pyx_n_s_normals, __pyx_n_s_S_ref, __pyx_n_s_circulations, __pyx_n_s_sec_forces, __pyx_n_s_loads); if (unlikely(!__pyx_tuple__573)) __PYX_ERR(0, 597, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__573);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__573);
  __pyx_codeobj__574 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 17, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__573, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_aero, 597, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__574)) __PYX_ERR(0, 597, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_31aero, 0, __pyx_n_s_aero, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__574)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 597, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__575);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_aero, __pyx_t_2) &lt; 0) __PYX_ERR(0, 597, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__575 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject *)Py_None), ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__575)) __PYX_ERR(0, 597, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__575);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__575);
</pre><pre class="cython line score-0">&#xA0;<span class="">0598</span>:     <span class="c"># Unpack variables</span></pre>
<pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0599</span>:     <span class="n">aero_ind</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;aero_ind&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 599, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__197, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 599, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_aero_ind = __pyx_t_2;
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__197 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_aero_ind); if (unlikely(!__pyx_tuple__197)) __PYX_ERR(0, 599, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__197);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__197);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0600</span>:     <span class="n">alpha</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;alpha&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 600, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__198, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 600, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_alpha = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__198 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_alpha); if (unlikely(!__pyx_tuple__198)) __PYX_ERR(0, 600, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__198);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__198);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0601</span>:     <span class="n">v</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;v&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 601, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__199, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 601, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_v = __pyx_t_2;
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__199 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_v); if (unlikely(!__pyx_tuple__199)) __PYX_ERR(0, 601, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__199);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__199);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0602</span>:     <span class="n">rho</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;rho&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 602, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__200, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 602, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_rho = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__200 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_rho); if (unlikely(!__pyx_tuple__200)) __PYX_ERR(0, 602, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__200);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__200);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0603</span>:     <span class="n">fem_ind</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;fem_ind&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 603, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__201, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 603, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_fem_ind = __pyx_t_2;
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__201 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_fem_ind); if (unlikely(!__pyx_tuple__201)) __PYX_ERR(0, 603, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__201);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__201);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0604</span>:     <span class="n">fem_origin</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;fem_origin&#39;</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 604, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__202, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 604, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_fem_origin = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__202 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_fem_origin, __pyx_float_0_35); if (unlikely(!__pyx_tuple__202)) __PYX_ERR(0, 604, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__202);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__202);
</pre><pre class="cython line score-0">&#xA0;<span class="">0605</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0606</span>:     <span class="c"># num_y = params.get(&#39;num_y&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0607</span>:     <span class="c"># span = params.get(&#39;span&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0608</span>:     <span class="c"># twist_cp = params.get(&#39;twist_cp&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0609</span>:     <span class="c"># thickness_cp = params.get(&#39;thickness_cp&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0610</span>:     <span class="c"># num_thickness = params.get(&#39;num_thickness&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0611</span>:     <span class="c"># num_twist = params.get(&#39;num_twist&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0612</span>:     <span class="c"># sweep = params.get(&#39;sweep&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0613</span>:     <span class="c"># taper = params.get(&#39;taper&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0614</span>:     <span class="c"># disp = params.get(&#39;disp&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0615</span>:     <span class="c"># dihedral = params.get(&#39;dihedral&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0616</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0617</span>:     <span class="c"># # Define Jacobians for b-spline controls</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0618</span>:     <span class="c"># tot_n_fem = numpy.sum(fem_ind[:, 0])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0619</span>:     <span class="c"># num_surf = fem_ind.shape[0]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0620</span>:     <span class="c"># jac_twist = get_bspline_mtx(num_twist, num_y)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0621</span>:     <span class="c"># jac_thickness = get_bspline_mtx(num_thickness, tot_n_fem - num_surf)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0622</span>: </pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0623</span>:     <span class="n">b_pts</span><span class="p">,</span> <span class="n">mid_b</span><span class="p">,</span> <span class="n">c_pts</span><span class="p">,</span> <span class="n">widths</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">S_ref</span> <span class="o">=</span> <span class="n">vlm_geometry</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_vlm_geometry); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 623, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_v_b_pts = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_mid_b = __pyx_t_5;
  __pyx_t_5 = 0;
  __pyx_v_c_pts = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_widths = __pyx_t_6;
  __pyx_t_6 = 0;
  __pyx_v_normals = __pyx_t_7;
  __pyx_t_7 = 0;
  __pyx_v_S_ref = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-82" onclick='toggleDiv(this)'>+<span class="">0624</span>:         <span class="n">aero_ind</span><span class="p">,</span> <span class="n">def_mesh</span><span class="p">)</span></pre>
<pre class='cython code score-82 '>  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_def_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_def_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_def_mesh);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 623, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 6)) {
      if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 623, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
      __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
      __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
      __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
      __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
    #else
    {
      Py_ssize_t i;
      PyObject** temps[6] = {&amp;__pyx_t_2,&amp;__pyx_t_5,&amp;__pyx_t_3,&amp;__pyx_t_6,&amp;__pyx_t_7,&amp;__pyx_t_8};
      for (i=0; i &lt; 6; i++) {
        PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 623, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[i]) = item;
      }
    }
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[6] = {&amp;__pyx_t_2,&amp;__pyx_t_5,&amp;__pyx_t_3,&amp;__pyx_t_6,&amp;__pyx_t_7,&amp;__pyx_t_8};
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 623, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_10 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;
    for (index=0; index &lt; 6; index++) {
      PyObject* item = __pyx_t_10(__pyx_t_9); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(item);
      *(temps[index]) = item;
    }
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_10(__pyx_t_9), 6) &lt; 0) __PYX_ERR(0, 623, __pyx_L1_error)
    __pyx_t_10 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_10 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 623, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0625</span>:     <span class="n">circulations</span> <span class="o">=</span> <span class="n">vlm_circulations</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_vlm_circulations); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 625, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0626</span>:         <span class="n">aero_ind</span><span class="p">,</span> <span class="n">def_mesh</span><span class="p">,</span> <span class="n">b_pts</span><span class="p">,</span> <span class="n">c_pts</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  __pyx_t_7 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(7+__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 625, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (__pyx_t_7) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_7); __pyx_t_7 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_4, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_def_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_def_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_4, __pyx_v_def_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_b_pts);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_b_pts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_4, __pyx_v_b_pts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_c_pts);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_c_pts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3+__pyx_t_4, __pyx_v_c_pts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_normals);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_normals);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 4+__pyx_t_4, __pyx_v_normals);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_v);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_v);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 5+__pyx_t_4, __pyx_v_v);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alpha);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_alpha);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 6+__pyx_t_4, __pyx_v_alpha);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_circulations = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0627</span>:     <span class="n">sec_forces</span> <span class="o">=</span> <span class="n">vlm_forces</span><span class="p">(</span><span class="n">def_mesh</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">b_pts</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_vlm_forces); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 627, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
</pre><pre class="cython line score-36" onclick='toggleDiv(this)'>+<span class="">0628</span>:                             <span class="n">mid_b</span><span class="p">,</span> <span class="n">circulations</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">rho</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>  __pyx_t_6 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(8+__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 627, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (__pyx_t_6) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_def_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_def_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_4, __pyx_v_def_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_4, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_b_pts);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_b_pts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2+__pyx_t_4, __pyx_v_b_pts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mid_b);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mid_b);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3+__pyx_t_4, __pyx_v_mid_b);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_circulations);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_circulations);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 4+__pyx_t_4, __pyx_v_circulations);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alpha);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_alpha);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 5+__pyx_t_4, __pyx_v_alpha);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_v);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_v);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 6+__pyx_t_4, __pyx_v_v);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rho);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rho);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 7+__pyx_t_4, __pyx_v_rho);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_sec_forces = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0629</span>:     <span class="n">loads</span> <span class="o">=</span> <span class="n">transfer_loads</span><span class="p">(</span><span class="n">def_mesh</span><span class="p">,</span> <span class="n">sec_forces</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">,</span> <span class="n">fem_origin</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_transfer_loads); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 629, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_7 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(5+__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 629, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (__pyx_t_7) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_7); __pyx_t_7 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_def_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_def_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_4, __pyx_v_def_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sec_forces);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sec_forces);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_4, __pyx_v_sec_forces);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_4, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fem_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3+__pyx_t_4, __pyx_v_fem_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_origin);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fem_origin);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 4+__pyx_t_4, __pyx_v_fem_origin);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 629, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_loads = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0630</span>:     <span class="k">return</span> <span class="n">loads</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_loads);
  __pyx_r = __pyx_v_loads;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0631</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0632</span>: </pre>
<pre class="cython line score-67" onclick='toggleDiv(this)'>+<span class="">0633</span>: <span class="k">def</span> <span class="nf">calc_vorticity</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span></pre>
<pre class='cython code score-67 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_33calc_vorticity(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_32calc_vorticity[] = " Calculates the influence coefficient for a vortex filament.\n\n    Parameters\n    ----------\n    A[3] : array_like\n        Coordinates for the start point of the filament.\n    B[3] : array_like\n        Coordinates for the end point of the filament.\n    P[3] : array_like\n        Coordinates for the collocation point where the influence coefficient\n        is computed.\n\n    Returns\n    -------\n    out[3] : array_like\n        Influence coefficient contribution for the described filament.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_33calc_vorticity = {"calc_vorticity", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_33calc_vorticity, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_32calc_vorticity};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_33calc_vorticity(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_A = 0;
  PyObject *__pyx_v_B = 0;
  PyObject *__pyx_v_P = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calc_vorticity (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_A,&amp;__pyx_n_s_B,&amp;__pyx_n_s_P,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_A)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_B)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_vorticity", 1, 3, 3, 1); __PYX_ERR(0, 633, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_P)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_vorticity", 1, 3, 3, 2); __PYX_ERR(0, 633, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "calc_vorticity") &lt; 0)) __PYX_ERR(0, 633, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_A = values[0];
    __pyx_v_B = values[1];
    __pyx_v_P = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calc_vorticity", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 633, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.calc_vorticity", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_32calc_vorticity(__pyx_self, __pyx_v_A, __pyx_v_B, __pyx_v_P);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_32calc_vorticity(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_A, PyObject *__pyx_v_B, PyObject *__pyx_v_P) {
  PyObject *__pyx_v_r1 = NULL;
  PyObject *__pyx_v_r2 = NULL;
  PyObject *__pyx_v_r1_mag = NULL;
  PyObject *__pyx_v_r2_mag = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calc_vorticity", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.calc_vorticity", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r1_mag);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r2_mag);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__576 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_A, __pyx_n_s_B, __pyx_n_s_P, __pyx_n_s_r1, __pyx_n_s_r2, __pyx_n_s_r1_mag, __pyx_n_s_r2_mag); if (unlikely(!__pyx_tuple__576)) __PYX_ERR(0, 633, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__576);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__576);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_33calc_vorticity, 0, __pyx_n_s_calc_vorticity, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__577)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 633, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calc_vorticity, __pyx_t_2) &lt; 0) __PYX_ERR(0, 633, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__577 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__576, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_calc_vorticity, 633, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__577)) __PYX_ERR(0, 633, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0634</span>:     <span class="sd">&quot;&quot;&quot; Calculates the influence coefficient for a vortex filament.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0635</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0636</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0637</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0638</span>: <span class="sd">    A[3] : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0639</span>: <span class="sd">        Coordinates for the start point of the filament.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0640</span>: <span class="sd">    B[3] : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0641</span>: <span class="sd">        Coordinates for the end point of the filament.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0642</span>: <span class="sd">    P[3] : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0643</span>: <span class="sd">        Coordinates for the collocation point where the influence coefficient</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0644</span>: <span class="sd">        is computed.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0645</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0646</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0647</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0648</span>: <span class="sd">    out[3] : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0649</span>: <span class="sd">        Influence coefficient contribution for the described filament.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0650</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0651</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0652</span>:     <span class="n">r1</span> <span class="o">=</span> <span class="n">P</span> <span class="o">-</span> <span class="n">A</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_P, __pyx_v_A); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 652, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_r1 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0653</span>:     <span class="n">r2</span> <span class="o">=</span> <span class="n">P</span> <span class="o">-</span> <span class="n">B</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_P, __pyx_v_B); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 653, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_r2 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">0654</span>:     <span class="n">r1_mag</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_norm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 654, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_r1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 654, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_r1);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_r1_mag = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">0655</span>:     <span class="n">r2_mag</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_norm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 655, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_r2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 655, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_r2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_r2_mag = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-96" onclick='toggleDiv(this)'>+<span class="">0656</span>:     <span class="k">return</span> <span class="p">(</span><span class="n">r1_mag</span> <span class="o">+</span> <span class="n">r2_mag</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">r1_mag</span> <span class="o">*</span> <span class="n">r2_mag</span> <span class="o">*</span> <span class="p">(</span><span class="n">r1_mag</span> <span class="o">*</span> <span class="n">r2_mag</span> <span class="o">+</span> <span class="n">r1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r2</span><span class="p">)))</span></pre>
<pre class='cython code score-96 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_r1_mag, __pyx_v_r2_mag); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 656, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 656, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cross); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 656, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 656, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_5, __pyx_v_r1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_5, __pyx_v_r2);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 656, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 656, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_r1_mag, __pyx_v_r2_mag); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 656, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_r1_mag, __pyx_v_r2_mag); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 656, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_r1, __pyx_n_s_dot); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 656, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_7) {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_r2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 656, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  } else {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 656, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_7); __pyx_t_7 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, __pyx_v_r2);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_8, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 656, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 656, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 656, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 656, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0657</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0658</span>: </pre>
<pre class="cython line score-62" onclick='toggleDiv(this)'>+<span class="">0659</span>: <span class="k">def</span> <span class="nf">get_lengths</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span></pre>
<pre class='cython code score-62 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_35get_lengths(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_35get_lengths = {"get_lengths", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_35get_lengths, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_35get_lengths(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_A = 0;
  PyObject *__pyx_v_B = 0;
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_lengths (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_A,&amp;__pyx_n_s_B,&amp;__pyx_n_s_axis,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_A)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_B)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_lengths", 1, 3, 3, 1); __PYX_ERR(0, 659, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_axis)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_lengths", 1, 3, 3, 2); __PYX_ERR(0, 659, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_lengths") &lt; 0)) __PYX_ERR(0, 659, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_A = values[0];
    __pyx_v_B = values[1];
    __pyx_v_axis = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_lengths", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 659, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.get_lengths", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_34get_lengths(__pyx_self, __pyx_v_A, __pyx_v_B, __pyx_v_axis);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_34get_lengths(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_A, PyObject *__pyx_v_B, PyObject *__pyx_v_axis) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_lengths", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.get_lengths", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__578 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_A, __pyx_n_s_B, __pyx_n_s_axis); if (unlikely(!__pyx_tuple__578)) __PYX_ERR(0, 659, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__578);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__578);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_35get_lengths, 0, __pyx_n_s_get_lengths, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__579)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 659, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_lengths, __pyx_t_2) &lt; 0) __PYX_ERR(0, 659, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__579 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 3, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__578, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_get_lengths, 659, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__579)) __PYX_ERR(0, 659, __pyx_L1_error)
</pre><pre class="cython line score-67" onclick='toggleDiv(this)'>+<span class="">0660</span>:     <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">B</span> <span class="o">-</span> <span class="n">A</span><span class="p">)</span><span class="o">**</span><span class="mf">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span></pre>
<pre class='cython code score-67 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 660, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 660, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_B, __pyx_v_A); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_2, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 660, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 660, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_axis, __pyx_v_axis) &lt; 0) __PYX_ERR(0, 660, __pyx_L1_error)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 660, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0661</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0662</span>: </pre>
<pre class="cython line score-86" onclick='toggleDiv(this)'>+<span class="">0663</span>: <span class="k">def</span> <span class="nf">vlm_geometry</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">,</span> <span class="n">def_mesh</span><span class="p">):</span></pre>
<pre class='cython code score-86 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_37vlm_geometry(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_36vlm_geometry[] = " Compute various geometric properties for VLM analysis.\n\n    Parameters\n    ----------\n    def_mesh : array_like\n        Flattened array defining the lifting surfaces.\n\n    Returns\n    -------\n    b_pts : array_like\n        Bound points for the horseshoe vortices, found along the 1/4 chord.\n    mid_b : array_like\n        Midpoints of the bound vortex segments, used as the collocation\n        points to compute drag.\n    c_pts : array_like\n        Collocation points on the 3/4 chord line where the flow tangency\n        condition is satisfed. Used to set up the linear system.\n    widths : array_like\n        The spanwise widths of each individual panel.\n    normals : array_like\n        The normal vector for each panel, computed as the cross of the two\n        diagonals from the mesh points.\n    S_ref : array_like\n        The reference areas of each lifting surface.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_37vlm_geometry = {"vlm_geometry", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_37vlm_geometry, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_36vlm_geometry};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_37vlm_geometry(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_aero_ind = 0;
  PyObject *__pyx_v_def_mesh = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("vlm_geometry (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_aero_ind,&amp;__pyx_n_s_def_mesh,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aero_ind)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_def_mesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_geometry", 1, 2, 2, 1); __PYX_ERR(0, 663, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vlm_geometry") &lt; 0)) __PYX_ERR(0, 663, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_aero_ind = values[0];
    __pyx_v_def_mesh = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_geometry", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 663, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.vlm_geometry", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_36vlm_geometry(__pyx_self, __pyx_v_aero_ind, __pyx_v_def_mesh);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_36vlm_geometry(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_aero_ind, PyObject *__pyx_v_def_mesh) {
  PyObject *__pyx_v_num_surf = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_tot_n = NULL;
  PyObject *__pyx_v_tot_bpts = NULL;
  PyObject *__pyx_v_tot_panels = NULL;
  PyObject *__pyx_v_B_PTS = NULL;
  PyObject *__pyx_v_MID_B = NULL;
  PyObject *__pyx_v_C_PTS = NULL;
  PyObject *__pyx_v_WIDTHS = NULL;
  PyObject *__pyx_v_NORMALS = NULL;
  PyObject *__pyx_v_S_REF = NULL;
  PyObject *__pyx_v_i_surf = NULL;
  PyObject *__pyx_v_row = NULL;
  PyObject *__pyx_v_nx = NULL;
  PyObject *__pyx_v_ny = NULL;
  PyObject *__pyx_v_n = NULL;
  PyObject *__pyx_v_n_bpts = NULL;
  PyObject *__pyx_v_n_panels = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_i_bpts = NULL;
  PyObject *__pyx_v_i_panels = NULL;
  PyObject *__pyx_v_mesh = NULL;
  PyObject *__pyx_v_b_pts = NULL;
  PyObject *__pyx_v_mid_b = NULL;
  PyObject *__pyx_v_c_pts = NULL;
  PyObject *__pyx_v_widths = NULL;
  PyObject *__pyx_v_normals = NULL;
  PyObject *__pyx_v_norms = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("vlm_geometry", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.vlm_geometry", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_B_PTS);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_MID_B);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_C_PTS);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_WIDTHS);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_NORMALS);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_S_REF);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_b_pts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mid_b);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_c_pts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_widths);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_normals);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_norms);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__580 = <span class='py_c_api'>PyTuple_Pack</span>(30, __pyx_n_s_aero_ind, __pyx_n_s_def_mesh, __pyx_n_s_num_surf, __pyx_n_s_tot_n, __pyx_n_s_tot_bpts, __pyx_n_s_tot_panels, __pyx_n_s_B_PTS, __pyx_n_s_MID_B, __pyx_n_s_C_PTS, __pyx_n_s_WIDTHS, __pyx_n_s_NORMALS, __pyx_n_s_S_REF, __pyx_n_s_i_surf, __pyx_n_s_row, __pyx_n_s_nx, __pyx_n_s_ny, __pyx_n_s_n, __pyx_n_s_n_bpts, __pyx_n_s_n_panels, __pyx_n_s_i, __pyx_n_s_i_bpts, __pyx_n_s_i_panels, __pyx_n_s_mesh, __pyx_n_s_b_pts, __pyx_n_s_mid_b, __pyx_n_s_c_pts, __pyx_n_s_widths, __pyx_n_s_normals, __pyx_n_s_norms, __pyx_n_s_j); if (unlikely(!__pyx_tuple__580)) __PYX_ERR(0, 663, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__580);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__580);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_37vlm_geometry, 0, __pyx_n_s_vlm_geometry, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__581)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 663, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_vlm_geometry, __pyx_t_2) &lt; 0) __PYX_ERR(0, 663, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__581 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 30, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__580, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_vlm_geometry, 663, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__581)) __PYX_ERR(0, 663, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0664</span>:     <span class="sd">&quot;&quot;&quot; Compute various geometric properties for VLM analysis.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0665</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0666</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0667</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0668</span>: <span class="sd">    def_mesh : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0669</span>: <span class="sd">        Flattened array defining the lifting surfaces.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0670</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0671</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0672</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0673</span>: <span class="sd">    b_pts : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0674</span>: <span class="sd">        Bound points for the horseshoe vortices, found along the 1/4 chord.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0675</span>: <span class="sd">    mid_b : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0676</span>: <span class="sd">        Midpoints of the bound vortex segments, used as the collocation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0677</span>: <span class="sd">        points to compute drag.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0678</span>: <span class="sd">    c_pts : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0679</span>: <span class="sd">        Collocation points on the 3/4 chord line where the flow tangency</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0680</span>: <span class="sd">        condition is satisfed. Used to set up the linear system.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0681</span>: <span class="sd">    widths : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0682</span>: <span class="sd">        The spanwise widths of each individual panel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0683</span>: <span class="sd">    normals : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0684</span>: <span class="sd">        The normal vector for each panel, computed as the cross of the two</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0685</span>: <span class="sd">        diagonals from the mesh points.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0686</span>: <span class="sd">    S_ref : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0687</span>: <span class="sd">        The reference areas of each lifting surface.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0688</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0689</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0690</span>:     <span class="n">num_surf</span> <span class="o">=</span> <span class="n">aero_ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_aero_ind, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 690, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_num_surf = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0691</span>:     <span class="n">tot_n</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 691, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 691, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__203 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__203)) __PYX_ERR(0, 691, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__203);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__203);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__204); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 691, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 691, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 691, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 691, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_tot_n = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_tuple__204 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__203, __pyx_int_2); if (unlikely(!__pyx_tuple__204)) __PYX_ERR(0, 691, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__204);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__204);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0692</span>:     <span class="n">tot_bpts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">3</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 692, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 692, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__205 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__205)) __PYX_ERR(0, 692, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__205);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__205);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__206); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 692, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 692, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 692, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_tot_bpts = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_tuple__206 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__205, __pyx_int_3); if (unlikely(!__pyx_tuple__206)) __PYX_ERR(0, 692, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__206);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__206);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0693</span>:     <span class="n">tot_panels</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">4</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 693, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 693, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_slice__207 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__207)) __PYX_ERR(0, 693, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__207);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__207);
  __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__208); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 693, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 693, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 693, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 693, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_tot_panels = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_tuple__208 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__207, __pyx_int_4); if (unlikely(!__pyx_tuple__208)) __PYX_ERR(0, 693, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__208);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__208);
</pre><pre class="cython line score-0">&#xA0;<span class="">0694</span>: </pre>
<pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0695</span>:     <span class="n">B_PTS</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_bpts</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 695, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 695, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 695, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_bpts);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_bpts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_tot_bpts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 695, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 695, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 695, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) __PYX_ERR(0, 695, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 695, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_B_PTS = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0696</span>:     <span class="n">MID_B</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_panels</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 696, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 696, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) __PYX_ERR(0, 696, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 696, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_MID_B = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0697</span>:     <span class="n">C_PTS</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_panels</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-38 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 697, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 697, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_C_PTS = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0698</span>:     <span class="n">WIDTHS</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_panels</span><span class="p">))</span></pre>
<pre class='cython code score-29 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 698, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_tot_panels); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 698, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_tot_panels);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_WIDTHS = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0699</span>:     <span class="n">NORMALS</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_panels</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-38 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 699, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 699, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 699, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 699, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 699, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 699, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_NORMALS = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0700</span>:     <span class="n">S_REF</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_surf</span><span class="p">))</span></pre>
<pre class='cython code score-29 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 700, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 700, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_num_surf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 700, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 700, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_surf);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_surf);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_num_surf);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 700, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_S_REF = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0701</span>: </pre>
<pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0702</span>:     <span class="k">for</span> <span class="n">i_surf</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_4 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_aero_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_aero_ind)) {
    __pyx_t_2 = __pyx_v_aero_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_aero_ind); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 702, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 702, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 702, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 702, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 702, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 702, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_7(__pyx_t_2);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 702, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_surf, __pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 702, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4);
    __pyx_t_4 = __pyx_t_3;
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-70" onclick='toggleDiv(this)'>+<span class="">0703</span>:         <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_bpts</span><span class="p">,</span> <span class="n">n_panels</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_bpts</span><span class="p">,</span> <span class="n">i_panels</span> <span class="o">=</span> <span class="n">row</span></pre>
<pre class='cython code score-70 '>    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_row))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_row))) {
      PyObject* sequence = __pyx_v_row;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 8)) {
        if (size &gt; 8) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(8);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 703, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 6); 
        __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 7); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 6); 
        __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 7); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[8] = {&amp;__pyx_t_3,&amp;__pyx_t_5,&amp;__pyx_t_1,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12};
        for (i=0; i &lt; 8; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 703, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[8] = {&amp;__pyx_t_3,&amp;__pyx_t_5,&amp;__pyx_t_1,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12};
      __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_row); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 703, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_14 = Py_TYPE(__pyx_t_13)-&gt;tp_iternext;
      for (index=0; index &lt; 8; index++) {
        PyObject* item = __pyx_t_14(__pyx_t_13); if (unlikely(!item)) goto __pyx_L5_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_14(__pyx_t_13), 8) &lt; 0) __PYX_ERR(0, 703, __pyx_L1_error)
      __pyx_t_14 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_14 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 703, __pyx_L1_error)
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_nx, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ny, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_bpts, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_panels, __pyx_t_9);
    __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_bpts, __pyx_t_11);
    __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_panels, __pyx_t_12);
    __pyx_t_12 = 0;
</pre><pre class="cython line score-60" onclick='toggleDiv(this)'>+<span class="">0704</span>:         <span class="n">mesh</span> <span class="o">=</span> <span class="n">def_mesh</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-60 '>    __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i, __pyx_v_n); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 704, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_10 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i, __pyx_t_11, Py_None); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 704, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 704, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__209);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__209);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_slice__209);
    __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_def_mesh, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 704, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_reshape); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 704, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = NULL;
    __pyx_t_15 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        __pyx_t_15 = 1;
      }
    }
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 704, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_10) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_10); __pyx_t_10 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_15, __pyx_v_nx);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_15, __pyx_v_ny);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_15, __pyx_int_3);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_9, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 704, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_mesh, __pyx_t_12);
    __pyx_t_12 = 0;
/* … */
  __pyx_slice__209 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__209)) __PYX_ERR(0, 704, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__209);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__209);
</pre><pre class="cython line score-70" onclick='toggleDiv(this)'>+<span class="">0705</span>:         <span class="n">b_pts</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">*</span> <span class="o">.</span><span class="mf">75</span> <span class="o">+</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">*</span> <span class="o">.</span><span class="mf">25</span></pre>
<pre class='cython code score-70 '>  __pyx_slice__210 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__210)) __PYX_ERR(0, 705, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__210);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__210);
  __pyx_slice__211 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__211)) __PYX_ERR(0, 705, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__211);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__211);
  __pyx_slice__212 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__212)) __PYX_ERR(0, 705, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__212);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__212);
/* … */
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__213); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 705, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_float__75); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 705, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_tuple__213 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__210, __pyx_slice__211, __pyx_slice__212); if (unlikely(!__pyx_tuple__213)) __PYX_ERR(0, 705, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__213);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__213);
  __pyx_slice__214 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__214)) __PYX_ERR(0, 705, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__214);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__214);
  __pyx_slice__215 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__215)) __PYX_ERR(0, 705, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__215);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__215);
  __pyx_slice__216 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__216)) __PYX_ERR(0, 705, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__216);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__216);
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__217); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 705, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_float__25); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 705, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_11, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 705, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_b_pts, __pyx_t_12);
    __pyx_t_12 = 0;
  __pyx_tuple__217 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__214, __pyx_slice__215, __pyx_slice__216); if (unlikely(!__pyx_tuple__217)) __PYX_ERR(0, 705, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__217);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__217);
</pre><pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">0706</span>:         <span class="n">mid_b</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_pts</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">b_pts</span><span class="p">[:,</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:])</span> <span class="o">/</span> <span class="mf">2</span></pre>
<pre class='cython code score-61 '>  __pyx_slice__218 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__218)) __PYX_ERR(0, 706, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__218);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__218);
  __pyx_slice__219 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__219)) __PYX_ERR(0, 706, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__219);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__219);
  __pyx_slice__220 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__220)) __PYX_ERR(0, 706, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__220);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__220);
/* … */
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_b_pts, __pyx_tuple__221); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 706, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_tuple__221 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__218, __pyx_slice__219, __pyx_slice__220); if (unlikely(!__pyx_tuple__221)) __PYX_ERR(0, 706, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__221);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__221);
  __pyx_slice__222 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__222)) __PYX_ERR(0, 706, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__222);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__222);
  __pyx_slice__223 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__223)) __PYX_ERR(0, 706, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__223);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__223);
  __pyx_slice__224 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__224)) __PYX_ERR(0, 706, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__224);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__224);
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_b_pts, __pyx_tuple__225); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 706, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_12, __pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 706, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_TrueDivideObjC</span>(__pyx_t_11, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 706, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_mid_b, __pyx_t_9);
    __pyx_t_9 = 0;
  __pyx_tuple__225 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__222, __pyx_slice__223, __pyx_slice__224); if (unlikely(!__pyx_tuple__225)) __PYX_ERR(0, 706, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__225);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__225);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0707</span>:         <span class="n">c_pts</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">mesh</span><span class="p">[:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:</span> <span class="p">]</span> <span class="o">+</span> \</pre>
<pre class='cython code score-44 '>    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>((0.5 * 0.25)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 707, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
/* … */
  __pyx_slice__226 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__226)) __PYX_ERR(0, 707, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__226);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__226);
  __pyx_slice__227 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__227)) __PYX_ERR(0, 707, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__227);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__227);
  __pyx_slice__228 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__228)) __PYX_ERR(0, 707, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__228);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__228);
    __pyx_t_11 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__229); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 707, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 707, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_tuple__229 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__226, __pyx_slice__227, __pyx_slice__228); if (unlikely(!__pyx_tuple__229)) __PYX_ERR(0, 707, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__229);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__229);
/* … */
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_12, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 707, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0708</span>:                 <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">:</span> <span class="p">,</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:</span> <span class="p">]</span> <span class="o">+</span> \</pre>
<pre class='cython code score-44 '>    __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((0.5 * 0.75)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 708, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
/* … */
  __pyx_slice__230 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__230)) __PYX_ERR(0, 708, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__230);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__230);
  __pyx_slice__231 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__231)) __PYX_ERR(0, 708, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__231);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__231);
  __pyx_slice__232 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__232)) __PYX_ERR(0, 708, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__232);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__232);
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__233); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 708, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_10 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_11, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 708, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_tuple__233 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__230, __pyx_slice__231, __pyx_slice__232); if (unlikely(!__pyx_tuple__233)) __PYX_ERR(0, 708, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__233);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__233);
/* … */
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 708, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-45" onclick='toggleDiv(this)'>+<span class="">0709</span>:                 <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">mesh</span><span class="p">[:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span>  <span class="mf">1</span><span class="p">:</span> <span class="p">,</span> <span class="p">:</span> <span class="p">]</span> <span class="o">+</span> \</pre>
<pre class='cython code score-45 '>    __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>((0.5 * 0.25)); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 709, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
/* … */
  __pyx_slice__234 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__234)) __PYX_ERR(0, 709, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__234);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__234);
  __pyx_slice__235 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__235)) __PYX_ERR(0, 709, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__235);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__235);
  __pyx_slice__236 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__236)) __PYX_ERR(0, 709, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__236);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__236);
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__237); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 709, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_10, __pyx_t_12); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 709, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_tuple__237 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__234, __pyx_slice__235, __pyx_slice__236); if (unlikely(!__pyx_tuple__237)) __PYX_ERR(0, 709, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__237);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__237);
/* … */
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_12, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 709, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_c_pts, __pyx_t_9);
    __pyx_t_9 = 0;
</pre><pre class="cython line score-37" onclick='toggleDiv(this)'>+<span class="">0710</span>:                 <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">:,</span>  <span class="mf">1</span><span class="p">:,</span> <span class="p">:]</span></pre>
<pre class='cython code score-37 '>    __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((0.5 * 0.75)); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 710, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
/* … */
  __pyx_slice__238 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__238)) __PYX_ERR(0, 710, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__238);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__238);
  __pyx_slice__239 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__239)) __PYX_ERR(0, 710, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__239);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__239);
  __pyx_slice__240 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__240)) __PYX_ERR(0, 710, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__240);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__240);
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__241); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 710, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_10 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_11, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 710, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_tuple__241 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__238, __pyx_slice__239, __pyx_slice__240); if (unlikely(!__pyx_tuple__241)) __PYX_ERR(0, 710, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__241);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__241);
</pre><pre class="cython line score-77" onclick='toggleDiv(this)'>+<span class="">0711</span>:         <span class="n">widths</span> <span class="o">=</span> <span class="n">get_lengths</span><span class="p">(</span><span class="n">b_pts</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">:,</span> <span class="p">:],</span> <span class="n">b_pts</span><span class="p">[:,</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:],</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-77 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_get_lengths); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 711, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
/* … */
  __pyx_slice__242 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__242)) __PYX_ERR(0, 711, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__242);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__242);
  __pyx_slice__243 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__243)) __PYX_ERR(0, 711, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__243);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__243);
  __pyx_slice__244 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__244)) __PYX_ERR(0, 711, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__244);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__244);
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_b_pts, __pyx_tuple__245); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 711, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_tuple__245 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__242, __pyx_slice__243, __pyx_slice__244); if (unlikely(!__pyx_tuple__245)) __PYX_ERR(0, 711, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__245);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__245);
  __pyx_slice__246 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__246)) __PYX_ERR(0, 711, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__246);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__246);
  __pyx_slice__247 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__247)) __PYX_ERR(0, 711, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__247);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__247);
  __pyx_slice__248 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__248)) __PYX_ERR(0, 711, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__248);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__248);
    __pyx_t_11 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_b_pts, __pyx_tuple__249); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 711, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_8 = NULL;
    __pyx_t_15 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        __pyx_t_15 = 1;
      }
    }
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 711, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (__pyx_t_8) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+__pyx_t_15, __pyx_t_12);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1+__pyx_t_15, __pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2+__pyx_t_15, __pyx_int_2);
    __pyx_t_12 = 0;
    __pyx_t_11 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_1, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 711, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_widths, __pyx_t_9);
    __pyx_t_9 = 0;
  __pyx_tuple__249 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__246, __pyx_slice__247, __pyx_slice__248); if (unlikely(!__pyx_tuple__249)) __PYX_ERR(0, 711, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__249);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__249);
</pre><pre class="cython line score-18" onclick='toggleDiv(this)'>+<span class="">0712</span>:         <span class="n">normals</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span></pre>
<pre class='cython code score-18 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 712, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_cross); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 712, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 712, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_12);
    __pyx_t_11 = 0;
    __pyx_t_12 = 0;
/* … */
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_9, __pyx_t_12); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 712, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_normals, __pyx_t_11);
    __pyx_t_11 = 0;
</pre><pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0713</span>:             <span class="n">mesh</span><span class="p">[:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span>  <span class="mf">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">:,</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-57 '>  __pyx_slice__250 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__250)) __PYX_ERR(0, 713, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__250);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__250);
  __pyx_slice__251 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__251)) __PYX_ERR(0, 713, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__251);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__251);
  __pyx_slice__252 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__252)) __PYX_ERR(0, 713, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__252);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__252);
/* … */
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__253); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 713, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_tuple__253 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__250, __pyx_slice__251, __pyx_slice__252); if (unlikely(!__pyx_tuple__253)) __PYX_ERR(0, 713, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__253);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__253);
  __pyx_slice__254 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__254)) __PYX_ERR(0, 713, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__254);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__254);
  __pyx_slice__255 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__255)) __PYX_ERR(0, 713, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__255);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__255);
  __pyx_slice__256 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__256)) __PYX_ERR(0, 713, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__256);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__256);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__257); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 713, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_9, __pyx_t_1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 713, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_tuple__257 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__254, __pyx_slice__255, __pyx_slice__256); if (unlikely(!__pyx_tuple__257)) __PYX_ERR(0, 713, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__257);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__257);
</pre><pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0714</span>:             <span class="n">mesh</span><span class="p">[:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">:,</span>  <span class="mf">1</span><span class="p">:,</span> <span class="p">:],</span></pre>
<pre class='cython code score-57 '>  __pyx_slice__258 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__258)) __PYX_ERR(0, 714, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__258);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__258);
  __pyx_slice__259 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__259)) __PYX_ERR(0, 714, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__259);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__259);
  __pyx_slice__260 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__260)) __PYX_ERR(0, 714, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__260);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__260);
/* … */
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__261); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_tuple__261 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__258, __pyx_slice__259, __pyx_slice__260); if (unlikely(!__pyx_tuple__261)) __PYX_ERR(0, 714, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__261);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__261);
  __pyx_slice__262 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__262)) __PYX_ERR(0, 714, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__262);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__262);
  __pyx_slice__263 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__263)) __PYX_ERR(0, 714, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__263);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__263);
  __pyx_slice__264 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__264)) __PYX_ERR(0, 714, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__264);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__264);
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__265); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 714, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_9); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 714, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_tuple__265 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__262, __pyx_slice__263, __pyx_slice__264); if (unlikely(!__pyx_tuple__265)) __PYX_ERR(0, 714, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__265);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__265);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0715</span>:             <span class="n">axis</span><span class="o">=</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_12 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 715, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_s_axis, __pyx_int_2) &lt; 0) __PYX_ERR(0, 715, __pyx_L1_error)
</pre><pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">0716</span>:         <span class="n">norms</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">normals</span><span class="o">**</span><span class="mf">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-61 '>    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 716, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 716, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 716, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_sum); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 716, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_normals, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 716, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 716, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_12);
    __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 716, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_s_axis, __pyx_int_2) &lt; 0) __PYX_ERR(0, 716, __pyx_L1_error)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_1, __pyx_t_12); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 716, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    if (!__pyx_t_12) {
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_8); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 716, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    } else {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 716, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_12); __pyx_t_12 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_8);
      __pyx_t_8 = 0;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_1, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 716, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_norms, __pyx_t_11);
    __pyx_t_11 = 0;
</pre><pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0717</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-57 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 717, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_tuple__266, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 717, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_9)) {
      __pyx_t_11 = __pyx_t_9; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_15 = 0;
      __pyx_t_16 = NULL;
    } else {
      __pyx_t_15 = -1; __pyx_t_11 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 717, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_16 = Py_TYPE(__pyx_t_11)-&gt;tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 717, __pyx_L1_error)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    for (;;) {
      if (likely(!__pyx_t_16)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11))) {
          if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_11)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_11, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_15++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 717, __pyx_L1_error)
          #else
          __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_11, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 717, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          #endif
        } else {
          if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_11)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_11, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_15++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 717, __pyx_L1_error)
          #else
          __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_11, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 717, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          #endif
        }
      } else {
        __pyx_t_9 = __pyx_t_16(__pyx_t_11);
        if (unlikely(!__pyx_t_9)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else __PYX_ERR(0, 717, __pyx_L1_error)
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j, __pyx_t_9);
      __pyx_t_9 = 0;
/* … */
  __pyx_tuple__266 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3); if (unlikely(!__pyx_tuple__266)) __PYX_ERR(0, 717, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__266);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__266);
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-36" onclick='toggleDiv(this)'>+<span class="">0718</span>:             <span class="n">normals</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norms</span></pre>
<pre class='cython code score-36 '>  __pyx_slice__267 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__267)) __PYX_ERR(0, 718, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__267);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__267);
/* … */
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 718, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__267);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__267);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_slice__267);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__268);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__268);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_slice__268);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_j);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_v_j);
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_normals, __pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 718, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyNumber_InPlaceDivide</span>(__pyx_t_1, __pyx_v_norms); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 718, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_normals, __pyx_t_9, __pyx_t_8) &lt; 0)) __PYX_ERR(0, 718, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_slice__268 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__268)) __PYX_ERR(0, 718, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__268);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__268);
</pre><pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">0719</span>:         <span class="n">B_PTS</span><span class="p">[</span><span class="n">i_bpts</span><span class="p">:</span> <span class="n">i_bpts</span> <span class="o">+</span> <span class="n">n_bpts</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">b_pts</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">b_pts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-61 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_b_pts, __pyx_n_s_reshape); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 719, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_b_pts, __pyx_n_s_shape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 719, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_8, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = NULL;
    __pyx_t_15 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_15 = 1;
      }
    }
    __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_15); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 719, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    if (__pyx_t_8) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+__pyx_t_15, __pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1+__pyx_t_15, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 719, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_bpts, __pyx_v_n_bpts); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 719, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_12 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i_bpts, __pyx_t_9, Py_None); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 719, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 719, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__269);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__269);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_slice__269);
    __pyx_t_12 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_B_PTS, __pyx_t_9, __pyx_t_11) &lt; 0)) __PYX_ERR(0, 719, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
  __pyx_slice__269 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__269)) __PYX_ERR(0, 719, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__269);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__269);
</pre><pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">0720</span>:         <span class="n">MID_B</span><span class="p">[</span><span class="n">i_panels</span><span class="p">:</span> <span class="n">i_panels</span> <span class="o">+</span> <span class="n">n_panels</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">mid_b</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">mid_b</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-61 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mid_b, __pyx_n_s_reshape); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 720, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mid_b, __pyx_n_s_shape); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 720, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_12, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    __pyx_t_15 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_15 = 1;
      }
    }
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_15); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 720, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_12) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_12); __pyx_t_12 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_15, __pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_15, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_8, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 720, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_panels, __pyx_v_n_panels); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 720, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i_panels, __pyx_t_9, Py_None); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 720, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 720, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__270);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__270);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_slice__270);
    __pyx_t_8 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_MID_B, __pyx_t_9, __pyx_t_11) &lt; 0)) __PYX_ERR(0, 720, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
  __pyx_slice__270 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__270)) __PYX_ERR(0, 720, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__270);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__270);
</pre><pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">0721</span>:         <span class="n">C_PTS</span><span class="p">[</span><span class="n">i_panels</span><span class="p">:</span> <span class="n">i_panels</span> <span class="o">+</span> <span class="n">n_panels</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">c_pts</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">c_pts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-61 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_c_pts, __pyx_n_s_reshape); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 721, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_c_pts, __pyx_n_s_shape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 721, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_8, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 721, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = NULL;
    __pyx_t_15 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_15 = 1;
      }
    }
    __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_15); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 721, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    if (__pyx_t_8) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+__pyx_t_15, __pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1+__pyx_t_15, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 721, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_panels, __pyx_v_n_panels); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 721, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_12 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i_panels, __pyx_t_9, Py_None); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 721, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 721, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__271);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__271);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_slice__271);
    __pyx_t_12 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_C_PTS, __pyx_t_9, __pyx_t_11) &lt; 0)) __PYX_ERR(0, 721, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
  __pyx_slice__271 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__271)) __PYX_ERR(0, 721, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__271);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__271);
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0722</span>:         <span class="n">WIDTHS</span><span class="p">[</span><span class="n">i_panels</span><span class="p">:</span> <span class="n">i_panels</span> <span class="o">+</span> <span class="n">n_panels</span><span class="p">]</span> <span class="o">=</span> <span class="n">widths</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
<pre class='cython code score-27 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_widths, __pyx_n_s_flatten); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 722, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_12 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    if (__pyx_t_12) {
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_12); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 722, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    } else {
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 722, __pyx_L1_error)
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_panels, __pyx_v_n_panels); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 722, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_WIDTHS, __pyx_t_11, 0, 0, &amp;__pyx_v_i_panels, &amp;__pyx_t_9, NULL, 0, 0, 1) &lt; 0) __PYX_ERR(0, 722, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">0723</span>:         <span class="n">NORMALS</span><span class="p">[</span><span class="n">i_panels</span><span class="p">:</span> <span class="n">i_panels</span> <span class="o">+</span> <span class="n">n_panels</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">normals</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">normals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;F&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-61 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_normals, __pyx_n_s_reshape); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 723, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_normals, __pyx_n_s_shape); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 723, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_9, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 723, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 723, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_12);
    __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 723, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_s_order, __pyx_n_s_F) &lt; 0) __PYX_ERR(0, 723, __pyx_L1_error)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_9, __pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 723, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_panels, __pyx_v_n_panels); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 723, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_9 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i_panels, __pyx_t_12, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 723, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 723, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__272);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__272);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_slice__272);
    __pyx_t_9 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_NORMALS, __pyx_t_12, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 723, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__272 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__272)) __PYX_ERR(0, 723, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__272);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__272);
</pre><pre class="cython line score-41" onclick='toggleDiv(this)'>+<span class="">0724</span>:         <span class="n">S_REF</span><span class="p">[</span><span class="n">i_surf</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">norms</span><span class="p">)</span></pre>
<pre class='cython code score-41 '>    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 724, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_sum); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 724, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    if (!__pyx_t_12) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_norms); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 724, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 724, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_norms);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_norms);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, __pyx_v_norms);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 724, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 724, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_S_REF, __pyx_v_i_surf, __pyx_t_9) &lt; 0)) __PYX_ERR(0, 724, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-18" onclick='toggleDiv(this)'>+<span class="">0725</span>:     <span class="k">return</span> <span class="n">B_PTS</span><span class="p">,</span> <span class="n">MID_B</span><span class="p">,</span> <span class="n">C_PTS</span><span class="p">,</span> <span class="n">WIDTHS</span><span class="p">,</span> <span class="n">NORMALS</span><span class="p">,</span> <span class="n">S_REF</span></pre>
<pre class='cython code score-18 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_B_PTS);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_B_PTS);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_B_PTS);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_MID_B);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_MID_B);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_MID_B);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_C_PTS);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_C_PTS);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_v_C_PTS);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_WIDTHS);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_WIDTHS);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3, __pyx_v_WIDTHS);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_NORMALS);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_NORMALS);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 4, __pyx_v_NORMALS);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_REF);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_REF);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 5, __pyx_v_S_REF);
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0726</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0727</span>: </pre>
<pre class="cython line score-163" onclick='toggleDiv(this)'>+<span class="">0728</span>: <span class="k">def</span> <span class="nf">assemble_AIC_mtx</span><span class="p">(</span><span class="n">mtx</span><span class="p">,</span> <span class="n">flat_mesh</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">b_pts</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span></pre>
<pre class='cython code score-163 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_39assemble_AIC_mtx(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_38assemble_AIC_mtx[] = "\n    Compute the aerodynamic influence coefficient matrix\n    for either solving the linear system or solving for the drag.\n\n    Parameters\n    ----------\n    mtx[num_y-1, num_y-1, 3] : array_like\n        Aerodynamic influence coefficient (AIC) matrix, or the\n        derivative of v w.r.t. circulations.\n    flat_mesh[num_x*num_y, 3] : array_like\n        Flat array containing nodal coordinates.\n    aero_ind[num_surf, 7] : array_like\n        Array containing index information for the lifting surfaces.\n        See geometry.py/get_inds for more details.\n    fem_ind[num_surf, 3] : array_like\n        Array containing index information for the lifting surfaces.\n        See geometry.py/get_inds for more details.\n    points[num_y-1, 3] : array_like\n        Collocation points used to find influence coefficient strength.\n        Found at 3/4 chord for the linear system and at the midpoint of\n        the bound vortices (1/4 chord) for the drag computation.\n    b_pts[num_x-1, num_y, 3] : array_like\n        Bound vortex coordinates from the 1/4 chord line.\n    alpha : float\n        Angle of attack.\n    skip : boolean\n        If false, the bound vortex contributions on the collocation point\n        corresponding to the same panel are not included. Used for the drag\n        computation.\n\n    Returns\n    -------\n    mtx[num_y-1, num_y-1, 3] : array_like\n        Aerodynamic influence coefficient (AIC) matrix, or the\n        derivative of v w.r.t. circulations.\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_39assemble_AIC_mtx = {"assemble_AIC_mtx", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_39assemble_AIC_mtx, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_38assemble_AIC_mtx};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_39assemble_AIC_mtx(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mtx = 0;
  PyObject *__pyx_v_flat_mesh = 0;
  PyObject *__pyx_v_aero_ind = 0;
  PyObject *__pyx_v_points = 0;
  PyObject *__pyx_v_b_pts = 0;
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_v_skip = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assemble_AIC_mtx (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mtx,&amp;__pyx_n_s_flat_mesh,&amp;__pyx_n_s_aero_ind,&amp;__pyx_n_s_points,&amp;__pyx_n_s_b_pts,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_skip,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    values[6] = ((PyObject *)((PyObject *)Py_False));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mtx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_flat_mesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_mtx", 0, 6, 7, 1); __PYX_ERR(0, 728, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aero_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_mtx", 0, 6, 7, 2); __PYX_ERR(0, 728, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_mtx", 0, 6, 7, 3); __PYX_ERR(0, 728, __pyx_L3_error)
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_b_pts)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_mtx", 0, 6, 7, 4); __PYX_ERR(0, 728, __pyx_L3_error)
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_mtx", 0, 6, 7, 5); __PYX_ERR(0, 728, __pyx_L3_error)
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_skip);
          if (value) { values[6] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "assemble_AIC_mtx") &lt; 0)) __PYX_ERR(0, 728, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_mtx = values[0];
    __pyx_v_flat_mesh = values[1];
    __pyx_v_aero_ind = values[2];
    __pyx_v_points = values[3];
    __pyx_v_b_pts = values[4];
    __pyx_v_alpha = values[5];
    __pyx_v_skip = values[6];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_mtx", 0, 6, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 728, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.assemble_AIC_mtx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_38assemble_AIC_mtx(__pyx_self, __pyx_v_mtx, __pyx_v_flat_mesh, __pyx_v_aero_ind, __pyx_v_points, __pyx_v_b_pts, __pyx_v_alpha, __pyx_v_skip);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_38assemble_AIC_mtx(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mtx, PyObject *__pyx_v_flat_mesh, PyObject *__pyx_v_aero_ind, PyObject *__pyx_v_points, PyObject *__pyx_v_b_pts, PyObject *__pyx_v_alpha, PyObject *__pyx_v_skip) {
  PyObject *__pyx_v_cosa = NULL;
  PyObject *__pyx_v_sina = NULL;
  PyObject *__pyx_v_u = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i_surf = NULL;
  PyObject *__pyx_v_row = NULL;
  PyObject *__pyx_v_nx_ = NULL;
  PyObject *__pyx_v_ny_ = NULL;
  PyObject *__pyx_v_n_ = NULL;
  PyObject *__pyx_v_n_bpts_ = NULL;
  PyObject *__pyx_v_n_panels_ = NULL;
  PyObject *__pyx_v_i_ = NULL;
  PyObject *__pyx_v_i_bpts_ = NULL;
  PyObject *__pyx_v_i_panels_ = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_n = NULL;
  PyObject *__pyx_v_mesh = NULL;
  PyObject *__pyx_v_bpts = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i_points = NULL;
  PyObject *__pyx_v_nx = NULL;
  PyObject *__pyx_v_ny = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_n_bpts = NULL;
  PyObject *__pyx_v_n_panels = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i_bpts = NULL;
  PyObject *__pyx_v_i_panels = NULL;
  PyObject *__pyx_v_pts = NULL;
  PyObject *__pyx_v_small_mat = NULL;
  PyObject *__pyx_v_el_j = NULL;
  PyObject *__pyx_v_el_loc_j = NULL;
  PyObject *__pyx_v_C_te = NULL;
  PyObject *__pyx_v_D_te = NULL;
  PyObject *__pyx_v_cp_j = NULL;
  PyObject *__pyx_v_cp_loc_j = NULL;
  PyObject *__pyx_v_cp_i = NULL;
  PyObject *__pyx_v_cp_loc = NULL;
  PyObject *__pyx_v_P = NULL;
  PyObject *__pyx_v_r1 = NULL;
  PyObject *__pyx_v_r2 = NULL;
  PyObject *__pyx_v_r1_mag = NULL;
  PyObject *__pyx_v_r2_mag = NULL;
  PyObject *__pyx_v_t1 = NULL;
  PyObject *__pyx_v_t3 = NULL;
  PyObject *__pyx_v_trailing = NULL;
  PyObject *__pyx_v_edges = NULL;
  PyObject *__pyx_v_el_i = NULL;
  PyObject *__pyx_v_el_loc = NULL;
  PyObject *__pyx_v_A = NULL;
  PyObject *__pyx_v_B = NULL;
  PyObject *__pyx_v_C = NULL;
  PyObject *__pyx_v_D = NULL;
  PyObject *__pyx_v_bound = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assemble_AIC_mtx", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mtx);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.assemble_AIC_mtx", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cosa);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sina);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_bpts_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_panels_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_bpts_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_panels_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_points);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_small_mat);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_el_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_el_loc_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_C_te);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_D_te);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cp_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cp_loc_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cp_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cp_loc);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_P);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r1_mag);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r2_mag);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_trailing);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_edges);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_el_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_el_loc);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_A);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_B);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_C);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_D);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bound);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtx);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__582 = <span class='py_c_api'>PyTuple_Pack</span>(57, __pyx_n_s_mtx, __pyx_n_s_flat_mesh, __pyx_n_s_aero_ind, __pyx_n_s_points, __pyx_n_s_b_pts, __pyx_n_s_alpha, __pyx_n_s_skip, __pyx_n_s_cosa, __pyx_n_s_sina, __pyx_n_s_u, __pyx_n_s_i_surf, __pyx_n_s_row, __pyx_n_s_nx_2, __pyx_n_s_ny_2, __pyx_n_s_n_2, __pyx_n_s_n_bpts_2, __pyx_n_s_n_panels_2, __pyx_n_s_i_2, __pyx_n_s_i_bpts_2, __pyx_n_s_i_panels_2, __pyx_n_s_n, __pyx_n_s_mesh, __pyx_n_s_bpts, __pyx_n_s_i_points, __pyx_n_s_nx, __pyx_n_s_ny, __pyx_n_s_n_bpts, __pyx_n_s_n_panels, __pyx_n_s_i, __pyx_n_s_i_bpts, __pyx_n_s_i_panels, __pyx_n_s_pts, __pyx_n_s_small_mat, __pyx_n_s_el_j, __pyx_n_s_el_loc_j, __pyx_n_s_C_te, __pyx_n_s_D_te, __pyx_n_s_cp_j, __pyx_n_s_cp_loc_j, __pyx_n_s_cp_i, __pyx_n_s_cp_loc, __pyx_n_s_P, __pyx_n_s_r1, __pyx_n_s_r2, __pyx_n_s_r1_mag, __pyx_n_s_r2_mag, __pyx_n_s_t1, __pyx_n_s_t3, __pyx_n_s_trailing, __pyx_n_s_edges, __pyx_n_s_el_i, __pyx_n_s_el_loc, __pyx_n_s_A, __pyx_n_s_B, __pyx_n_s_C, __pyx_n_s_D, __pyx_n_s_bound); if (unlikely(!__pyx_tuple__582)) __PYX_ERR(0, 728, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__582);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__582);
  __pyx_codeobj__583 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 57, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__582, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_assemble_AIC_mtx, 728, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__583)) __PYX_ERR(0, 728, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_39assemble_AIC_mtx, 0, __pyx_n_s_assemble_AIC_mtx, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__583)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 728, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__584);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_assemble_AIC_mtx, __pyx_t_2) &lt; 0) __PYX_ERR(0, 728, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__584 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)Py_False)); if (unlikely(!__pyx_tuple__584)) __PYX_ERR(0, 728, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__584);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__584);
</pre><pre class="cython line score-0">&#xA0;<span class="">0729</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0730</span>: <span class="sd">    Compute the aerodynamic influence coefficient matrix</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0731</span>: <span class="sd">    for either solving the linear system or solving for the drag.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0732</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0733</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0734</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0735</span>: <span class="sd">    mtx[num_y-1, num_y-1, 3] : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0736</span>: <span class="sd">        Aerodynamic influence coefficient (AIC) matrix, or the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0737</span>: <span class="sd">        derivative of v w.r.t. circulations.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0738</span>: <span class="sd">    flat_mesh[num_x*num_y, 3] : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0739</span>: <span class="sd">        Flat array containing nodal coordinates.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0740</span>: <span class="sd">    aero_ind[num_surf, 7] : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0741</span>: <span class="sd">        Array containing index information for the lifting surfaces.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0742</span>: <span class="sd">        See geometry.py/get_inds for more details.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0743</span>: <span class="sd">    fem_ind[num_surf, 3] : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0744</span>: <span class="sd">        Array containing index information for the lifting surfaces.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0745</span>: <span class="sd">        See geometry.py/get_inds for more details.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0746</span>: <span class="sd">    points[num_y-1, 3] : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0747</span>: <span class="sd">        Collocation points used to find influence coefficient strength.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0748</span>: <span class="sd">        Found at 3/4 chord for the linear system and at the midpoint of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0749</span>: <span class="sd">        the bound vortices (1/4 chord) for the drag computation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0750</span>: <span class="sd">    b_pts[num_x-1, num_y, 3] : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0751</span>: <span class="sd">        Bound vortex coordinates from the 1/4 chord line.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0752</span>: <span class="sd">    alpha : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0753</span>: <span class="sd">        Angle of attack.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0754</span>: <span class="sd">    skip : boolean</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0755</span>: <span class="sd">        If false, the bound vortex contributions on the collocation point</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0756</span>: <span class="sd">        corresponding to the same panel are not included. Used for the drag</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0757</span>: <span class="sd">        computation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0758</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0759</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0760</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0761</span>: <span class="sd">    mtx[num_y-1, num_y-1, 3] : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0762</span>: <span class="sd">        Aerodynamic influence coefficient (AIC) matrix, or the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0763</span>: <span class="sd">        derivative of v w.r.t. circulations.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0764</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">0765</span>:     <span class="n">mtx</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-25 '>  __pyx_slice__273 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__273)) __PYX_ERR(0, 765, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__273);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__273);
  __pyx_slice__274 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__274)) __PYX_ERR(0, 765, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__274);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__274);
  __pyx_slice__275 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__275)) __PYX_ERR(0, 765, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__275);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__275);
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mtx, __pyx_tuple__276, __pyx_float_0_0) &lt; 0)) __PYX_ERR(0, 765, __pyx_L1_error)
  __pyx_tuple__276 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__273, __pyx_slice__274, __pyx_slice__275); if (unlikely(!__pyx_tuple__276)) __PYX_ERR(0, 765, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__276);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__276);
</pre><pre class="cython line score-43" onclick='toggleDiv(this)'>+<span class="">0766</span>:     <span class="n">cosa</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 766, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cos); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 766, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 766, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_pi); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 766, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_alpha, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 766, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideObjC</span>(__pyx_t_2, __pyx_float_180_, 180., 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 766, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 766, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 766, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 766, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_cosa = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-43" onclick='toggleDiv(this)'>+<span class="">0767</span>:     <span class="n">sina</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 767, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 767, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 767, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_pi); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 767, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_alpha, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 767, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideObjC</span>(__pyx_t_3, __pyx_float_180_, 180., 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 767, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 767, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 767, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 767, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_sina = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">0768</span>:     <span class="n">u</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cosa</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">sina</span><span class="p">])</span></pre>
<pre class='cython code score-40 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 768, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 768, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cosa);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cosa);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_cosa);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sina);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sina);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, __pyx_v_sina);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 768, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 768, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 768, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_u = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0769</span>:     <span class="k">for</span> <span class="n">i_surf</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_1 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_aero_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_aero_ind)) {
    __pyx_t_2 = __pyx_v_aero_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_aero_ind); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 769, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 769, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 769, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 769, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 769, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 769, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_7(__pyx_t_2);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 769, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_surf, __pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 769, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
    __pyx_t_1 = __pyx_t_3;
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-90" onclick='toggleDiv(this)'>+<span class="">0770</span>:         <span class="n">nx_</span><span class="p">,</span> <span class="n">ny_</span><span class="p">,</span> <span class="n">n_</span><span class="p">,</span> <span class="n">n_bpts_</span><span class="p">,</span> <span class="n">n_panels_</span><span class="p">,</span> <span class="n">i_</span><span class="p">,</span> <span class="n">i_bpts_</span><span class="p">,</span> <span class="n">i_panels_</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-90 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_row, __pyx_n_s_copy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 770, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    if (__pyx_t_4) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 770, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 770, __pyx_L1_error)
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
      PyObject* sequence = __pyx_t_3;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 8)) {
        if (size &gt; 8) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(8);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 770, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
        __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 6); 
        __pyx_t_13 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 7); 
      } else {
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
        __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 6); 
        __pyx_t_13 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 7); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[8] = {&amp;__pyx_t_5,&amp;__pyx_t_4,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_13};
        for (i=0; i &lt; 8; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 770, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[8] = {&amp;__pyx_t_5,&amp;__pyx_t_4,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_13};
      __pyx_t_14 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 770, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_15 = Py_TYPE(__pyx_t_14)-&gt;tp_iternext;
      for (index=0; index &lt; 8; index++) {
        PyObject* item = __pyx_t_15(__pyx_t_14); if (unlikely(!item)) goto __pyx_L5_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_14), 8) &lt; 0) __PYX_ERR(0, 770, __pyx_L1_error)
      __pyx_t_15 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 770, __pyx_L1_error)
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_nx_, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ny_, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_bpts_, __pyx_t_9);
    __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_panels_, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_, __pyx_t_11);
    __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_bpts_, __pyx_t_12);
    __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_panels_, __pyx_t_13);
    __pyx_t_13 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0771</span>:         <span class="n">n</span> <span class="o">=</span> <span class="n">nx_</span> <span class="o">*</span> <span class="n">ny_</span></pre>
<pre class='cython code score-6 '>    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx_, __pyx_v_ny_); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 771, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-60" onclick='toggleDiv(this)'>+<span class="">0772</span>:         <span class="n">mesh</span> <span class="o">=</span> <span class="n">flat_mesh</span><span class="p">[</span><span class="n">i_</span><span class="p">:</span> <span class="n">i_</span> <span class="o">+</span> <span class="n">n_</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nx_</span><span class="p">,</span> <span class="n">ny_</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-60 '>    __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_, __pyx_v_n_); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 772, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_12 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i_, __pyx_t_13, Py_None); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 772, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 772, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__277);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__277);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1, __pyx_slice__277);
    __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_flat_mesh, __pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 772, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_reshape); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 772, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    __pyx_t_16 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
        __pyx_t_16 = 1;
      }
    }
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_16); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 772, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (__pyx_t_12) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx_);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx_);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_16, __pyx_v_nx_);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny_);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny_);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_16, __pyx_v_ny_);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2+__pyx_t_16, __pyx_int_3);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_11, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 772, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_mesh, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  __pyx_slice__277 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__277)) __PYX_ERR(0, 772, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__277);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__277);
</pre><pre class="cython line score-39" onclick='toggleDiv(this)'>+<span class="">0773</span>:         <span class="n">bpts</span> <span class="o">=</span> <span class="n">b_pts</span><span class="p">[</span><span class="n">i_bpts_</span><span class="p">:</span> <span class="n">i_bpts_</span> <span class="o">+</span> <span class="n">n_bpts_</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nx_</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="n">ny_</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>    __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_bpts_, __pyx_v_n_bpts_); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 773, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_b_pts, 0, 0, &amp;__pyx_v_i_bpts_, &amp;__pyx_t_13, NULL, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 773, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_reshape); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 773, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nx_, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 773, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_12 = NULL;
    __pyx_t_16 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
        __pyx_t_16 = 1;
      }
    }
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_16); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 773, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (__pyx_t_12) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_12); __pyx_t_12 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_16, __pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny_);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny_);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_16, __pyx_v_ny_);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2+__pyx_t_16, __pyx_int_3);
    __pyx_t_11 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 773, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_bpts, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0774</span>:         <span class="k">for</span> <span class="n">i_points</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_t_3 = __pyx_int_0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_aero_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_aero_ind)) {
      __pyx_t_13 = __pyx_v_aero_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13); __pyx_t_16 = 0;
      __pyx_t_17 = NULL;
    } else {
      __pyx_t_16 = -1; __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_aero_ind); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 774, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_17 = Py_TYPE(__pyx_t_13)-&gt;tp_iternext; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 774, __pyx_L1_error)
    }
    for (;;) {
      if (likely(!__pyx_t_17)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_13))) {
          if (__pyx_t_16 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_13)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_13, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10); __pyx_t_16++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 774, __pyx_L1_error)
          #else
          __pyx_t_10 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_13, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 774, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
          #endif
        } else {
          if (__pyx_t_16 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_13)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_13, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10); __pyx_t_16++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 774, __pyx_L1_error)
          #else
          __pyx_t_10 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_13, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 774, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
          #endif
        }
      } else {
        __pyx_t_10 = __pyx_t_17(__pyx_t_13);
        if (unlikely(!__pyx_t_10)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else __PYX_ERR(0, 774, __pyx_L1_error)
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_row, __pyx_t_10);
      __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_points, __pyx_t_3);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 774, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3);
      __pyx_t_3 = __pyx_t_10;
      __pyx_t_10 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-70" onclick='toggleDiv(this)'>+<span class="">0775</span>:             <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_bpts</span><span class="p">,</span> <span class="n">n_panels</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_bpts</span><span class="p">,</span> <span class="n">i_panels</span> <span class="o">=</span> <span class="n">row</span></pre>
<pre class='cython code score-70 '>      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_row))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_row))) {
        PyObject* sequence = __pyx_v_row;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 8)) {
          if (size &gt; 8) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(8);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          __PYX_ERR(0, 775, __pyx_L1_error)
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
          __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
          __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
          __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
          __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 6); 
          __pyx_t_14 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 7); 
        } else {
          __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
          __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
          __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
          __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
          __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 6); 
          __pyx_t_14 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 7); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
        #else
        {
          Py_ssize_t i;
          PyObject** temps[8] = {&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_9,&amp;__pyx_t_8,&amp;__pyx_t_4,&amp;__pyx_t_5,&amp;__pyx_t_14};
          for (i=0; i &lt; 8; i++) {
            PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 775, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(item);
            *(temps[i]) = item;
          }
        }
        #endif
      } else {
        Py_ssize_t index = -1;
        PyObject** temps[8] = {&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_9,&amp;__pyx_t_8,&amp;__pyx_t_4,&amp;__pyx_t_5,&amp;__pyx_t_14};
        __pyx_t_18 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_row); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 775, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        __pyx_t_15 = Py_TYPE(__pyx_t_18)-&gt;tp_iternext;
        for (index=0; index &lt; 8; index++) {
          PyObject* item = __pyx_t_15(__pyx_t_18); if (unlikely(!item)) goto __pyx_L9_unpacking_failed;
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[index]) = item;
        }
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_18), 8) &lt; 0) __PYX_ERR(0, 775, __pyx_L1_error)
        __pyx_t_15 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        goto __pyx_L10_unpacking_done;
        __pyx_L9_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_15 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        __PYX_ERR(0, 775, __pyx_L1_error)
        __pyx_L10_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_nx, __pyx_t_10);
      __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ny, __pyx_t_11);
      __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_n, __pyx_t_12);
      __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_bpts, __pyx_t_9);
      __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_panels, __pyx_t_8);
      __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_4);
      __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_bpts, __pyx_t_5);
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_panels, __pyx_t_14);
      __pyx_t_14 = 0;
</pre><pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">0776</span>:             <span class="n">pts</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i_panels</span><span class="p">:</span> <span class="n">i_panels</span> <span class="o">+</span></pre>
<pre class='cython code score-8 '>      __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_panels, __pyx_v_n_panels); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 776, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_points, 0, 0, &amp;__pyx_v_i_panels, &amp;__pyx_t_5, NULL, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 776, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0777</span>:                          <span class="n">n_panels</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="n">ny</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_reshape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 777, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nx, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 777, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_ny, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 777, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = NULL;
      __pyx_t_19 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_19 = 1;
        }
      }
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_19); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 777, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      if (__pyx_t_9) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_9); __pyx_t_9 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+__pyx_t_19, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1+__pyx_t_19, __pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2+__pyx_t_19, __pyx_int_3);
      __pyx_t_4 = 0;
      __pyx_t_8 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_12, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 777, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_pts, __pyx_t_14);
      __pyx_t_14 = 0;
</pre><pre class="cython line score-52" onclick='toggleDiv(this)'>+<span class="">0778</span>:             <span class="n">small_mat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_panels</span><span class="p">,</span> <span class="n">n_panels_</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&quot;complex&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-52 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 778, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 778, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 778, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n_panels);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n_panels);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_n_panels);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n_panels_);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n_panels_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_n_panels_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_3);
      __pyx_t_8 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
        }
      }
      if (!__pyx_t_8) {
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, __pyx_t_5); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 778, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      } else {
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 778, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_8); __pyx_t_8 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_4, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 778, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_astype); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 778, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_tuple__278, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 778, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_small_mat, __pyx_t_14);
      __pyx_t_14 = 0;
/* … */
  __pyx_tuple__278 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_complex); if (unlikely(!__pyx_tuple__278)) __PYX_ERR(0, 778, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__278);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__278);
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0779</span>:             <span class="k">if</span> <span class="n">fortran_flag</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fortran_flag); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 779, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_14); if (unlikely(__pyx_t_20 &lt; 0)) __PYX_ERR(0, 779, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      if (__pyx_t_20) {
/* … */
        goto __pyx_L11;
      }
</pre><pre class="cython line score-31" onclick='toggleDiv(this)'>+<span class="">0780</span>:                 <span class="n">small_mat</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">assembleaeromtx</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny_</span><span class="p">,</span> <span class="n">nx_</span><span class="p">,</span></pre>
<pre class='cython code score-31 '>        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_lib); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 780, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_assembleaeromtx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 780, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
/* … */
  __pyx_slice__279 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__279)) __PYX_ERR(0, 780, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__279);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__279);
  __pyx_slice__280 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__280)) __PYX_ERR(0, 780, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__280);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__280);
  __pyx_slice__281 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__281)) __PYX_ERR(0, 780, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__281);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__281);
/* … */
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_small_mat, __pyx_tuple__282, __pyx_t_14) &lt; 0)) __PYX_ERR(0, 780, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_tuple__282 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__279, __pyx_slice__280, __pyx_slice__281); if (unlikely(!__pyx_tuple__282)) __PYX_ERR(0, 780, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__282);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__282);
</pre><pre class="cython line score-0">&#xA0;<span class="">0781</span>:                                                          <span class="n">alpha</span><span class="p">,</span> <span class="n">pts</span><span class="p">,</span> <span class="n">bpts</span><span class="p">,</span></pre>
<pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0782</span>:                                                          <span class="n">mesh</span><span class="p">,</span> <span class="n">skip</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>        __pyx_t_12 = NULL;
        __pyx_t_19 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_12)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
            __pyx_t_19 = 1;
          }
        }
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(9+__pyx_t_19); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 780, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        if (__pyx_t_12) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_12); __pyx_t_12 = NULL;
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_19, __pyx_v_ny);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_19, __pyx_v_nx);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny_);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny_);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_19, __pyx_v_ny_);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx_);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx_);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 3+__pyx_t_19, __pyx_v_nx_);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alpha);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_alpha);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 4+__pyx_t_19, __pyx_v_alpha);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pts);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_pts);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 5+__pyx_t_19, __pyx_v_pts);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_bpts);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_bpts);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 6+__pyx_t_19, __pyx_v_bpts);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mesh);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 7+__pyx_t_19, __pyx_v_mesh);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_skip);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_skip);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 8+__pyx_t_19, __pyx_v_skip);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 780, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0783</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0784</span>:                 <span class="c"># Spanwise loop through horseshoe elements</span></pre>
<pre class="cython line score-75" onclick='toggleDiv(this)'>+<span class="">0785</span>:                 <span class="k">for</span> <span class="n">el_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ny_</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-75 '>      /*else*/ {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 785, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_ny_, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 785, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_12 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_12)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          }
        }
        if (!__pyx_t_12) {
          __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 785, __pyx_L1_error)
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        } else {
          __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 785, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_12); __pyx_t_12 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, __pyx_t_5);
          __pyx_t_5 = 0;
          __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_8, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 785, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_14)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_14)) {
          __pyx_t_4 = __pyx_t_14; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_19 = 0;
          __pyx_t_21 = NULL;
        } else {
          __pyx_t_19 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 785, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          __pyx_t_21 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext; if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 785, __pyx_L1_error)
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        for (;;) {
          if (likely(!__pyx_t_21)) {
            if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
              if (__pyx_t_19 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_14 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_19); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14); __pyx_t_19++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 785, __pyx_L1_error)
              #else
              __pyx_t_14 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_19); __pyx_t_19++; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 785, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
              #endif
            } else {
              if (__pyx_t_19 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_14 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_19); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14); __pyx_t_19++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 785, __pyx_L1_error)
              #else
              __pyx_t_14 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_19); __pyx_t_19++; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 785, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
              #endif
            }
          } else {
            __pyx_t_14 = __pyx_t_21(__pyx_t_4);
            if (unlikely(!__pyx_t_14)) {
              PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                else __PYX_ERR(0, 785, __pyx_L1_error)
              }
              break;
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_el_j, __pyx_t_14);
          __pyx_t_14 = 0;
/* … */
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      __pyx_L11:;
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">0786</span>:                     <span class="n">el_loc_j</span> <span class="o">=</span> <span class="n">el_j</span> <span class="o">*</span> <span class="p">(</span><span class="n">nx_</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>          __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nx_, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 786, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_el_j, __pyx_t_14); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 786, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_el_loc_j, __pyx_t_8);
          __pyx_t_8 = 0;
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">0787</span>:                     <span class="n">C_te</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">el_j</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-24 '>          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_el_j, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 787, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 787, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_int_neg_1);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1, __pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__283);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__283);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 2, __pyx_slice__283);
          __pyx_t_8 = 0;
          __pyx_t_8 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_t_14); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 787, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_C_te, __pyx_t_8);
          __pyx_t_8 = 0;
/* … */
  __pyx_slice__283 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__283)) __PYX_ERR(0, 787, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__283);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__283);
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">0788</span>:                     <span class="n">D_te</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">el_j</span> <span class="o">+</span> <span class="mf">0</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-24 '>          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_el_j, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 788, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 788, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_int_neg_1);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1, __pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__284);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__284);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 2, __pyx_slice__284);
          __pyx_t_8 = 0;
          __pyx_t_8 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_t_14); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 788, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_D_te, __pyx_t_8);
          __pyx_t_8 = 0;
/* … */
  __pyx_slice__284 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__284)) __PYX_ERR(0, 788, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__284);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__284);
</pre><pre class="cython line score-0">&#xA0;<span class="">0789</span>:                     <span class="c"># Spanwise loop through control points</span></pre>
<pre class="cython line score-75" onclick='toggleDiv(this)'>+<span class="">0790</span>:                     <span class="k">for</span> <span class="n">cp_j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ny</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-75 '>          __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 790, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_ny, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 790, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          __pyx_t_12 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
            __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
            if (likely(__pyx_t_12)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, function);
            }
          }
          if (!__pyx_t_12) {
            __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_14, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 790, __pyx_L1_error)
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          } else {
            __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 790, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_12); __pyx_t_12 = NULL;
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_5);
            __pyx_t_5 = 0;
            __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_14, __pyx_t_9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 790, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8)) {
            __pyx_t_14 = __pyx_t_8; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14); __pyx_t_22 = 0;
            __pyx_t_23 = NULL;
          } else {
            __pyx_t_22 = -1; __pyx_t_14 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_8); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 790, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
            __pyx_t_23 = Py_TYPE(__pyx_t_14)-&gt;tp_iternext; if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 790, __pyx_L1_error)
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          for (;;) {
            if (likely(!__pyx_t_23)) {
              if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_14))) {
                if (__pyx_t_22 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_14)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_14, __pyx_t_22); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_22++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 790, __pyx_L1_error)
                #else
                __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_14, __pyx_t_22); __pyx_t_22++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 790, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
                #endif
              } else {
                if (__pyx_t_22 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_14)) break;
                #if CYTHON_COMPILING_IN_CPYTHON
                __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_14, __pyx_t_22); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_22++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 790, __pyx_L1_error)
                #else
                __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_14, __pyx_t_22); __pyx_t_22++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 790, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
                #endif
              }
            } else {
              __pyx_t_8 = __pyx_t_23(__pyx_t_14);
              if (unlikely(!__pyx_t_8)) {
                PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
                if (exc_type) {
                  if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                  else __PYX_ERR(0, 790, __pyx_L1_error)
                }
                break;
              }
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            }
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cp_j, __pyx_t_8);
            __pyx_t_8 = 0;
/* … */
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">0791</span>:                         <span class="n">cp_loc_j</span> <span class="o">=</span> <span class="n">cp_j</span> <span class="o">*</span> <span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>            __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nx, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 791, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_cp_j, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 791, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cp_loc_j, __pyx_t_9);
            __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0792</span>:                         <span class="c"># Chordwise loop through control points</span></pre>
<pre class="cython line score-75" onclick='toggleDiv(this)'>+<span class="">0793</span>:                         <span class="k">for</span> <span class="n">cp_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-75 '>            __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 793, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nx, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 793, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            __pyx_t_12 = NULL;
            if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
              __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
              if (likely(__pyx_t_12)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
              }
            }
            if (!__pyx_t_12) {
              __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_5); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 793, __pyx_L1_error)
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
            } else {
              __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 793, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, __pyx_t_5);
              __pyx_t_5 = 0;
              __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_11, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 793, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_9)) {
              __pyx_t_8 = __pyx_t_9; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_24 = 0;
              __pyx_t_25 = NULL;
            } else {
              __pyx_t_24 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 793, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
              __pyx_t_25 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext; if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 793, __pyx_L1_error)
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
            for (;;) {
              if (likely(!__pyx_t_25)) {
                if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
                  if (__pyx_t_24 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_24); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_24++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 793, __pyx_L1_error)
                  #else
                  __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_24); __pyx_t_24++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 793, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
                  #endif
                } else {
                  if (__pyx_t_24 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;
                  #if CYTHON_COMPILING_IN_CPYTHON
                  __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_24); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_24++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 793, __pyx_L1_error)
                  #else
                  __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_24); __pyx_t_24++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 793, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
                  #endif
                }
              } else {
                __pyx_t_9 = __pyx_t_25(__pyx_t_8);
                if (unlikely(!__pyx_t_9)) {
                  PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
                  if (exc_type) {
                    if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                    else __PYX_ERR(0, 793, __pyx_L1_error)
                  }
                  break;
                }
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
              }
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cp_i, __pyx_t_9);
              __pyx_t_9 = 0;
/* … */
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0794</span>:                             <span class="n">cp_loc</span> <span class="o">=</span> <span class="n">cp_i</span> <span class="o">+</span> <span class="n">cp_loc_j</span></pre>
<pre class='cython code score-6 '>              __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_cp_i, __pyx_v_cp_loc_j); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 794, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cp_loc, __pyx_t_9);
              __pyx_t_9 = 0;
</pre><pre class="cython line score-16" onclick='toggleDiv(this)'>+<span class="">0795</span>:                             <span class="n">P</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">cp_i</span><span class="p">,</span> <span class="n">cp_j</span><span class="p">]</span></pre>
<pre class='cython code score-16 '>              __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 795, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cp_i);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cp_i);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_cp_i);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cp_j);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cp_j);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_cp_j);
              __pyx_t_11 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_pts, __pyx_t_9); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 795, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_P, __pyx_t_11);
              __pyx_t_11 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0796</span>:                             <span class="n">r1</span> <span class="o">=</span> <span class="n">P</span> <span class="o">-</span> <span class="n">D_te</span></pre>
<pre class='cython code score-6 '>              __pyx_t_11 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_P, __pyx_v_D_te); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 796, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_r1, __pyx_t_11);
              __pyx_t_11 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0797</span>:                             <span class="n">r2</span> <span class="o">=</span> <span class="n">P</span> <span class="o">-</span> <span class="n">C_te</span></pre>
<pre class='cython code score-6 '>              __pyx_t_11 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_P, __pyx_v_C_te); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 797, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_r2, __pyx_t_11);
              __pyx_t_11 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0798</span>:                             <span class="n">r1_mag</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>              __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_norm); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 798, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
              __pyx_t_5 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
                __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
                if (likely(__pyx_t_5)) {
                  PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
                }
              }
              if (!__pyx_t_5) {
                __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_r1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 798, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              } else {
                __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 798, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_5); __pyx_t_5 = NULL;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r1);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r1);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+1, __pyx_v_r1);
                __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_12, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 798, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
              }
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_r1_mag, __pyx_t_11);
              __pyx_t_11 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">0799</span>:                             <span class="n">r2_mag</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>              __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_norm); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 799, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
              __pyx_t_12 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
                __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
                if (likely(__pyx_t_12)) {
                  PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
                }
              }
              if (!__pyx_t_12) {
                __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_r2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 799, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              } else {
                __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 799, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_12); __pyx_t_12 = NULL;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r2);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r2);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_r2);
                __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_5, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 799, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
              }
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_r2_mag, __pyx_t_11);
              __pyx_t_11 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0800</span>:                             <span class="n">t1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="o">/</span> \</pre>
<pre class='cython code score-34 '>              __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 800, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_cross); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 800, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
              __pyx_t_9 = NULL;
              __pyx_t_26 = 0;
              if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
                __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
                if (likely(__pyx_t_9)) {
                  PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
                  __pyx_t_26 = 1;
                }
              }
              __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_26); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 800, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
              if (__pyx_t_9) {
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_9); __pyx_t_9 = NULL;
              }
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_u);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_u);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+__pyx_t_26, __pyx_v_u);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r2);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r2);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1+__pyx_t_26, __pyx_v_r2);
              __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_12, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 800, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
              __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_11, __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 800, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t1, __pyx_t_12);
              __pyx_t_12 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0801</span>:                                 <span class="p">(</span><span class="n">r2_mag</span> <span class="o">*</span> <span class="p">(</span><span class="n">r2_mag</span> <span class="o">-</span> <span class="n">u</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r2</span><span class="p">)))</span></pre>
<pre class='cython code score-38 '>              __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_u, __pyx_n_s_dot); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 801, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
              __pyx_t_9 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
                __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
                if (likely(__pyx_t_9)) {
                  PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
                }
              }
              if (!__pyx_t_9) {
                __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, __pyx_v_r2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 801, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              } else {
                __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 801, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_9); __pyx_t_9 = NULL;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r2);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r2);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_v_r2);
                __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_10, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 801, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
              }
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
              __pyx_t_12 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_r2_mag, __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 801, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
              __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_r2_mag, __pyx_t_12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 801, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">0802</span>:                             <span class="n">t3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span> <span class="o">/</span> \</pre>
<pre class='cython code score-34 '>              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 802, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_cross); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 802, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
              __pyx_t_5 = NULL;
              __pyx_t_26 = 0;
              if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
                __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
                if (likely(__pyx_t_5)) {
                  PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
                  __pyx_t_26 = 1;
                }
              }
              __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_26); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 802, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
              if (__pyx_t_5) {
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_5); __pyx_t_5 = NULL;
              }
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_u);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_u);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_26, __pyx_v_u);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r1);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r1);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_26, __pyx_v_r1);
              __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_10, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 802, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
              __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_12, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 802, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3, __pyx_t_10);
              __pyx_t_10 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0803</span>:                                 <span class="p">(</span><span class="n">r1_mag</span> <span class="o">*</span> <span class="p">(</span><span class="n">r1_mag</span> <span class="o">-</span> <span class="n">u</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r1</span><span class="p">)))</span></pre>
<pre class='cython code score-38 '>              __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_u, __pyx_n_s_dot); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 803, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
              __pyx_t_5 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
                __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
                if (likely(__pyx_t_5)) {
                  PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
                }
              }
              if (!__pyx_t_5) {
                __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_v_r1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 803, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              } else {
                __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 803, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_5); __pyx_t_5 = NULL;
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r1);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r1);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_r1);
                __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_9, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 803, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
              }
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
              __pyx_t_10 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_r1_mag, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 803, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
              __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_r1_mag, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 803, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0804</span>:                             <span class="n">trailing</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">-</span> <span class="n">t3</span></pre>
<pre class='cython code score-6 '>              __pyx_t_10 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_t1, __pyx_v_t3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 804, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_trailing, __pyx_t_10);
              __pyx_t_10 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0805</span>:                             <span class="n">edges</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_edges, __pyx_int_0);
</pre><pre class="cython line score-0">&#xA0;<span class="">0806</span>:                             <span class="c"># Chordwise loop through horseshoe elements</span></pre>
<pre class="cython line score-84" onclick='toggleDiv(this)'>+<span class="">0807</span>:                             <span class="k">for</span> <span class="n">el_i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">nx_</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)):</span></pre>
<pre class='cython code score-84 '>              __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 807, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nx_, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 807, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
              __pyx_t_9 = NULL;
              if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
                __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
                if (likely(__pyx_t_9)) {
                  PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
                }
              }
              if (!__pyx_t_9) {
                __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_t_12); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 807, __pyx_L1_error)
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
              } else {
                __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 807, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_9); __pyx_t_9 = NULL;
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_12);
                __pyx_t_12 = 0;
                __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_5, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 807, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
              }
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
              __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 807, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_10);
              __pyx_t_10 = 0;
              __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_reversed, __pyx_t_11, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 807, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
              if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_10)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_10)) {
                __pyx_t_11 = __pyx_t_10; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_26 = 0;
                __pyx_t_27 = NULL;
              } else {
                __pyx_t_26 = -1; __pyx_t_11 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 807, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
                __pyx_t_27 = Py_TYPE(__pyx_t_11)-&gt;tp_iternext; if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 807, __pyx_L1_error)
              }
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
              for (;;) {
                if (likely(!__pyx_t_27)) {
                  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11))) {
                    if (__pyx_t_26 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_11)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_11, __pyx_t_26); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10); __pyx_t_26++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 807, __pyx_L1_error)
                    #else
                    __pyx_t_10 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_11, __pyx_t_26); __pyx_t_26++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 807, __pyx_L1_error)
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                    #endif
                  } else {
                    if (__pyx_t_26 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_11)) break;
                    #if CYTHON_COMPILING_IN_CPYTHON
                    __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_11, __pyx_t_26); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10); __pyx_t_26++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 807, __pyx_L1_error)
                    #else
                    __pyx_t_10 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_11, __pyx_t_26); __pyx_t_26++; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 807, __pyx_L1_error)
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                    #endif
                  }
                } else {
                  __pyx_t_10 = __pyx_t_27(__pyx_t_11);
                  if (unlikely(!__pyx_t_10)) {
                    PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
                    if (exc_type) {
                      if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                      else __PYX_ERR(0, 807, __pyx_L1_error)
                    }
                    break;
                  }
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                }
                <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_el_i, __pyx_t_10);
                __pyx_t_10 = 0;
/* … */
              }
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">0808</span>:                                 <span class="n">el_loc</span> <span class="o">=</span> <span class="n">el_i</span> <span class="o">+</span> <span class="n">el_loc_j</span></pre>
<pre class='cython code score-6 '>                __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_el_i, __pyx_v_el_loc_j); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 808, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_el_loc, __pyx_t_10);
                __pyx_t_10 = 0;
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">0809</span>:                                 <span class="n">A</span> <span class="o">=</span> <span class="n">bpts</span><span class="p">[</span><span class="n">el_i</span><span class="p">,</span> <span class="n">el_j</span> <span class="o">+</span> <span class="mf">0</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-24 '>                __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_el_j, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 809, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 809, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_el_i);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_el_i);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_el_i);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_10);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__285);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__285);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_slice__285);
                __pyx_t_10 = 0;
                __pyx_t_10 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_bpts, __pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 809, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
                <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_A, __pyx_t_10);
                __pyx_t_10 = 0;
/* … */
  __pyx_slice__285 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__285)) __PYX_ERR(0, 809, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__285);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__285);
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">0810</span>:                                 <span class="n">B</span> <span class="o">=</span> <span class="n">bpts</span><span class="p">[</span><span class="n">el_i</span><span class="p">,</span> <span class="n">el_j</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-24 '>                __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_el_j, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 810, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 810, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_el_i);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_el_i);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_el_i);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_10);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__286);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__286);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_slice__286);
                __pyx_t_10 = 0;
                __pyx_t_10 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_bpts, __pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 810, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
                <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_B, __pyx_t_10);
                __pyx_t_10 = 0;
/* … */
  __pyx_slice__286 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__286)) __PYX_ERR(0, 810, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__286);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__286);
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0811</span>:                                 <span class="k">if</span> <span class="n">el_i</span> <span class="o">==</span> <span class="n">nx_</span> <span class="o">-</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-11 '>                __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nx_, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 811, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_el_i, __pyx_t_10, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 811, __pyx_L1_error)
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
                __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_20 &lt; 0)) __PYX_ERR(0, 811, __pyx_L1_error)
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
                if (__pyx_t_20) {
/* … */
                  goto __pyx_L20;
                }
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">0812</span>:                                     <span class="n">C</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">el_j</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-24 '>                  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_el_j, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 812, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 812, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_int_neg_1);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_5);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__287);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__287);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_slice__287);
                  __pyx_t_5 = 0;
                  __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_t_10); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 812, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
                  <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_C, __pyx_t_5);
                  __pyx_t_5 = 0;
/* … */
  __pyx_slice__287 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__287)) __PYX_ERR(0, 812, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__287);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__287);
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">0813</span>:                                     <span class="n">D</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">el_j</span> <span class="o">+</span> <span class="mf">0</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-24 '>                  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_el_j, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 813, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 813, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_int_neg_1);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_5);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__288);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__288);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_slice__288);
                  __pyx_t_5 = 0;
                  __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_t_10); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 813, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
                  <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_D, __pyx_t_5);
                  __pyx_t_5 = 0;
/* … */
  __pyx_slice__288 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__288)) __PYX_ERR(0, 813, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__288);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__288);
</pre><pre class="cython line score-0">&#xA0;<span class="">0814</span>:                                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">0815</span>:                                     <span class="n">C</span> <span class="o">=</span> <span class="n">bpts</span><span class="p">[</span><span class="n">el_i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">el_j</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-25 '>                /*else*/ {
                  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_el_i, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 815, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_el_j, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 815, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 815, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_5);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_10);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__289);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__289);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_slice__289);
                  __pyx_t_5 = 0;
                  __pyx_t_10 = 0;
                  __pyx_t_10 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_bpts, __pyx_t_12); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 815, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                  <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_C, __pyx_t_10);
                  __pyx_t_10 = 0;
/* … */
  __pyx_slice__289 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__289)) __PYX_ERR(0, 815, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__289);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__289);
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">0816</span>:                                     <span class="n">D</span> <span class="o">=</span> <span class="n">bpts</span><span class="p">[</span><span class="n">el_i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">el_j</span> <span class="o">+</span> <span class="mf">0</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-25 '>                  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_el_i, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 816, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_el_j, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 816, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 816, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_10);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_12);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__290);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__290);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_slice__290);
                  __pyx_t_10 = 0;
                  __pyx_t_12 = 0;
                  __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_bpts, __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 816, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
                  <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_D, __pyx_t_12);
                  __pyx_t_12 = 0;
                }
                __pyx_L20:;
/* … */
  __pyx_slice__290 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__290)) __PYX_ERR(0, 816, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__290);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__290);
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">0817</span>:                                 <span class="n">edges</span> <span class="o">+=</span> <span class="n">calc_vorticity</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span></pre>
<pre class='cython code score-35 '>                __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_calc_vorticity); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 817, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                __pyx_t_10 = NULL;
                __pyx_t_28 = 0;
                if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
                  __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
                  if (likely(__pyx_t_10)) {
                    PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
                    __pyx_t_28 = 1;
                  }
                }
                __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_28); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 817, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
                if (__pyx_t_10) {
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_10); __pyx_t_10 = NULL;
                }
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_B);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_B);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_28, __pyx_v_B);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_C);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_C);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_28, __pyx_v_C);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_P);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_P);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_28, __pyx_v_P);
                __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_9, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 817, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
                __pyx_t_5 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_edges, __pyx_t_12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 817, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_edges, __pyx_t_5);
                __pyx_t_5 = 0;
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">0818</span>:                                 <span class="n">edges</span> <span class="o">+=</span> <span class="n">calc_vorticity</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span></pre>
<pre class='cython code score-35 '>                __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_calc_vorticity); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 818, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                __pyx_t_9 = NULL;
                __pyx_t_28 = 0;
                if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
                  __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
                  if (likely(__pyx_t_9)) {
                    PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
                    __pyx_t_28 = 1;
                  }
                }
                __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_28); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 818, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
                if (__pyx_t_9) {
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_9); __pyx_t_9 = NULL;
                }
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_D);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_D);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_28, __pyx_v_D);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_A);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_A);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_28, __pyx_v_A);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_P);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_P);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2+__pyx_t_28, __pyx_v_P);
                __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_10, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 818, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                __pyx_t_12 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_edges, __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 818, __pyx_L1_error)
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_edges, __pyx_t_12);
                __pyx_t_12 = 0;
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0819</span>:                                 <span class="k">if</span> <span class="n">skip</span> <span class="ow">and</span> <span class="n">el_loc</span> <span class="o">==</span> <span class="n">cp_loc</span><span class="p">:</span></pre>
<pre class='cython code score-10 '>                __pyx_t_29 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_skip); if (unlikely(__pyx_t_29 &lt; 0)) __PYX_ERR(0, 819, __pyx_L1_error)
                if (__pyx_t_29) {
                } else {
                  __pyx_t_20 = __pyx_t_29;
                  goto __pyx_L22_bool_binop_done;
                }
                __pyx_t_12 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_el_loc, __pyx_v_cp_loc, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_12); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 819, __pyx_L1_error)
                __pyx_t_29 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_12); if (unlikely(__pyx_t_29 &lt; 0)) __PYX_ERR(0, 819, __pyx_L1_error)
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                __pyx_t_20 = __pyx_t_29;
                __pyx_L22_bool_binop_done:;
                if (__pyx_t_20) {
/* … */
                  goto __pyx_L21;
                }
</pre><pre class="cython line score-23" onclick='toggleDiv(this)'>+<span class="">0820</span>:                                     <span class="n">small_mat</span><span class="p">[</span><span class="n">cp_loc</span><span class="p">,</span> <span class="n">el_loc</span><span class="p">,</span></pre>
<pre class='cython code score-23 '>                  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 820, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cp_loc);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cp_loc);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_cp_loc);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_el_loc);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_el_loc);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_el_loc);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__291);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__291);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_slice__291);
                  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_small_mat, __pyx_t_5, __pyx_t_12) &lt; 0)) __PYX_ERR(0, 820, __pyx_L1_error)
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
/* … */
  __pyx_slice__291 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__291)) __PYX_ERR(0, 820, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__291);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__291);
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0821</span>:                                               <span class="p">:]</span> <span class="o">=</span> <span class="n">trailing</span> <span class="o">+</span> <span class="n">edges</span></pre>
<pre class='cython code score-5 '>                  __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_trailing, __pyx_v_edges); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 821, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
</pre><pre class="cython line score-0">&#xA0;<span class="">0822</span>:                                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0823</span>:                                     <span class="n">bound</span> <span class="o">=</span> <span class="n">calc_vorticity</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>                /*else*/ {
                  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_calc_vorticity); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 823, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                  __pyx_t_10 = NULL;
                  __pyx_t_28 = 0;
                  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
                    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
                    if (likely(__pyx_t_10)) {
                      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
                      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
                      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
                      __pyx_t_28 = 1;
                    }
                  }
                  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_28); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 823, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
                  if (__pyx_t_10) {
                    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_10); __pyx_t_10 = NULL;
                  }
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_A);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_A);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_28, __pyx_v_A);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_B);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_B);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_28, __pyx_v_B);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_P);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_P);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_28, __pyx_v_P);
                  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_9, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 823, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
                  <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_bound, __pyx_t_12);
                  __pyx_t_12 = 0;
</pre><pre class="cython line score-23" onclick='toggleDiv(this)'>+<span class="">0824</span>:                                     <span class="n">small_mat</span><span class="p">[</span><span class="n">cp_loc</span><span class="p">,</span> <span class="n">el_loc</span><span class="p">,</span></pre>
<pre class='cython code score-23 '>                  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 824, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cp_loc);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cp_loc);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_v_cp_loc);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_el_loc);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_el_loc);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_v_el_loc);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__292);
                  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__292);
                  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_slice__292);
                  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_small_mat, __pyx_t_12, __pyx_t_5) &lt; 0)) __PYX_ERR(0, 824, __pyx_L1_error)
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
                }
                __pyx_L21:;
/* … */
  __pyx_slice__292 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__292)) __PYX_ERR(0, 824, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__292);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__292);
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">0825</span>:                                               <span class="p">:]</span> <span class="o">=</span> <span class="n">trailing</span> <span class="o">+</span> <span class="n">edges</span> <span class="o">+</span> <span class="n">bound</span></pre>
<pre class='cython code score-11 '>                  __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_trailing, __pyx_v_edges); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 825, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                  __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_12, __pyx_v_bound); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 825, __pyx_L1_error)
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-37" onclick='toggleDiv(this)'>+<span class="">0826</span>:             <span class="n">mtx</span><span class="p">[</span><span class="n">i_panels</span><span class="p">:</span> <span class="n">i_panels</span> <span class="o">+</span> <span class="n">n_panels</span><span class="p">,</span></pre>
<pre class='cython code score-37 '>      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_panels, __pyx_v_n_panels); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 826, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_14 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i_panels, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 826, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
      __pyx_t_8 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i_panels_, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 826, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 826, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__293);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__293);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_slice__293);
      __pyx_t_14 = 0;
      __pyx_t_8 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mtx, __pyx_t_4, __pyx_v_small_mat) &lt; 0)) __PYX_ERR(0, 826, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_slice__293 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__293)) __PYX_ERR(0, 826, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__293);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__293);
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">0827</span>:                 <span class="n">i_panels_</span><span class="p">:</span> <span class="n">i_panels_</span> <span class="o">+</span> <span class="n">n_panels_</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">small_mat</span></pre>
<pre class='cython code score-5 '>      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_panels_, __pyx_v_n_panels_); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 827, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0828</span>:     <span class="n">mtx</span> <span class="o">/=</span> <span class="mf">4</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span></pre>
<pre class='cython code score-15 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 828, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_pi); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 828, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 828, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_InPlaceDivide</span>(__pyx_v_mtx, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 828, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_mtx, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0829</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0830</span>: </pre>
<pre class="cython line score-124" onclick='toggleDiv(this)'>+<span class="">0831</span>: <span class="k">def</span> <span class="nf">assemble_AIC_system</span><span class="p">(</span><span class="n">AIC_mtx</span><span class="p">,</span> <span class="n">def_mesh</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">c_pts</span><span class="p">,</span> <span class="n">b_pts</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">tot_panels</span><span class="p">,</span> <span class="n">normals</span><span class="p">):</span></pre>
<pre class='cython code score-124 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_41assemble_AIC_system(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_41assemble_AIC_system = {"assemble_AIC_system", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_41assemble_AIC_system, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_41assemble_AIC_system(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_AIC_mtx = 0;
  PyObject *__pyx_v_def_mesh = 0;
  PyObject *__pyx_v_aero_ind = 0;
  PyObject *__pyx_v_c_pts = 0;
  PyObject *__pyx_v_b_pts = 0;
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_v_v = 0;
  PyObject *__pyx_v_tot_panels = 0;
  PyObject *__pyx_v_normals = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assemble_AIC_system (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_AIC_mtx,&amp;__pyx_n_s_def_mesh,&amp;__pyx_n_s_aero_ind,&amp;__pyx_n_s_c_pts,&amp;__pyx_n_s_b_pts,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_v,&amp;__pyx_n_s_tot_panels,&amp;__pyx_n_s_normals,0};
    PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_AIC_mtx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_def_mesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_system", 1, 9, 9, 1); __PYX_ERR(0, 831, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aero_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_system", 1, 9, 9, 2); __PYX_ERR(0, 831, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_c_pts)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_system", 1, 9, 9, 3); __PYX_ERR(0, 831, __pyx_L3_error)
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_b_pts)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_system", 1, 9, 9, 4); __PYX_ERR(0, 831, __pyx_L3_error)
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_system", 1, 9, 9, 5); __PYX_ERR(0, 831, __pyx_L3_error)
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_system", 1, 9, 9, 6); __PYX_ERR(0, 831, __pyx_L3_error)
        }
        case  7:
        if (likely((values[7] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_tot_panels)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_system", 1, 9, 9, 7); __PYX_ERR(0, 831, __pyx_L3_error)
        }
        case  8:
        if (likely((values[8] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_normals)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_system", 1, 9, 9, 8); __PYX_ERR(0, 831, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "assemble_AIC_system") &lt; 0)) __PYX_ERR(0, 831, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 9) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
    }
    __pyx_v_AIC_mtx = values[0];
    __pyx_v_def_mesh = values[1];
    __pyx_v_aero_ind = values[2];
    __pyx_v_c_pts = values[3];
    __pyx_v_b_pts = values[4];
    __pyx_v_alpha = values[5];
    __pyx_v_v = values[6];
    __pyx_v_tot_panels = values[7];
    __pyx_v_normals = values[8];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_AIC_system", 1, 9, 9, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 831, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.assemble_AIC_system", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_40assemble_AIC_system(__pyx_self, __pyx_v_AIC_mtx, __pyx_v_def_mesh, __pyx_v_aero_ind, __pyx_v_c_pts, __pyx_v_b_pts, __pyx_v_alpha, __pyx_v_v, __pyx_v_tot_panels, __pyx_v_normals);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_40assemble_AIC_system(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_AIC_mtx, PyObject *__pyx_v_def_mesh, PyObject *__pyx_v_aero_ind, PyObject *__pyx_v_c_pts, PyObject *__pyx_v_b_pts, PyObject *__pyx_v_alpha, PyObject *__pyx_v_v, PyObject *__pyx_v_tot_panels, PyObject *__pyx_v_normals) {
  PyObject *__pyx_v_mtx = NULL;
  PyObject *__pyx_v_rhs = NULL;
  PyObject *__pyx_v_ind = NULL;
  PyObject *__pyx_v_cosa = NULL;
  PyObject *__pyx_v_sina = NULL;
  PyObject *__pyx_v_v_inf = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assemble_AIC_system", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alpha);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.assemble_AIC_system", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rhs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cosa);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sina);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_inf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_alpha);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__585 = <span class='py_c_api'>PyTuple_Pack</span>(15, __pyx_n_s_AIC_mtx, __pyx_n_s_def_mesh, __pyx_n_s_aero_ind, __pyx_n_s_c_pts, __pyx_n_s_b_pts, __pyx_n_s_alpha, __pyx_n_s_v, __pyx_n_s_tot_panels, __pyx_n_s_normals, __pyx_n_s_mtx, __pyx_n_s_rhs, __pyx_n_s_ind, __pyx_n_s_cosa, __pyx_n_s_sina, __pyx_n_s_v_inf); if (unlikely(!__pyx_tuple__585)) __PYX_ERR(0, 831, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__585);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__585);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_41assemble_AIC_system, 0, __pyx_n_s_assemble_AIC_system, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__586)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_assemble_AIC_system, __pyx_t_2) &lt; 0) __PYX_ERR(0, 831, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__586 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(9, 0, 15, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__585, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_assemble_AIC_system, 831, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__586)) __PYX_ERR(0, 831, __pyx_L1_error)
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0832</span>:     <span class="n">mtx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_panels</span><span class="p">,</span> <span class="n">tot_panels</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 832, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 832, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 832, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_tot_panels);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 832, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 832, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 832, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) __PYX_ERR(0, 832, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 832, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_mtx = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">0833</span>:     <span class="n">rhs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_panels</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 833, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 833, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 833, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_tot_panels);
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 833, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 833, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) __PYX_ERR(0, 833, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 833, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rhs = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">0834</span>:     <span class="n">assemble_AIC_mtx</span><span class="p">(</span><span class="n">AIC_mtx</span><span class="p">,</span> <span class="n">def_mesh</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">c_pts</span><span class="p">,</span> <span class="n">b_pts</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span></pre>
<pre class='cython code score-35 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_assemble_AIC_mtx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 834, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(6+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 834, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (__pyx_t_4) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_AIC_mtx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_AIC_mtx);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+__pyx_t_5, __pyx_v_AIC_mtx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_def_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_def_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1+__pyx_t_5, __pyx_v_def_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2+__pyx_t_5, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_c_pts);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_c_pts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3+__pyx_t_5, __pyx_v_c_pts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_b_pts);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_b_pts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4+__pyx_t_5, __pyx_v_b_pts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alpha);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_alpha);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 5+__pyx_t_5, __pyx_v_alpha);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 834, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0835</span>:     <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-57 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 835, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__294, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_2 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 835, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 835, __pyx_L1_error)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 835, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 835, __pyx_L1_error)
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 835, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  __pyx_tuple__294 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3); if (unlikely(!__pyx_tuple__294)) __PYX_ERR(0, 835, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__294);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__294);
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-95" onclick='toggleDiv(this)'>+<span class="">0836</span>:         <span class="n">mtx</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">AIC_mtx</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">normals</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">])</span><span class="o">.</span><span class="n">T</span></pre>
<pre class='cython code score-95 '>  __pyx_slice__295 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__295)) __PYX_ERR(0, 836, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__295);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__295);
  __pyx_slice__296 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__296)) __PYX_ERR(0, 836, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__296);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__296);
/* … */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__297);
    __pyx_t_7 = __pyx_tuple__297;
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mtx, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 836, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_tuple__297 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__295, __pyx_slice__296); if (unlikely(!__pyx_tuple__297)) __PYX_ERR(0, 836, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__297);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__297);
  __pyx_slice__298 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__298)) __PYX_ERR(0, 836, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__298);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__298);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__298);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__298);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__298);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__299);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__299);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_slice__299);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_v_ind);
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_AIC_mtx, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 836, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_T); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_slice__299 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__299)) __PYX_ERR(0, 836, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__299);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__299);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 836, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__300);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__300);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_slice__300);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_ind);
    __pyx_t_8 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_normals, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 836, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 836, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_T); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 836, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_3, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 836, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mtx, __pyx_t_7, __pyx_t_4) &lt; 0)) __PYX_ERR(0, 836, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_slice__300 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__300)) __PYX_ERR(0, 836, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__300);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__300);
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0837</span>:     <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span></pre>
<pre class='cython code score-15 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 837, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_pi); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 837, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_alpha, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 837, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideObjC</span>(__pyx_t_2, __pyx_float_180_, 180., 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 837, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_alpha, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0838</span>:     <span class="n">cosa</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 838, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cos); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 838, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_v_alpha); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 838, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 838, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alpha);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_alpha);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_alpha);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 838, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_cosa = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0839</span>:     <span class="n">sina</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 839, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_sin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 839, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_8) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_alpha); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 839, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 839, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8); __pyx_t_8 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alpha);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_alpha);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_alpha);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 839, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_sina = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-46" onclick='toggleDiv(this)'>+<span class="">0840</span>:     <span class="n">v_inf</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cosa</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">sina</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-46 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 840, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 840, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 840, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cosa);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cosa);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_cosa);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_float_0_);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_float_0_);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sina);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sina);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_v_sina);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 840, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 840, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 840, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) __PYX_ERR(0, 840, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 840, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_v, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 840, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_v_inf = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-71" onclick='toggleDiv(this)'>+<span class="">0841</span>:     <span class="n">rhs</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">normals</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">normals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;F&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v_inf</span><span class="p">)</span></pre>
<pre class='cython code score-71 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_normals, __pyx_n_s_reshape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 841, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_normals, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 841, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 841, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 841, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 841, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_F) &lt; 0) __PYX_ERR(0, 841, __pyx_L1_error)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 841, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_dot); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 841, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_v_inf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 841, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 841, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_v_inf);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_v_inf);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_v_inf);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 841, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 841, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_rhs, __pyx_t_3, 0, 0, NULL, NULL, &amp;__pyx_slice__301, 0, 0, 1) &lt; 0) __PYX_ERR(0, 841, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__301 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__301)) __PYX_ERR(0, 841, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__301);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__301);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">0842</span>:     <span class="k">return</span> <span class="n">mtx</span><span class="p">,</span> <span class="n">rhs</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 842, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mtx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mtx);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_mtx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rhs);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rhs);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_rhs);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0843</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0844</span>: </pre>
<pre class="cython line score-104" onclick='toggleDiv(this)'>+<span class="">0845</span>: <span class="k">def</span> <span class="nf">vlm_circulations</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">,</span> <span class="n">def_mesh</span><span class="p">,</span> <span class="n">b_pts</span><span class="p">,</span> <span class="n">c_pts</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span></pre>
<pre class='cython code score-104 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_43vlm_circulations(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_42vlm_circulations[] = "\n    Compute the circulations based on the AIC matrix and the panel velocities.\n    Note that the flow tangency condition is enforced at the 3/4 chord point.\n\n    Parameters\n    ----------\n    def_mesh : array_like\n        Flattened array defining the lifting surfaces.\n    b_pts : array_like\n        Bound points for the horseshoe vortices, found along the 1/4 chord.\n    c_pts : array_like\n        Collocation points on the 3/4 chord line where the flow tangency\n        condition is satisfed. Used to set up the linear system.\n    normals : array_like\n        The normal vector for each panel, computed as the cross of the two\n        diagonals from the mesh points.\n    v : float\n        Freestream air velocity in m/s.\n    alpha : float\n        Angle of attack in degrees.\n\n    Returns\n    -------\n    circulations : array_like\n        Flattened vector of horseshoe vortex strengths calculated by solving\n        the linear system of AIC_mtx * circulations = rhs, where rhs is\n        based on the air velocity at each collocation point.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_43vlm_circulations = {"vlm_circulations", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_43vlm_circulations, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_42vlm_circulations};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_43vlm_circulations(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_aero_ind = 0;
  PyObject *__pyx_v_def_mesh = 0;
  PyObject *__pyx_v_b_pts = 0;
  PyObject *__pyx_v_c_pts = 0;
  PyObject *__pyx_v_normals = 0;
  PyObject *__pyx_v_v = 0;
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("vlm_circulations (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_aero_ind,&amp;__pyx_n_s_def_mesh,&amp;__pyx_n_s_b_pts,&amp;__pyx_n_s_c_pts,&amp;__pyx_n_s_normals,&amp;__pyx_n_s_v,&amp;__pyx_n_s_alpha,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aero_ind)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_def_mesh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_circulations", 1, 7, 7, 1); __PYX_ERR(0, 845, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_b_pts)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_circulations", 1, 7, 7, 2); __PYX_ERR(0, 845, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_c_pts)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_circulations", 1, 7, 7, 3); __PYX_ERR(0, 845, __pyx_L3_error)
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_normals)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_circulations", 1, 7, 7, 4); __PYX_ERR(0, 845, __pyx_L3_error)
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_circulations", 1, 7, 7, 5); __PYX_ERR(0, 845, __pyx_L3_error)
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_circulations", 1, 7, 7, 6); __PYX_ERR(0, 845, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vlm_circulations") &lt; 0)) __PYX_ERR(0, 845, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_aero_ind = values[0];
    __pyx_v_def_mesh = values[1];
    __pyx_v_b_pts = values[2];
    __pyx_v_c_pts = values[3];
    __pyx_v_normals = values[4];
    __pyx_v_v = values[5];
    __pyx_v_alpha = values[6];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_circulations", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 845, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.vlm_circulations", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_42vlm_circulations(__pyx_self, __pyx_v_aero_ind, __pyx_v_def_mesh, __pyx_v_b_pts, __pyx_v_c_pts, __pyx_v_normals, __pyx_v_v, __pyx_v_alpha);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_42vlm_circulations(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_aero_ind, PyObject *__pyx_v_def_mesh, PyObject *__pyx_v_b_pts, PyObject *__pyx_v_c_pts, PyObject *__pyx_v_normals, PyObject *__pyx_v_v, PyObject *__pyx_v_alpha) {
  CYTHON_UNUSED PyObject *__pyx_v_tot_n = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_tot_bpts = NULL;
  PyObject *__pyx_v_tot_panels = NULL;
  PyObject *__pyx_v_AIC_mtx = NULL;
  PyObject *__pyx_v_mtx = NULL;
  PyObject *__pyx_v_rhs = NULL;
  PyObject *__pyx_v_circulations = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("vlm_circulations", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.vlm_circulations", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_AIC_mtx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rhs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_circulations);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__587 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_aero_ind, __pyx_n_s_def_mesh, __pyx_n_s_b_pts, __pyx_n_s_c_pts, __pyx_n_s_normals, __pyx_n_s_v, __pyx_n_s_alpha, __pyx_n_s_tot_n, __pyx_n_s_tot_bpts, __pyx_n_s_tot_panels, __pyx_n_s_AIC_mtx, __pyx_n_s_mtx, __pyx_n_s_rhs, __pyx_n_s_circulations); if (unlikely(!__pyx_tuple__587)) __PYX_ERR(0, 845, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__587);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__587);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_43vlm_circulations, 0, __pyx_n_s_vlm_circulations, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__588)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 845, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_vlm_circulations, __pyx_t_2) &lt; 0) __PYX_ERR(0, 845, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__588 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 14, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__587, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_vlm_circulations, 845, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__588)) __PYX_ERR(0, 845, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">0846</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0847</span>: <span class="sd">    Compute the circulations based on the AIC matrix and the panel velocities.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0848</span>: <span class="sd">    Note that the flow tangency condition is enforced at the 3/4 chord point.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0849</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0850</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0851</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0852</span>: <span class="sd">    def_mesh : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0853</span>: <span class="sd">        Flattened array defining the lifting surfaces.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0854</span>: <span class="sd">    b_pts : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0855</span>: <span class="sd">        Bound points for the horseshoe vortices, found along the 1/4 chord.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0856</span>: <span class="sd">    c_pts : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0857</span>: <span class="sd">        Collocation points on the 3/4 chord line where the flow tangency</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0858</span>: <span class="sd">        condition is satisfed. Used to set up the linear system.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0859</span>: <span class="sd">    normals : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0860</span>: <span class="sd">        The normal vector for each panel, computed as the cross of the two</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0861</span>: <span class="sd">        diagonals from the mesh points.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0862</span>: <span class="sd">    v : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0863</span>: <span class="sd">        Freestream air velocity in m/s.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0864</span>: <span class="sd">    alpha : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0865</span>: <span class="sd">        Angle of attack in degrees.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0866</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0867</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0868</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0869</span>: <span class="sd">    circulations : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0870</span>: <span class="sd">        Flattened vector of horseshoe vortex strengths calculated by solving</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0871</span>: <span class="sd">        the linear system of AIC_mtx * circulations = rhs, where rhs is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0872</span>: <span class="sd">        based on the air velocity at each collocation point.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0873</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0874</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0875</span>:     <span class="n">tot_n</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__302 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__302)) __PYX_ERR(0, 875, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__302);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__302);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__303); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 875, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 875, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_tot_n = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__303 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__302, __pyx_int_2); if (unlikely(!__pyx_tuple__303)) __PYX_ERR(0, 875, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__303);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__303);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0876</span>:     <span class="n">tot_bpts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">3</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 876, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__304 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__304)) __PYX_ERR(0, 876, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__304);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__304);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__305); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 876, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 876, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 876, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_tot_bpts = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__305 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__304, __pyx_int_3); if (unlikely(!__pyx_tuple__305)) __PYX_ERR(0, 876, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__305);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__305);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0877</span>:     <span class="n">tot_panels</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">4</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 877, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 877, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_slice__306 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__306)) __PYX_ERR(0, 877, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__306);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__306);
  __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__307); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 877, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 877, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_tot_panels = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__307 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__306, __pyx_int_4); if (unlikely(!__pyx_tuple__307)) __PYX_ERR(0, 877, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__307);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__307);
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">0878</span>:     <span class="n">AIC_mtx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_panels</span><span class="p">,</span> <span class="n">tot_panels</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 878, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 878, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 878, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 878, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 878, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 878, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) __PYX_ERR(0, 878, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 878, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_AIC_mtx = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0879</span>:     <span class="n">mtx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_panels</span><span class="p">,</span> <span class="n">tot_panels</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 879, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 879, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 879, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_tot_panels);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 879, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 879, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 879, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) __PYX_ERR(0, 879, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 879, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_mtx = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">0880</span>:     <span class="n">rhs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_panels</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 880, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 880, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 880, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_tot_panels);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 880, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 880, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) __PYX_ERR(0, 880, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 880, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_rhs = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-4" onclick='toggleDiv(this)'>+<span class="">0881</span>:     <span class="n">mtx</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">assemble_AIC_system</span><span class="p">(</span></pre>
<pre class='cython code score-4 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_assemble_AIC_system); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 881, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_mtx, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_rhs, __pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-85" onclick='toggleDiv(this)'>+<span class="">0882</span>:         <span class="n">AIC_mtx</span><span class="p">,</span> <span class="n">def_mesh</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">c_pts</span><span class="p">,</span> <span class="n">b_pts</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">tot_panels</span><span class="p">,</span> <span class="n">normals</span><span class="p">)</span></pre>
<pre class='cython code score-85 '>  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(9+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 881, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_4) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_AIC_mtx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_AIC_mtx);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_6, __pyx_v_AIC_mtx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_def_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_def_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_6, __pyx_v_def_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_6, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_c_pts);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_c_pts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 3+__pyx_t_6, __pyx_v_c_pts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_b_pts);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_b_pts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 4+__pyx_t_6, __pyx_v_b_pts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alpha);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_alpha);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 5+__pyx_t_6, __pyx_v_alpha);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_v);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_v);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 6+__pyx_t_6, __pyx_v_v);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 7+__pyx_t_6, __pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_normals);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_normals);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 8+__pyx_t_6, __pyx_v_normals);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 881, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 881, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 881, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 881, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_7(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_5 = __pyx_t_7(__pyx_t_4); if (unlikely(!__pyx_t_5)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_7(__pyx_t_4), 2) &lt; 0) __PYX_ERR(0, 881, __pyx_L1_error)
    __pyx_t_7 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_7 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 881, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">0883</span>:     <span class="n">circulations</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">mtx</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 883, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_linalg); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 883, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_solve); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 883, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 883, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (__pyx_t_2) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mtx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mtx);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_6, __pyx_v_mtx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rhs);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rhs);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_6, __pyx_v_rhs);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 883, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_circulations = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0884</span>:     <span class="k">return</span> <span class="n">circulations</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_circulations);
  __pyx_r = __pyx_v_circulations;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0885</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0886</span>: </pre>
<pre class="cython line score-139" onclick='toggleDiv(this)'>+<span class="">0887</span>: <span class="k">def</span> <span class="nf">vlm_forces</span><span class="p">(</span><span class="n">def_mesh</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">b_pts</span><span class="p">,</span> <span class="n">mid_b</span><span class="p">,</span> <span class="n">circ</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">3</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mf">10</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-139 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_45vlm_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_44vlm_forces[] = " Compute aerodynamic forces acting on each section.\n\n    Parameters\n    ----------\n    def_mesh : array_like\n        Flattened array defining the lifting surfaces.\n    b_pts : array_like\n        Bound points for the horseshoe vortices, found along the 1/4 chord.\n    mid_b : array_like\n        Midpoints of the bound vortex segments, used as the collocation\n        points to compute drag.\n    circ : array_like   (circulations)\n        Flattened vector of horseshoe vortex strengths calculated by solving\n        the linear system of AIC_mtx * circulations = rhs, where rhs is\n        based on the air velocity at each collocation point.\n    alpha : float\n        Angle of attack in degrees.\n    v : float\n        Freestream air velocity in m/s.\n    rho : float\n        Air density in kg/m^3.\n\n    Returns\n    -------\n    sec_forces : array_like\n        Flattened array containing the sectional forces acting on each panel.\n        Stored in Fortran order (only relevant when more than one chordwise\n        panel).\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_45vlm_forces = {"vlm_forces", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_45vlm_forces, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_44vlm_forces};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_45vlm_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_def_mesh = 0;
  PyObject *__pyx_v_aero_ind = 0;
  PyObject *__pyx_v_b_pts = 0;
  PyObject *__pyx_v_mid_b = 0;
  PyObject *__pyx_v_circ = 0;
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_v_v = 0;
  PyObject *__pyx_v_rho = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("vlm_forces (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_def_mesh,&amp;__pyx_n_s_aero_ind,&amp;__pyx_n_s_b_pts,&amp;__pyx_n_s_mid_b,&amp;__pyx_n_s_circ,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_v,&amp;__pyx_n_s_rho,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    values[5] = ((PyObject *)((PyObject *)__pyx_int_3));
    values[6] = ((PyObject *)((PyObject *)__pyx_int_10));
    values[7] = ((PyObject *)((PyObject *)__pyx_int_3));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_def_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aero_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_forces", 0, 5, 8, 1); __PYX_ERR(0, 887, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_b_pts)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_forces", 0, 5, 8, 2); __PYX_ERR(0, 887, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mid_b)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_forces", 0, 5, 8, 3); __PYX_ERR(0, 887, __pyx_L3_error)
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_circ)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_forces", 0, 5, 8, 4); __PYX_ERR(0, 887, __pyx_L3_error)
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha);
          if (value) { values[5] = value; kw_args--; }
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_v);
          if (value) { values[6] = value; kw_args--; }
        }
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_rho);
          if (value) { values[7] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "vlm_forces") &lt; 0)) __PYX_ERR(0, 887, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_def_mesh = values[0];
    __pyx_v_aero_ind = values[1];
    __pyx_v_b_pts = values[2];
    __pyx_v_mid_b = values[3];
    __pyx_v_circ = values[4];
    __pyx_v_alpha = values[5];
    __pyx_v_v = values[6];
    __pyx_v_rho = values[7];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("vlm_forces", 0, 5, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 887, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.vlm_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_44vlm_forces(__pyx_self, __pyx_v_def_mesh, __pyx_v_aero_ind, __pyx_v_b_pts, __pyx_v_mid_b, __pyx_v_circ, __pyx_v_alpha, __pyx_v_v, __pyx_v_rho);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_44vlm_forces(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_def_mesh, PyObject *__pyx_v_aero_ind, PyObject *__pyx_v_b_pts, PyObject *__pyx_v_mid_b, PyObject *__pyx_v_circ, PyObject *__pyx_v_alpha, PyObject *__pyx_v_v, PyObject *__pyx_v_rho) {
  CYTHON_UNUSED PyObject *__pyx_v_tot_n = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_tot_bpts = NULL;
  PyObject *__pyx_v_tot_panels = NULL;
  PyObject *__pyx_v_mtx = NULL;
  PyObject *__pyx_v_vel = NULL;
  PyObject *__pyx_v_sec_forces = NULL;
  PyObject *__pyx_v_cosa = NULL;
  PyObject *__pyx_v_sina = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i_surf = NULL;
  PyObject *__pyx_v_row = NULL;
  PyObject *__pyx_v_nx = NULL;
  PyObject *__pyx_v_ny = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_n = NULL;
  PyObject *__pyx_v_n_bpts = NULL;
  PyObject *__pyx_v_n_panels = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_i_bpts = NULL;
  PyObject *__pyx_v_i_panels = NULL;
  PyObject *__pyx_v_ind = NULL;
  PyObject *__pyx_v_bound = NULL;
  PyObject *__pyx_v_cross = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("vlm_forces", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_b_pts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alpha);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.vlm_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vel);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sec_forces);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cosa);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sina);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bound);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cross);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_b_pts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_alpha);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__589 = <span class='py_c_api'>PyTuple_Pack</span>(29, __pyx_n_s_def_mesh, __pyx_n_s_aero_ind, __pyx_n_s_b_pts, __pyx_n_s_mid_b, __pyx_n_s_circ, __pyx_n_s_alpha, __pyx_n_s_v, __pyx_n_s_rho, __pyx_n_s_tot_n, __pyx_n_s_tot_bpts, __pyx_n_s_tot_panels, __pyx_n_s_mtx, __pyx_n_s_vel, __pyx_n_s_sec_forces, __pyx_n_s_cosa, __pyx_n_s_sina, __pyx_n_s_i_surf, __pyx_n_s_row, __pyx_n_s_nx, __pyx_n_s_ny, __pyx_n_s_n, __pyx_n_s_n_bpts, __pyx_n_s_n_panels, __pyx_n_s_i, __pyx_n_s_i_bpts, __pyx_n_s_i_panels, __pyx_n_s_ind, __pyx_n_s_bound, __pyx_n_s_cross); if (unlikely(!__pyx_tuple__589)) __PYX_ERR(0, 887, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__589);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__589);
  __pyx_codeobj__590 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 29, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__589, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_vlm_forces, 887, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__590)) __PYX_ERR(0, 887, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_45vlm_forces, 0, __pyx_n_s_vlm_forces, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__590)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 887, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__591);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_vlm_forces, __pyx_t_2) &lt; 0) __PYX_ERR(0, 887, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__591 = <span class='py_c_api'>PyTuple_Pack</span>(3, ((PyObject *)__pyx_int_3), ((PyObject *)__pyx_int_10), ((PyObject *)__pyx_int_3)); if (unlikely(!__pyx_tuple__591)) __PYX_ERR(0, 887, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__591);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__591);
</pre><pre class="cython line score-0">&#xA0;<span class="">0888</span>:     <span class="sd">&quot;&quot;&quot; Compute aerodynamic forces acting on each section.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0889</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0890</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0891</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0892</span>: <span class="sd">    def_mesh : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0893</span>: <span class="sd">        Flattened array defining the lifting surfaces.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0894</span>: <span class="sd">    b_pts : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0895</span>: <span class="sd">        Bound points for the horseshoe vortices, found along the 1/4 chord.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0896</span>: <span class="sd">    mid_b : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0897</span>: <span class="sd">        Midpoints of the bound vortex segments, used as the collocation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0898</span>: <span class="sd">        points to compute drag.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>: <span class="sd">    circ : array_like   (circulations)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0900</span>: <span class="sd">        Flattened vector of horseshoe vortex strengths calculated by solving</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0901</span>: <span class="sd">        the linear system of AIC_mtx * circulations = rhs, where rhs is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0902</span>: <span class="sd">        based on the air velocity at each collocation point.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0903</span>: <span class="sd">    alpha : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0904</span>: <span class="sd">        Angle of attack in degrees.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0905</span>: <span class="sd">    v : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0906</span>: <span class="sd">        Freestream air velocity in m/s.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0907</span>: <span class="sd">    rho : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0908</span>: <span class="sd">        Air density in kg/m^3.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0909</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0910</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0911</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0912</span>: <span class="sd">    sec_forces : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0913</span>: <span class="sd">        Flattened array containing the sectional forces acting on each panel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0914</span>: <span class="sd">        Stored in Fortran order (only relevant when more than one chordwise</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0915</span>: <span class="sd">        panel).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0916</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0917</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0918</span>:     <span class="n">tot_n</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 918, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 918, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__308 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__308)) __PYX_ERR(0, 918, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__308);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__308);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__309); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 918, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 918, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 918, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 918, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_tot_n = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__309 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__308, __pyx_int_2); if (unlikely(!__pyx_tuple__309)) __PYX_ERR(0, 918, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__309);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__309);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0919</span>:     <span class="n">tot_bpts</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">3</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__310 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__310)) __PYX_ERR(0, 919, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__310);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__310);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__311); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 919, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 919, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 919, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_tot_bpts = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__311 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__310, __pyx_int_3); if (unlikely(!__pyx_tuple__311)) __PYX_ERR(0, 919, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__311);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__311);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0920</span>:     <span class="n">tot_panels</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">4</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 920, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 920, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_slice__312 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__312)) __PYX_ERR(0, 920, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__312);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__312);
  __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__313); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 920, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 920, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 920, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 920, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_tot_panels = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__313 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__312, __pyx_int_4); if (unlikely(!__pyx_tuple__313)) __PYX_ERR(0, 920, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__313);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__313);
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">0921</span>:     <span class="n">mtx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_panels</span><span class="p">,</span> <span class="n">tot_panels</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 921, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 921, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 921, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 921, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 921, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 921, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) __PYX_ERR(0, 921, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 921, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_mtx = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0922</span>:     <span class="n">vel</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_panels</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 922, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 922, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 922, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 922, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 922, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 922, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) __PYX_ERR(0, 922, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 922, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_vel = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0923</span>:     <span class="n">sec_forces</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_panels</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-38 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 923, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 923, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 923, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_panels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_panels);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 923, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 923, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 923, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_sec_forces = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">0924</span>:     <span class="n">alpha</span> <span class="o">*=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span></pre>
<pre class='cython code score-15 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 924, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_pi); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideObjC</span>(__pyx_t_2, __pyx_float_180_, 180., 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 924, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_v_alpha, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_alpha, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0925</span>:     <span class="n">cosa</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 925, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_cos); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 925, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_alpha); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 925, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 925, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alpha);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_alpha);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_alpha);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 925, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_cosa = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0926</span>:     <span class="n">sina</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 926, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 926, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_alpha); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 926, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 926, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alpha);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_alpha);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_alpha);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 926, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_sina = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">0927</span>:     <span class="n">assemble_AIC_mtx</span><span class="p">(</span><span class="n">mtx</span><span class="p">,</span> <span class="n">def_mesh</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">mid_b</span><span class="p">,</span> <span class="n">b_pts</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython code score-35 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_assemble_AIC_mtx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 927, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 927, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mtx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mtx);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_mtx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_def_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_def_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_def_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mid_b);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mid_b);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 3, __pyx_v_mid_b);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_b_pts);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_b_pts);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 4, __pyx_v_b_pts);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_alpha);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_alpha);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 5, __pyx_v_alpha);
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 927, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_skip, Py_True) &lt; 0) __PYX_ERR(0, 927, __pyx_L1_error)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 927, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0928</span>:     <span class="k">for</span> <span class="n">i_surf</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_3 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_aero_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_aero_ind)) {
    __pyx_t_4 = __pyx_v_aero_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_aero_ind); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 928, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 928, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 928, __pyx_L1_error)
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 928, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 928, __pyx_L1_error)
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 928, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_7(__pyx_t_4);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 928, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_surf, __pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 928, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3);
    __pyx_t_3 = __pyx_t_5;
    __pyx_t_5 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-70" onclick='toggleDiv(this)'>+<span class="">0929</span>:         <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_bpts</span><span class="p">,</span> <span class="n">n_panels</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_bpts</span><span class="p">,</span> <span class="n">i_panels</span> <span class="o">=</span> <span class="n">row</span></pre>
<pre class='cython code score-70 '>    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_row))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_row))) {
      PyObject* sequence = __pyx_v_row;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 8)) {
        if (size &gt; 8) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(8);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 929, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 6); 
        __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 7); 
      } else {
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 6); 
        __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 7); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[8] = {&amp;__pyx_t_5,&amp;__pyx_t_2,&amp;__pyx_t_1,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12};
        for (i=0; i &lt; 8; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 929, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[8] = {&amp;__pyx_t_5,&amp;__pyx_t_2,&amp;__pyx_t_1,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12};
      __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_row); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 929, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_14 = Py_TYPE(__pyx_t_13)-&gt;tp_iternext;
      for (index=0; index &lt; 8; index++) {
        PyObject* item = __pyx_t_14(__pyx_t_13); if (unlikely(!item)) goto __pyx_L5_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_14(__pyx_t_13), 8) &lt; 0) __PYX_ERR(0, 929, __pyx_L1_error)
      __pyx_t_14 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_14 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 929, __pyx_L1_error)
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_nx, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ny, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_bpts, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_panels, __pyx_t_9);
    __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_bpts, __pyx_t_11);
    __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_panels, __pyx_t_12);
    __pyx_t_12 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0930</span>: </pre>
<pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0931</span>:         <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-57 '>    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 931, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_tuple__314, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 931, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_11)) {
      __pyx_t_12 = __pyx_t_11; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_15 = 0;
      __pyx_t_16 = NULL;
    } else {
      __pyx_t_15 = -1; __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 931, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_16 = Py_TYPE(__pyx_t_12)-&gt;tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 931, __pyx_L1_error)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    for (;;) {
      if (likely(!__pyx_t_16)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_12))) {
          if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_12)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_12, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_15++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 931, __pyx_L1_error)
          #else
          __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_12, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 931, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          #endif
        } else {
          if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_12)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_12, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11); __pyx_t_15++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 931, __pyx_L1_error)
          #else
          __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_12, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 931, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          #endif
        }
      } else {
        __pyx_t_11 = __pyx_t_16(__pyx_t_12);
        if (unlikely(!__pyx_t_11)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else __PYX_ERR(0, 931, __pyx_L1_error)
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_11);
      __pyx_t_11 = 0;
/* … */
  __pyx_tuple__314 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3); if (unlikely(!__pyx_tuple__314)) __PYX_ERR(0, 931, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__314);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__314);
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-75" onclick='toggleDiv(this)'>+<span class="">0932</span>:             <span class="n">vel</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtx</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span></pre>
<pre class='cython code score-75 '>  __pyx_slice__315 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__315)) __PYX_ERR(0, 932, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__315);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__315);
/* … */
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 932, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__315);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__315);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_slice__315);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__316);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__316);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_slice__316);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_v_ind);
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mtx, __pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 932, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_dot); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 932, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_v_circ); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 932, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      } else {
        __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 932, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_9); __pyx_t_9 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_circ);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_circ);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+1, __pyx_v_circ);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_8, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 932, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_slice__316 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__316)) __PYX_ERR(0, 932, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__316);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__316);
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 932, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__317);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__317);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_slice__317);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_ind);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_vel, __pyx_t_10, __pyx_t_11) &lt; 0)) __PYX_ERR(0, 932, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_slice__317 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__317)) __PYX_ERR(0, 932, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__317);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__317);
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">0933</span>:         <span class="n">vel</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cosa</span> <span class="o">*</span> <span class="n">v</span></pre>
<pre class='cython code score-35 '>  __pyx_slice__318 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__318)) __PYX_ERR(0, 933, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__318);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__318);
/* … */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__319);
    __pyx_t_17 = __pyx_tuple__319;
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vel, __pyx_t_17); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 933, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_cosa, __pyx_v_v); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 933, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_10 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_12, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 933, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_vel, __pyx_t_17, __pyx_t_10) &lt; 0)) __PYX_ERR(0, 933, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  __pyx_tuple__319 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__318, __pyx_int_0); if (unlikely(!__pyx_tuple__319)) __PYX_ERR(0, 933, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__319);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__319);
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">0934</span>:         <span class="n">vel</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sina</span> <span class="o">*</span> <span class="n">v</span></pre>
<pre class='cython code score-35 '>  __pyx_slice__320 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__320)) __PYX_ERR(0, 934, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__320);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__320);
/* … */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__321);
    __pyx_t_17 = __pyx_tuple__321;
    __pyx_t_10 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_vel, __pyx_t_17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 934, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sina, __pyx_v_v); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 934, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_12 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_10, __pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 934, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_vel, __pyx_t_17, __pyx_t_12) &lt; 0)) __PYX_ERR(0, 934, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  __pyx_tuple__321 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__320, __pyx_int_2); if (unlikely(!__pyx_tuple__321)) __PYX_ERR(0, 934, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__321);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__321);
</pre><pre class="cython line score-0">&#xA0;<span class="">0935</span>: </pre>
<pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">0936</span>:         <span class="n">b_pts</span> <span class="o">=</span> <span class="n">b_pts</span><span class="p">[</span><span class="n">i_bpts</span><span class="p">:</span> <span class="n">i_bpts</span> <span class="o">+</span> <span class="n">n_bpts</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-61 '>    __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_bpts, __pyx_v_n_bpts); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 936, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_10 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i_bpts, __pyx_t_11, Py_None); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 936, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 936, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__322);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__322);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_slice__322);
    __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_b_pts, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 936, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_reshape); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 936, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nx, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 936, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_8 = NULL;
    __pyx_t_15 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        __pyx_t_15 = 1;
      }
    }
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 936, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_8) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_15, __pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_15, __pyx_v_ny);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_15, __pyx_int_3);
    __pyx_t_10 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_9, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 936, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_b_pts, __pyx_t_12);
    __pyx_t_12 = 0;
/* … */
  __pyx_slice__322 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__322)) __PYX_ERR(0, 936, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__322);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__322);
</pre><pre class="cython line score-0">&#xA0;<span class="">0937</span>: </pre>
<pre class="cython line score-58" onclick='toggleDiv(this)'>+<span class="">0938</span>:         <span class="n">bound</span> <span class="o">=</span> <span class="n">b_pts</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">b_pts</span><span class="p">[:,</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-58 '>  __pyx_slice__323 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__323)) __PYX_ERR(0, 938, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__323);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__323);
  __pyx_slice__324 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__324)) __PYX_ERR(0, 938, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__324);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__324);
  __pyx_slice__325 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__325)) __PYX_ERR(0, 938, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__325);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__325);
/* … */
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_b_pts, __pyx_tuple__326); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 938, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_tuple__326 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__323, __pyx_slice__324, __pyx_slice__325); if (unlikely(!__pyx_tuple__326)) __PYX_ERR(0, 938, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__326);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__326);
  __pyx_slice__327 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__327)) __PYX_ERR(0, 938, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__327);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__327);
  __pyx_slice__328 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__328)) __PYX_ERR(0, 938, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__328);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__328);
  __pyx_slice__329 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__329)) __PYX_ERR(0, 938, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__329);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__329);
    __pyx_t_11 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_b_pts, __pyx_tuple__330); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 938, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_12, __pyx_t_11); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 938, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_bound, __pyx_t_9);
    __pyx_t_9 = 0;
  __pyx_tuple__330 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__327, __pyx_slice__328, __pyx_slice__329); if (unlikely(!__pyx_tuple__330)) __PYX_ERR(0, 938, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__330);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__330);
</pre><pre class="cython line score-0">&#xA0;<span class="">0939</span>: </pre>
<pre class="cython line score-13" onclick='toggleDiv(this)'>+<span class="">0940</span>:         <span class="n">cross</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">vel</span><span class="p">[</span><span class="n">i_panels</span><span class="p">:</span> <span class="n">i_panels</span> <span class="o">+</span> <span class="n">n_panels</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 940, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_cross); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 940, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_panels, __pyx_v_n_panels); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 940, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_vel, 0, 0, &amp;__pyx_v_i_panels, &amp;__pyx_t_11, NULL, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 940, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0941</span>:                             <span class="n">bound</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">bound</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">],</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;F&#39;</span><span class="p">))</span></pre>
<pre class='cython code score-53 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_bound, __pyx_n_s_reshape); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 941, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_bound, __pyx_n_s_shape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 941, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_8, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 941, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 941, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 941, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_order, __pyx_n_s_F) &lt; 0) __PYX_ERR(0, 941, __pyx_L1_error)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_8, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 941, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_15 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
        __pyx_t_15 = 1;
      }
    }
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_15); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 940, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_1) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_1); __pyx_t_1 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_15, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_15, __pyx_t_2);
    __pyx_t_10 = 0;
    __pyx_t_2 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_8, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 940, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cross, __pyx_t_9);
    __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0942</span>: </pre>
<pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">0943</span>:         <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-57 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 943, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__331, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 943, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_12)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_12)) {
      __pyx_t_9 = __pyx_t_12; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_15 = 0;
      __pyx_t_16 = NULL;
    } else {
      __pyx_t_15 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 943, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_16 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 943, __pyx_L1_error)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    for (;;) {
      if (likely(!__pyx_t_16)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
          if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_15++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 943, __pyx_L1_error)
          #else
          __pyx_t_12 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 943, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          #endif
        } else {
          if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_15++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 943, __pyx_L1_error)
          #else
          __pyx_t_12 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_15); __pyx_t_15++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 943, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          #endif
        }
      } else {
        __pyx_t_12 = __pyx_t_16(__pyx_t_9);
        if (unlikely(!__pyx_t_12)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else __PYX_ERR(0, 943, __pyx_L1_error)
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_12);
      __pyx_t_12 = 0;
/* … */
  __pyx_tuple__331 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3); if (unlikely(!__pyx_tuple__331)) __PYX_ERR(0, 943, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__331);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__331);
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">0944</span>:             <span class="n">sec_forces</span><span class="p">[</span><span class="n">i_panels</span><span class="p">:</span> <span class="n">i_panels</span> <span class="o">+</span> <span class="n">n_panels</span><span class="p">,</span></pre>
<pre class='cython code score-26 '>      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_panels, __pyx_v_n_panels); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_12 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i_panels, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 944, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_ind);
      __pyx_t_12 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_sec_forces, __pyx_t_2, __pyx_t_8) &lt; 0)) __PYX_ERR(0, 944, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-41" onclick='toggleDiv(this)'>+<span class="">0945</span>:                        <span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">circ</span><span class="p">[</span><span class="n">i_panels</span><span class="p">:</span> <span class="n">i_panels</span> <span class="o">+</span> <span class="n">n_panels</span><span class="p">]</span> <span class="o">*</span> <span class="n">cross</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">])</span></pre>
<pre class='cython code score-41 '>      __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_panels, __pyx_v_n_panels); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 945, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_circ, 0, 0, &amp;__pyx_v_i_panels, &amp;__pyx_t_12, NULL, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 945, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_rho, __pyx_t_8); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 945, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 945, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__332);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__332);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_slice__332);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_ind);
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_cross, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 945, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 945, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__332 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__332)) __PYX_ERR(0, 945, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__332);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__332);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0946</span>:     <span class="k">return</span> <span class="n">sec_forces</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sec_forces);
  __pyx_r = __pyx_v_sec_forces;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0947</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0948</span>: </pre>
<pre class="cython line score-119" onclick='toggleDiv(this)'>+<span class="">0949</span>: <span class="k">def</span> <span class="nf">transfer_loads</span><span class="p">(</span><span class="n">def_mesh</span><span class="p">,</span> <span class="n">sec_forces</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">,</span> <span class="n">fem_origin</span><span class="o">=</span><span class="mf">0.35</span><span class="p">):</span></pre>
<pre class='cython code score-119 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_47transfer_loads(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_46transfer_loads[] = "\n    Perform aerodynamic load transfer.\n\n    Apply the computed sectional forces on the aerodynamic surfaces to\n    obtain the deformed mesh FEM loads.\n\n    Parameters\n    ----------\n    def_mesh : array_like\n        Flattened array defining the lifting surfaces after deformation.\n    sec_forces : array_like\n        Flattened array containing the sectional forces acting on each panel.\n        Stored in Fortran order (only relevant when more than one chordwise\n        panel).\n\n    Returns\n    -------\n    loads : array_like\n        Flattened array containing the loads applied on the FEM component,\n        computed from the sectional forces.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_47transfer_loads = {"transfer_loads", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_47transfer_loads, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_46transfer_loads};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_47transfer_loads(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_def_mesh = 0;
  PyObject *__pyx_v_sec_forces = 0;
  PyObject *__pyx_v_aero_ind = 0;
  PyObject *__pyx_v_fem_ind = 0;
  PyObject *__pyx_v_fem_origin = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("transfer_loads (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_def_mesh,&amp;__pyx_n_s_sec_forces,&amp;__pyx_n_s_aero_ind,&amp;__pyx_n_s_fem_ind,&amp;__pyx_n_s_fem_origin,0};
    PyObject* values[5] = {0,0,0,0,0};
    values[4] = ((PyObject *)((PyObject*)__pyx_float_0_35));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_def_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sec_forces)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("transfer_loads", 0, 4, 5, 1); __PYX_ERR(0, 949, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aero_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("transfer_loads", 0, 4, 5, 2); __PYX_ERR(0, 949, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_fem_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("transfer_loads", 0, 4, 5, 3); __PYX_ERR(0, 949, __pyx_L3_error)
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_fem_origin);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "transfer_loads") &lt; 0)) __PYX_ERR(0, 949, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_def_mesh = values[0];
    __pyx_v_sec_forces = values[1];
    __pyx_v_aero_ind = values[2];
    __pyx_v_fem_ind = values[3];
    __pyx_v_fem_origin = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("transfer_loads", 0, 4, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 949, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.transfer_loads", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_46transfer_loads(__pyx_self, __pyx_v_def_mesh, __pyx_v_sec_forces, __pyx_v_aero_ind, __pyx_v_fem_ind, __pyx_v_fem_origin);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_46transfer_loads(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_def_mesh, PyObject *__pyx_v_sec_forces, PyObject *__pyx_v_aero_ind, PyObject *__pyx_v_fem_ind, PyObject *__pyx_v_fem_origin) {
  CYTHON_UNUSED PyObject *__pyx_v_tot_n = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_tot_panels = NULL;
  PyObject *__pyx_v_tot_n_fem = NULL;
  PyObject *__pyx_v_output_loads = NULL;
  PyObject *__pyx_v_i_surf = NULL;
  PyObject *__pyx_v_row = NULL;
  PyObject *__pyx_v_nx = NULL;
  PyObject *__pyx_v_ny = NULL;
  PyObject *__pyx_v_n = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_n_bpts = NULL;
  PyObject *__pyx_v_n_panels = NULL;
  PyObject *__pyx_v_i = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i_bpts = NULL;
  PyObject *__pyx_v_i_panels = NULL;
  PyObject *__pyx_v_n_fem = NULL;
  PyObject *__pyx_v_i_fem = NULL;
  PyObject *__pyx_v_mesh = NULL;
  PyObject *__pyx_v_w = NULL;
  PyObject *__pyx_v_a_pts = NULL;
  PyObject *__pyx_v_s_pts = NULL;
  PyObject *__pyx_v_moment = NULL;
  PyObject *__pyx_v_ind = NULL;
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_v_F = NULL;
  PyObject *__pyx_v_loads = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("transfer_loads", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sec_forces);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.transfer_loads", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_output_loads);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_w);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_a_pts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s_pts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_moment);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_F);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_loads);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sec_forces);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__592 = <span class='py_c_api'>PyTuple_Pack</span>(30, __pyx_n_s_def_mesh, __pyx_n_s_sec_forces, __pyx_n_s_aero_ind, __pyx_n_s_fem_ind, __pyx_n_s_fem_origin, __pyx_n_s_tot_n, __pyx_n_s_tot_panels, __pyx_n_s_tot_n_fem, __pyx_n_s_output_loads, __pyx_n_s_i_surf, __pyx_n_s_row, __pyx_n_s_nx, __pyx_n_s_ny, __pyx_n_s_n, __pyx_n_s_n_bpts, __pyx_n_s_n_panels, __pyx_n_s_i, __pyx_n_s_i_bpts, __pyx_n_s_i_panels, __pyx_n_s_n_fem, __pyx_n_s_i_fem, __pyx_n_s_mesh, __pyx_n_s_w, __pyx_n_s_a_pts, __pyx_n_s_s_pts, __pyx_n_s_moment, __pyx_n_s_ind, __pyx_n_s_r, __pyx_n_s_F, __pyx_n_s_loads); if (unlikely(!__pyx_tuple__592)) __PYX_ERR(0, 949, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__592);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__592);
  __pyx_codeobj__593 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 30, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__592, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_transfer_loads, 949, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__593)) __PYX_ERR(0, 949, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_47transfer_loads, 0, __pyx_n_s_transfer_loads, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__593)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 949, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__594);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_transfer_loads, __pyx_t_2) &lt; 0) __PYX_ERR(0, 949, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__594 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject*)__pyx_float_0_35)); if (unlikely(!__pyx_tuple__594)) __PYX_ERR(0, 949, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__594);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__594);
</pre><pre class="cython line score-0">&#xA0;<span class="">0950</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0951</span>: <span class="sd">    Perform aerodynamic load transfer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0952</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0953</span>: <span class="sd">    Apply the computed sectional forces on the aerodynamic surfaces to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0954</span>: <span class="sd">    obtain the deformed mesh FEM loads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0958</span>: <span class="sd">    def_mesh : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0959</span>: <span class="sd">        Flattened array defining the lifting surfaces after deformation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>: <span class="sd">    sec_forces : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>: <span class="sd">        Flattened array containing the sectional forces acting on each panel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>: <span class="sd">        Stored in Fortran order (only relevant when more than one chordwise</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0963</span>: <span class="sd">        panel).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0964</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0965</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0967</span>: <span class="sd">    loads : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0968</span>: <span class="sd">        Flattened array containing the loads applied on the FEM component,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0969</span>: <span class="sd">        computed from the sectional forces.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0970</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0971</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0972</span>:     <span class="n">tot_n</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 972, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 972, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__333 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__333)) __PYX_ERR(0, 972, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__333);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__333);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__334); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 972, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 972, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 972, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 972, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_tot_n = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__334 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__333, __pyx_int_2); if (unlikely(!__pyx_tuple__334)) __PYX_ERR(0, 972, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__334);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__334);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0973</span>:     <span class="n">tot_panels</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">4</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 973, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 973, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__335 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__335)) __PYX_ERR(0, 973, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__335);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__335);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__336); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 973, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 973, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 973, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 973, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_tot_panels = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__336 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__335, __pyx_int_4); if (unlikely(!__pyx_tuple__336)) __PYX_ERR(0, 973, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__336);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__336);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0974</span>:     <span class="n">tot_n_fem</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 974, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 974, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_slice__337 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__337)) __PYX_ERR(0, 974, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__337);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__337);
  __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fem_ind, __pyx_tuple__338); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 974, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 974, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 974, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 974, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_tot_n_fem = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__338 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__337, __pyx_int_0); if (unlikely(!__pyx_tuple__338)) __PYX_ERR(0, 974, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__338);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__338);
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">0975</span>:     <span class="n">output_loads</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_n_fem</span><span class="p">,</span> <span class="mf">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 975, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 975, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 975, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_n_fem);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_n_fem);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_tot_n_fem);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_6);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 975, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 975, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 975, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) __PYX_ERR(0, 975, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 975, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_output_loads = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">0976</span>:     <span class="k">for</span> <span class="n">i_surf</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_5 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_fem_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_fem_ind)) {
    __pyx_t_1 = __pyx_v_fem_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_fem_ind); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 976, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 976, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 976, __pyx_L1_error)
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 976, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 976, __pyx_L1_error)
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 976, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_7(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 976, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_surf, __pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_5, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 976, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5);
    __pyx_t_5 = __pyx_t_2;
    __pyx_t_2 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-92" onclick='toggleDiv(this)'>+<span class="">0977</span>:         <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_bpts</span><span class="p">,</span> <span class="n">n_panels</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_bpts</span><span class="p">,</span> <span class="n">i_panels</span> <span class="o">=</span> <span class="n">aero_ind</span><span class="p">[</span><span class="n">i_surf</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-92 '>    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 977, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i_surf);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i_surf);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_i_surf);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__339);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__339);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_slice__339);
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 977, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
      PyObject* sequence = __pyx_t_4;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 8)) {
        if (size &gt; 8) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(8);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 977, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
        __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 6); 
        __pyx_t_13 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 7); 
      } else {
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
        __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 6); 
        __pyx_t_13 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 7); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[8] = {&amp;__pyx_t_2,&amp;__pyx_t_3,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_13};
        for (i=0; i &lt; 8; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 977, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[8] = {&amp;__pyx_t_2,&amp;__pyx_t_3,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_13};
      __pyx_t_14 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 977, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_15 = Py_TYPE(__pyx_t_14)-&gt;tp_iternext;
      for (index=0; index &lt; 8; index++) {
        PyObject* item = __pyx_t_15(__pyx_t_14); if (unlikely(!item)) goto __pyx_L5_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_14), 8) &lt; 0) __PYX_ERR(0, 977, __pyx_L1_error)
      __pyx_t_15 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 977, __pyx_L1_error)
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_nx, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ny, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_bpts, __pyx_t_9);
    __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_panels, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_11);
    __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_bpts, __pyx_t_12);
    __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_panels, __pyx_t_13);
    __pyx_t_13 = 0;
/* … */
  __pyx_slice__339 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__339)) __PYX_ERR(0, 977, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__339);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__339);
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">0978</span>:         <span class="n">n_fem</span><span class="p">,</span> <span class="n">i_fem</span> <span class="o">=</span> <span class="n">row</span></pre>
<pre class='cython code score-47 '>    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_row))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_row))) {
      PyObject* sequence = __pyx_v_row;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 978, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_13 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_13 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 978, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_13 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 978, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      #endif
    } else {
      Py_ssize_t index = -1;
      __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_row); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 978, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_15 = Py_TYPE(__pyx_t_12)-&gt;tp_iternext;
      index = 0; __pyx_t_4 = __pyx_t_15(__pyx_t_12); if (unlikely(!__pyx_t_4)) goto __pyx_L7_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      index = 1; __pyx_t_13 = __pyx_t_15(__pyx_t_12); if (unlikely(!__pyx_t_13)) goto __pyx_L7_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_12), 2) &lt; 0) __PYX_ERR(0, 978, __pyx_L1_error)
      __pyx_t_15 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      goto __pyx_L8_unpacking_done;
      __pyx_L7_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_15 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 978, __pyx_L1_error)
      __pyx_L8_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_fem, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_fem, __pyx_t_13);
    __pyx_t_13 = 0;
</pre><pre class="cython line score-60" onclick='toggleDiv(this)'>+<span class="">0979</span>:         <span class="n">mesh</span> <span class="o">=</span> <span class="n">def_mesh</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-60 '>    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i, __pyx_v_n); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 979, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_12 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 979, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 979, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__340);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__340);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_slice__340);
    __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_def_mesh, __pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 979, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_reshape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 979, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    __pyx_t_16 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_16 = 1;
      }
    }
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_16); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 979, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (__pyx_t_12) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_16, __pyx_v_nx);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_16, __pyx_v_ny);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2+__pyx_t_16, __pyx_int_3);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_11, NULL); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 979, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_mesh, __pyx_t_13);
    __pyx_t_13 = 0;
/* … */
  __pyx_slice__340 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__340)) __PYX_ERR(0, 979, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__340);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__340);
</pre><pre class="cython line score-33" onclick='toggleDiv(this)'>+<span class="">0980</span>:         <span class="n">sec_forces</span> <span class="o">=</span> <span class="n">sec_forces</span><span class="p">[</span><span class="n">i_panels</span><span class="p">:</span> <span class="n">i_panels</span> <span class="o">+</span> <span class="n">n_panels</span><span class="p">,</span> <span class="p">:</span> <span class="p">]</span><span class="o">.</span> \</pre>
<pre class='cython code score-33 '>    __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_panels, __pyx_v_n_panels); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 980, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_4 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i_panels, __pyx_t_13, Py_None); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 980, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 980, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__341);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__341);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1, __pyx_slice__341);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_sec_forces, __pyx_t_13); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 980, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_reshape); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 980, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_slice__341 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__341)) __PYX_ERR(0, 980, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__341);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__341);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">0981</span>:             <span class="n">reshape</span><span class="p">(</span><span class="n">nx</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="n">ny</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;F&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nx, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 981, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_ny, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 981, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 981, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_int_3);
    __pyx_t_4 = 0;
    __pyx_t_11 = 0;
    __pyx_t_11 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 981, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_order, __pyx_n_s_F) &lt; 0) __PYX_ERR(0, 981, __pyx_L1_error)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_12, __pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 981, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sec_forces, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">0982</span>:         <span class="n">sec_forces</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sec_forces</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 982, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 982, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 982, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sec_forces);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sec_forces);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_sec_forces);
    __pyx_t_12 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 982, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_s_axis, __pyx_int_0) &lt; 0) __PYX_ERR(0, 982, __pyx_L1_error)
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_4, __pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 982, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sec_forces, __pyx_t_13);
    __pyx_t_13 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0983</span>:         <span class="n">w</span> <span class="o">=</span> <span class="mf">0.25</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_25);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_w, __pyx_float_0_25);
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">0984</span>:         <span class="n">a_pts</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">mesh</span><span class="p">[:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:</span> <span class="p">]</span> <span class="o">+</span> \</pre>
<pre class='cython code score-47 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_w, 1, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 984, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 984, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
/* … */
  __pyx_slice__342 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__342)) __PYX_ERR(0, 984, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__342);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__342);
  __pyx_slice__343 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__343)) __PYX_ERR(0, 984, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__343);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__343);
  __pyx_slice__344 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__344)) __PYX_ERR(0, 984, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__344);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__344);
    __pyx_t_13 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__345); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 984, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_13); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 984, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_tuple__345 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__342, __pyx_slice__343, __pyx_slice__344); if (unlikely(!__pyx_tuple__345)) __PYX_ERR(0, 984, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__345);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__345);
/* … */
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 984, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0985</span>:             <span class="mf">0.5</span> <span class="o">*</span>   <span class="n">w</span>   <span class="o">*</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">:</span> <span class="p">,</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:</span> <span class="p">]</span> <span class="o">+</span> \</pre>
<pre class='cython code score-44 '>    __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_v_w); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 985, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
/* … */
  __pyx_slice__346 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__346)) __PYX_ERR(0, 985, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__346);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__346);
  __pyx_slice__347 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__347)) __PYX_ERR(0, 985, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__347);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__347);
  __pyx_slice__348 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__348)) __PYX_ERR(0, 985, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__348);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__348);
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__349); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 985, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_13, __pyx_t_12); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 985, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_tuple__349 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__346, __pyx_slice__347, __pyx_slice__348); if (unlikely(!__pyx_tuple__349)) __PYX_ERR(0, 985, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__349);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__349);
/* … */
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_12, __pyx_t_13); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 985, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-48" onclick='toggleDiv(this)'>+<span class="">0986</span>:             <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">mesh</span><span class="p">[:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span>  <span class="mf">1</span><span class="p">:</span> <span class="p">,</span> <span class="p">:</span> <span class="p">]</span> <span class="o">+</span> \</pre>
<pre class='cython code score-48 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_w, 1, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 986, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 986, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
  __pyx_slice__350 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__350)) __PYX_ERR(0, 986, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__350);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__350);
  __pyx_slice__351 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__351)) __PYX_ERR(0, 986, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__351);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__351);
  __pyx_slice__352 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__352)) __PYX_ERR(0, 986, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__352);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__352);
    __pyx_t_11 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__353); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 986, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_11); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 986, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_tuple__353 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__350, __pyx_slice__351, __pyx_slice__352); if (unlikely(!__pyx_tuple__353)) __PYX_ERR(0, 986, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__353);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__353);
/* … */
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_11, __pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 986, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_a_pts, __pyx_t_12);
    __pyx_t_12 = 0;
</pre><pre class="cython line score-37" onclick='toggleDiv(this)'>+<span class="">0987</span>:             <span class="mf">0.5</span> <span class="o">*</span> <span class="n">w</span> <span class="o">*</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">:,</span>  <span class="mf">1</span><span class="p">:,</span> <span class="p">:]</span></pre>
<pre class='cython code score-37 '>    __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_v_w); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 987, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
/* … */
  __pyx_slice__354 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__354)) __PYX_ERR(0, 987, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__354);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__354);
  __pyx_slice__355 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__355)) __PYX_ERR(0, 987, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__355);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__355);
  __pyx_slice__356 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__356)) __PYX_ERR(0, 987, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__356);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__356);
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__357); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 987, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_13, __pyx_t_12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 987, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_tuple__357 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__354, __pyx_slice__355, __pyx_slice__356); if (unlikely(!__pyx_tuple__357)) __PYX_ERR(0, 987, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__357);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__357);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">0988</span>:         <span class="n">w</span> <span class="o">=</span> <span class="n">fem_origin</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_origin);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_w, __pyx_v_fem_origin);
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">0989</span>:         <span class="n">s_pts</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">mesh</span><span class="p">[:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:</span> <span class="p">]</span> <span class="o">+</span> \</pre>
<pre class='cython code score-47 '>    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_w, 1, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 989, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 989, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
/* … */
  __pyx_slice__358 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__358)) __PYX_ERR(0, 989, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__358);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__358);
  __pyx_slice__359 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__359)) __PYX_ERR(0, 989, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__359);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__359);
  __pyx_slice__360 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__360)) __PYX_ERR(0, 989, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__360);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__360);
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__361); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 989, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_12); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 989, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_tuple__361 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__358, __pyx_slice__359, __pyx_slice__360); if (unlikely(!__pyx_tuple__361)) __PYX_ERR(0, 989, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__361);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__361);
/* … */
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_11, __pyx_t_13); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 989, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">0990</span>:             <span class="mf">0.5</span> <span class="o">*</span>   <span class="n">w</span>   <span class="o">*</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">:</span> <span class="p">,</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:</span> <span class="p">]</span> <span class="o">+</span> \</pre>
<pre class='cython code score-44 '>    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_v_w); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 990, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
/* … */
  __pyx_slice__362 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__362)) __PYX_ERR(0, 990, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__362);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__362);
  __pyx_slice__363 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__363)) __PYX_ERR(0, 990, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__363);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__363);
  __pyx_slice__364 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__364)) __PYX_ERR(0, 990, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__364);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__364);
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__365); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 990, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_4); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 990, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__365 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__362, __pyx_slice__363, __pyx_slice__364); if (unlikely(!__pyx_tuple__365)) __PYX_ERR(0, 990, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__365);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__365);
/* … */
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 990, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-48" onclick='toggleDiv(this)'>+<span class="">0991</span>:             <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">mesh</span><span class="p">[:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span>  <span class="mf">1</span><span class="p">:</span> <span class="p">,</span> <span class="p">:</span> <span class="p">]</span> <span class="o">+</span> \</pre>
<pre class='cython code score-48 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_w, 1, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 991, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_13); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 991, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
/* … */
  __pyx_slice__366 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__366)) __PYX_ERR(0, 991, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__366);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__366);
  __pyx_slice__367 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__367)) __PYX_ERR(0, 991, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__367);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__367);
  __pyx_slice__368 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__368)) __PYX_ERR(0, 991, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__368);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__368);
    __pyx_t_13 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__369); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 991, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_11, __pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 991, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_tuple__369 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__366, __pyx_slice__367, __pyx_slice__368); if (unlikely(!__pyx_tuple__369)) __PYX_ERR(0, 991, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__369);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__369);
/* … */
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_13, __pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 991, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_s_pts, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-37" onclick='toggleDiv(this)'>+<span class="">0992</span>:             <span class="mf">0.5</span> <span class="o">*</span> <span class="n">w</span> <span class="o">*</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">1</span><span class="p">:,</span>  <span class="mf">1</span><span class="p">:,</span> <span class="p">:]</span></pre>
<pre class='cython code score-37 '>    __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_v_w); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 992, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
/* … */
  __pyx_slice__370 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__370)) __PYX_ERR(0, 992, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__370);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__370);
  __pyx_slice__371 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__371)) __PYX_ERR(0, 992, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__371);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__371);
  __pyx_slice__372 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__372)) __PYX_ERR(0, 992, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__372);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__372);
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__373); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 992, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 992, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__373 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_slice__370, __pyx_slice__371, __pyx_slice__372); if (unlikely(!__pyx_tuple__373)) __PYX_ERR(0, 992, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__373);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__373);
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">0993</span>:         <span class="n">moment</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ny</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 993, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 993, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_ny, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 993, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 993, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1, __pyx_int_3);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 993, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_13);
    __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 993, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 993, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_dtype, __pyx_t_12) &lt; 0) __PYX_ERR(0, 993, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_4, __pyx_t_13); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 993, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_moment, __pyx_t_12);
    __pyx_t_12 = 0;
</pre><pre class="cython line score-75" onclick='toggleDiv(this)'>+<span class="">0994</span>:         <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ny</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-75 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 994, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_ny, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 994, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_11 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
      }
    }
    if (!__pyx_t_11) {
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_13, __pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 994, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    } else {
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 994, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_11); __pyx_t_11 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_10, NULL); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 994, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_12)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_12)) {
      __pyx_t_13 = __pyx_t_12; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13); __pyx_t_16 = 0;
      __pyx_t_17 = NULL;
    } else {
      __pyx_t_16 = -1; __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 994, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_17 = Py_TYPE(__pyx_t_13)-&gt;tp_iternext; if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 994, __pyx_L1_error)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    for (;;) {
      if (likely(!__pyx_t_17)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_13))) {
          if (__pyx_t_16 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_13)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_13, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_16++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 994, __pyx_L1_error)
          #else
          __pyx_t_12 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_13, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 994, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          #endif
        } else {
          if (__pyx_t_16 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_13)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_13, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_16++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 994, __pyx_L1_error)
          #else
          __pyx_t_12 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_13, __pyx_t_16); __pyx_t_16++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 994, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          #endif
        }
      } else {
        __pyx_t_12 = __pyx_t_17(__pyx_t_13);
        if (unlikely(!__pyx_t_12)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else __PYX_ERR(0, 994, __pyx_L1_error)
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_12);
      __pyx_t_12 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-52" onclick='toggleDiv(this)'>+<span class="">0995</span>:             <span class="n">r</span> <span class="o">=</span> <span class="n">a_pts</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">s_pts</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-52 '>      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 995, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_int_0);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_v_ind);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__374);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__374);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_slice__374);
      __pyx_t_10 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_a_pts, __pyx_t_12); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 995, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
/* … */
  __pyx_slice__374 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__374)) __PYX_ERR(0, 995, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__374);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__374);
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 995, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_int_0);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_v_ind);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__375);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__375);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_slice__375);
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_s_pts, __pyx_t_12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 995, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_10, __pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 995, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_r, __pyx_t_12);
      __pyx_t_12 = 0;
  __pyx_slice__375 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__375)) __PYX_ERR(0, 995, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__375);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__375);
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">0996</span>:             <span class="n">F</span> <span class="o">=</span> <span class="n">sec_forces</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-21 '>      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 996, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_v_ind);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__376);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__376);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_slice__376);
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_sec_forces, __pyx_t_12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 996, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_F, __pyx_t_4);
      __pyx_t_4 = 0;
/* … */
  __pyx_slice__376 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__376)) __PYX_ERR(0, 996, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__376);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__376);
</pre><pre class="cython line score-50" onclick='toggleDiv(this)'>+<span class="">0997</span>:             <span class="n">moment</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span></pre>
<pre class='cython code score-50 '>      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 997, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_cross); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 997, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = NULL;
      __pyx_t_18 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_12)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_18 = 1;
        }
      }
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_18); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 997, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      if (__pyx_t_12) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_18, __pyx_v_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_F);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_F);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_18, __pyx_v_F);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_11, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 997, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 997, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ind);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ind);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_v_ind);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__377);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__377);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_slice__377);
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_moment, __pyx_t_10, __pyx_t_4) &lt; 0)) __PYX_ERR(0, 997, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_slice__377 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__377)) __PYX_ERR(0, 997, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__377);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__377);
</pre><pre class="cython line score-39" onclick='toggleDiv(this)'>+<span class="">0998</span>:         <span class="n">loads</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ny</span><span class="p">,</span> <span class="mf">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 998, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 998, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 998, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_v_ny);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1, __pyx_int_6);
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 998, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_13);
    __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 998, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 998, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_dtype, __pyx_t_11) &lt; 0) __PYX_ERR(0, 998, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_10, __pyx_t_13); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 998, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_loads, __pyx_t_11);
    __pyx_t_11 = 0;
</pre><pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">0999</span>:         <span class="n">loads</span><span class="p">[:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:</span> <span class="mf">3</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sec_forces</span><span class="p">[:,</span> <span class="p">:]</span></pre>
<pre class='cython code score-61 '>  __pyx_slice__378 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__378)) __PYX_ERR(0, 999, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__378);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__378);
  __pyx_slice__379 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__379)) __PYX_ERR(0, 999, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__379);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__379);
/* … */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__380);
    __pyx_t_19 = __pyx_tuple__380;
    __pyx_t_11 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_loads, __pyx_t_19); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 999, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_tuple__380 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__378, __pyx_slice__379); if (unlikely(!__pyx_tuple__380)) __PYX_ERR(0, 999, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__380);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__380);
  __pyx_slice__381 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__381)) __PYX_ERR(0, 999, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__381);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__381);
  __pyx_slice__382 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__382)) __PYX_ERR(0, 999, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__382);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__382);
    __pyx_t_13 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_sec_forces, __pyx_tuple__383); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 999, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_10 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_13); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 999, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_11, __pyx_t_10); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 999, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_loads, __pyx_t_19, __pyx_t_13) &lt; 0)) __PYX_ERR(0, 999, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_tuple__383 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__381, __pyx_slice__382); if (unlikely(!__pyx_tuple__383)) __PYX_ERR(0, 999, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__383);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__383);
</pre><pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">1000</span>:         <span class="n">loads</span><span class="p">[</span><span class="mf">1</span><span class="p">:,</span> <span class="p">:</span> <span class="mf">3</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sec_forces</span><span class="p">[:,</span> <span class="p">:]</span></pre>
<pre class='cython code score-61 '>  __pyx_slice__384 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__384)) __PYX_ERR(0, 1000, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__384);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__384);
  __pyx_slice__385 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_3, Py_None); if (unlikely(!__pyx_slice__385)) __PYX_ERR(0, 1000, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__385);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__385);
/* … */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__386);
    __pyx_t_19 = __pyx_tuple__386;
    __pyx_t_13 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_loads, __pyx_t_19); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1000, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_tuple__386 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__384, __pyx_slice__385); if (unlikely(!__pyx_tuple__386)) __PYX_ERR(0, 1000, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__386);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__386);
  __pyx_slice__387 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__387)) __PYX_ERR(0, 1000, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__387);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__387);
  __pyx_slice__388 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__388)) __PYX_ERR(0, 1000, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__388);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__388);
    __pyx_t_10 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_sec_forces, __pyx_tuple__389); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1000, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1000, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_13, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1000, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_loads, __pyx_t_19, __pyx_t_10) &lt; 0)) __PYX_ERR(0, 1000, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_tuple__389 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__387, __pyx_slice__388); if (unlikely(!__pyx_tuple__389)) __PYX_ERR(0, 1000, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__389);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__389);
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">1001</span>:         <span class="n">loads</span><span class="p">[:</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">3</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">moment</span></pre>
<pre class='cython code score-40 '>  __pyx_slice__390 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__390)) __PYX_ERR(0, 1001, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__390);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__390);
  __pyx_slice__391 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_3, Py_None, Py_None); if (unlikely(!__pyx_slice__391)) __PYX_ERR(0, 1001, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__391);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__391);
/* … */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__392);
    __pyx_t_19 = __pyx_tuple__392;
    __pyx_t_10 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_loads, __pyx_t_19); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1001, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_v_moment); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1001, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_13 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_10, __pyx_t_11); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1001, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_loads, __pyx_t_19, __pyx_t_13) &lt; 0)) __PYX_ERR(0, 1001, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_tuple__392 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__390, __pyx_slice__391); if (unlikely(!__pyx_tuple__392)) __PYX_ERR(0, 1001, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__392);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__392);
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">1002</span>:         <span class="n">loads</span><span class="p">[</span><span class="mf">1</span><span class="p">:,</span> <span class="mf">3</span><span class="p">:]</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">moment</span></pre>
<pre class='cython code score-40 '>  __pyx_slice__393 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__393)) __PYX_ERR(0, 1002, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__393);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__393);
  __pyx_slice__394 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_3, Py_None, Py_None); if (unlikely(!__pyx_slice__394)) __PYX_ERR(0, 1002, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__394);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__394);
/* … */
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__395);
    __pyx_t_19 = __pyx_tuple__395;
    __pyx_t_13 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_loads, __pyx_t_19); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1002, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_v_moment); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1002, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_10 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_13, __pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1002, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_loads, __pyx_t_19, __pyx_t_10) &lt; 0)) __PYX_ERR(0, 1002, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_tuple__395 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__393, __pyx_slice__394); if (unlikely(!__pyx_tuple__395)) __PYX_ERR(0, 1002, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__395);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__395);
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1003</span>:         <span class="n">output_loads</span><span class="p">[</span><span class="n">i_fem</span><span class="p">:</span> <span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">loads</span></pre>
<pre class='cython code score-30 '>    __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1003, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_11 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i_fem, __pyx_t_10, Py_None); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1003, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1003, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__396);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__396);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_slice__396);
    __pyx_t_11 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_output_loads, __pyx_t_10, __pyx_v_loads) &lt; 0)) __PYX_ERR(0, 1003, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
/* … */
  __pyx_slice__396 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__396)) __PYX_ERR(0, 1003, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__396);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__396);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1004</span>:     <span class="k">return</span> <span class="n">output_loads</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_output_loads);
  __pyx_r = __pyx_v_output_loads;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1005</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1007</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1008</span>: <span class="sd">--------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1009</span>: <span class="sd">--------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1010</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1012</span>: <span class="sd">                                    STRUCTURES</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1013</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1014</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1015</span>: <span class="sd">--------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1016</span>: <span class="sd">--------------------------------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1017</span>: <span class="sd">From spatialbeam.py: Define the structural analysis component using spatial beam theory. &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1018</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1019</span>: </pre>
<pre class="cython line score-75" onclick='toggleDiv(this)'>+<span class="">1020</span>: <span class="k">def</span> <span class="nf">struct</span><span class="p">(</span><span class="n">loads</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span></pre>
<pre class='cython code score-75 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_49struct(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_49struct = {"struct", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_49struct, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_49struct(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_loads = 0;
  PyObject *__pyx_v_params = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("struct (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_loads,&amp;__pyx_n_s_params,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_loads)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_params)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("struct", 1, 2, 2, 1); __PYX_ERR(0, 1020, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "struct") &lt; 0)) __PYX_ERR(0, 1020, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_loads = values[0];
    __pyx_v_params = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("struct", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 1020, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.struct", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_48struct(__pyx_self, __pyx_v_loads, __pyx_v_params);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_48struct(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_loads, PyObject *__pyx_v_params) {
  PyObject *__pyx_v_mesh = NULL;
  PyObject *__pyx_v_twist_cp = NULL;
  PyObject *__pyx_v_thickness_cp = NULL;
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_v_aero_ind = NULL;
  PyObject *__pyx_v_fem_ind = NULL;
  PyObject *__pyx_v_E = NULL;
  PyObject *__pyx_v_G = NULL;
  PyObject *__pyx_v_jac_twist = NULL;
  PyObject *__pyx_v_jac_thickness = NULL;
  PyObject *__pyx_v_fem_origin = NULL;
  PyObject *__pyx_v_cg_x = NULL;
  PyObject *__pyx_v_twist = NULL;
  PyObject *__pyx_v_thickness = NULL;
  PyObject *__pyx_v_A = NULL;
  PyObject *__pyx_v_Iy = NULL;
  PyObject *__pyx_v_Iz = NULL;
  PyObject *__pyx_v_J = NULL;
  PyObject *__pyx_v_nodes = NULL;
  PyObject *__pyx_v_disp_aug = NULL;
  PyObject *__pyx_v_disp = NULL;
  PyObject *__pyx_v_def_mesh = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("struct", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.struct", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mesh);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_twist_cp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_thickness_cp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fem_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_E);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_G);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_jac_twist);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_jac_thickness);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fem_origin);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cg_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_twist);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_thickness);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_A);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Iy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Iz);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_J);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nodes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_disp_aug);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_disp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_def_mesh);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__595 = <span class='py_c_api'>PyTuple_Pack</span>(24, __pyx_n_s_loads, __pyx_n_s_params, __pyx_n_s_mesh, __pyx_n_s_twist_cp, __pyx_n_s_thickness_cp, __pyx_n_s_r, __pyx_n_s_aero_ind, __pyx_n_s_fem_ind, __pyx_n_s_E, __pyx_n_s_G, __pyx_n_s_jac_twist, __pyx_n_s_jac_thickness, __pyx_n_s_fem_origin, __pyx_n_s_cg_x, __pyx_n_s_twist, __pyx_n_s_thickness, __pyx_n_s_A, __pyx_n_s_Iy, __pyx_n_s_Iz, __pyx_n_s_J, __pyx_n_s_nodes, __pyx_n_s_disp_aug, __pyx_n_s_disp, __pyx_n_s_def_mesh); if (unlikely(!__pyx_tuple__595)) __PYX_ERR(0, 1020, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__595);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__595);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_49struct, 0, __pyx_n_s_struct, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__596)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1020, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_struct, __pyx_t_2) &lt; 0) __PYX_ERR(0, 1020, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__596 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 24, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__595, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_struct, 1020, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__596)) __PYX_ERR(0, 1020, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">1021</span>:     <span class="c"># Unpack variables</span></pre>
<pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1022</span>:     <span class="n">mesh</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;mesh&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1022, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__397, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1022, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_mesh = __pyx_t_2;
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__397 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_mesh); if (unlikely(!__pyx_tuple__397)) __PYX_ERR(0, 1022, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__397);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__397);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1023</span>:     <span class="n">twist_cp</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;twist_cp&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1023, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__398, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1023, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_twist_cp = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__398 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_twist_cp); if (unlikely(!__pyx_tuple__398)) __PYX_ERR(0, 1023, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__398);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__398);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1024</span>:     <span class="n">thickness_cp</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;thickness_cp&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1024, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__399, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1024, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_thickness_cp = __pyx_t_2;
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__399 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_thickness_cp); if (unlikely(!__pyx_tuple__399)) __PYX_ERR(0, 1024, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__399);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__399);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1025</span>:     <span class="n">r</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;r&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1025, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__400, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1025, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_r = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__400 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_r); if (unlikely(!__pyx_tuple__400)) __PYX_ERR(0, 1025, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__400);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__400);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1026</span>:     <span class="n">aero_ind</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;aero_ind&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1026, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__401, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1026, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_aero_ind = __pyx_t_2;
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__401 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_aero_ind); if (unlikely(!__pyx_tuple__401)) __PYX_ERR(0, 1026, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__401);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__401);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1027</span>:     <span class="n">fem_ind</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;fem_ind&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1027, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__402, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1027, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_fem_ind = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__402 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_fem_ind); if (unlikely(!__pyx_tuple__402)) __PYX_ERR(0, 1027, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__402);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__402);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1028</span>:     <span class="n">E</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;E&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1028, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__403, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1028, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_E = __pyx_t_2;
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__403 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_E); if (unlikely(!__pyx_tuple__403)) __PYX_ERR(0, 1028, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__403);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__403);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1029</span>:     <span class="n">G</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;G&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1029, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__404, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1029, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_G = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__404 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_G); if (unlikely(!__pyx_tuple__404)) __PYX_ERR(0, 1029, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__404);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__404);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1030</span>:     <span class="n">jac_twist</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;jac_twist&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1030, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__405, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1030, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_jac_twist = __pyx_t_2;
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__405 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_jac_twist); if (unlikely(!__pyx_tuple__405)) __PYX_ERR(0, 1030, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__405);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__405);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1031</span>:     <span class="n">jac_thickness</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;jac_thickness&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__406, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1031, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_jac_thickness = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__406 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_jac_thickness); if (unlikely(!__pyx_tuple__406)) __PYX_ERR(0, 1031, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__406);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__406);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1032</span>:     <span class="n">fem_origin</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;fem_origin&#39;</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1032, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__407, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1032, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_fem_origin = __pyx_t_2;
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__407 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_fem_origin, __pyx_float_0_35); if (unlikely(!__pyx_tuple__407)) __PYX_ERR(0, 1032, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__407);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__407);
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1033</span>:     <span class="n">cg_x</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;cg_x&#39;</span><span class="p">,</span> <span class="mf">5</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_params, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1033, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__408, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1033, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_cg_x = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__408 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_cg_x, __pyx_int_5); if (unlikely(!__pyx_tuple__408)) __PYX_ERR(0, 1033, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__408);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__408);
</pre><pre class="cython line score-0">&#xA0;<span class="">1034</span>: </pre>
<pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">1035</span>:     <span class="n">twist</span> <span class="o">=</span> <span class="n">cp2pt</span><span class="p">(</span><span class="n">twist_cp</span><span class="p">,</span> <span class="n">jac_twist</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_cp2pt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1035, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1035, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_twist_cp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_twist_cp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_twist_cp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_jac_twist);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_jac_twist);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_jac_twist);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1035, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_twist = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">1036</span>:     <span class="n">thickness</span> <span class="o">=</span> <span class="n">cp2pt</span><span class="p">(</span><span class="n">thickness_cp</span><span class="p">,</span> <span class="n">jac_thickness</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_cp2pt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1036, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1036, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_5) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_thickness_cp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_thickness_cp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_4, __pyx_v_thickness_cp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_jac_thickness);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_jac_thickness);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_4, __pyx_v_jac_thickness);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1036, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_thickness = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1037</span>:     <span class="n">geometry_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">twist</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_geometry_mesh); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1037, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1037, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_twist);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_twist);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_4, __pyx_v_twist);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1037, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-80" onclick='toggleDiv(this)'>+<span class="">1038</span>:     <span class="n">A</span><span class="p">,</span> <span class="n">Iy</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="n">materials_tube</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">)</span></pre>
<pre class='cython code score-80 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_materials_tube); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1038, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1038, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_5) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_4, __pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_thickness);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_thickness);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_4, __pyx_v_thickness);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fem_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2+__pyx_t_4, __pyx_v_fem_ind);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1038, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 4)) {
      if (size &gt; 4) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(4);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 1038, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&amp;__pyx_t_2,&amp;__pyx_t_3,&amp;__pyx_t_5,&amp;__pyx_t_6};
      for (i=0; i &lt; 4; i++) {
        PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 1038, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[i]) = item;
      }
    }
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&amp;__pyx_t_2,&amp;__pyx_t_3,&amp;__pyx_t_5,&amp;__pyx_t_6};
    __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1038, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_8 = Py_TYPE(__pyx_t_7)-&gt;tp_iternext;
    for (index=0; index &lt; 4; index++) {
      PyObject* item = __pyx_t_8(__pyx_t_7); if (unlikely(!item)) goto __pyx_L3_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(item);
      *(temps[index]) = item;
    }
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_7), 4) &lt; 0) __PYX_ERR(0, 1038, __pyx_L1_error)
    __pyx_t_8 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 1038, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_A = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_Iy = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_Iz = __pyx_t_5;
  __pyx_t_5 = 0;
  __pyx_v_J = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1039</span>:     <span class="n">nodes</span> <span class="o">=</span> <span class="n">compute_nodes</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_origin</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_compute_nodes); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1039, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1039, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_5) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_4, __pyx_v_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fem_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_4, __pyx_v_fem_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2+__pyx_t_4, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_origin);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fem_origin);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3+__pyx_t_4, __pyx_v_fem_origin);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1039, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_nodes = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">1040</span>:     <span class="n">disp_aug</span> <span class="o">=</span> <span class="n">spatial_beam_FEM</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">Iy</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">cg_x</span><span class="p">)</span></pre>
<pre class='cython code score-44 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_spatial_beam_FEM); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1040, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(11+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1040, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_A);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_A);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_A);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Iy);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Iy);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_Iy);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Iz);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Iz);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_4, __pyx_v_Iz);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_J);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_J);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 3+__pyx_t_4, __pyx_v_J);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nodes);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nodes);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 4+__pyx_t_4, __pyx_v_nodes);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_loads);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_loads);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 5+__pyx_t_4, __pyx_v_loads);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 6+__pyx_t_4, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fem_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 7+__pyx_t_4, __pyx_v_fem_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_E);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 8+__pyx_t_4, __pyx_v_E);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_G);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_G);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 9+__pyx_t_4, __pyx_v_G);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cg_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cg_x);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 10+__pyx_t_4, __pyx_v_cg_x);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1040, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_disp_aug = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">1041</span>:     <span class="n">disp</span> <span class="o">=</span> <span class="n">spatial_beam_disp</span><span class="p">(</span><span class="n">disp_aug</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_spatial_beam_disp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1041, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1041, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (__pyx_t_5) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_disp_aug);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_disp_aug);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_4, __pyx_v_disp_aug);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fem_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_4, __pyx_v_fem_ind);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1041, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_disp = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1042</span>:     <span class="n">def_mesh</span> <span class="o">=</span> <span class="n">transfer_displacements</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">disp</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">,</span> <span class="n">fem_origin</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_transfer_displacements); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1042, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_4 = 1;
    }
  }
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(5+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1042, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mesh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mesh);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_mesh);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_disp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_disp);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_disp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_4, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fem_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 3+__pyx_t_4, __pyx_v_fem_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_origin);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fem_origin);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 4+__pyx_t_4, __pyx_v_fem_origin);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1042, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_def_mesh = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1043</span>: </pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1044</span>:     <span class="k">return</span> <span class="n">def_mesh</span>  <span class="c"># Output the def_mesh matrix</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_def_mesh);
  __pyx_r = __pyx_v_def_mesh;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1045</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1046</span>: </pre>
<pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">1047</span>: <span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="n">vec</span><span class="p">):</span></pre>
<pre class='cython code score-24 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_51norm(PyObject *__pyx_self, PyObject *__pyx_v_vec); /*proto*/
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_51norm = {"norm", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_51norm, METH_O, 0};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_51norm(PyObject *__pyx_self, PyObject *__pyx_v_vec) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("norm (wrapper)", 0);
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_50norm(__pyx_self, ((PyObject *)__pyx_v_vec));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_50norm(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vec) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("norm", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.norm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__597 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_vec); if (unlikely(!__pyx_tuple__597)) __PYX_ERR(0, 1047, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__597);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__597);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_51norm, 0, __pyx_n_s_norm, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__598)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1047, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_norm, __pyx_t_2) &lt; 0) __PYX_ERR(0, 1047, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__598 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__597, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_norm, 1047, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__598)) __PYX_ERR(0, 1047, __pyx_L1_error)
</pre><pre class="cython line score-64" onclick='toggleDiv(this)'>+<span class="">1048</span>:     <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vec</span><span class="o">**</span><span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-64 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1048, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1048, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1048, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1048, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_vec, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1048, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1048, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1048, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6); __pyx_t_6 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_7, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1048, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1048, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1048, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1048, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1049</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1050</span>: </pre>
<pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">1051</span>: <span class="k">def</span> <span class="nf">unit</span><span class="p">(</span><span class="n">vec</span><span class="p">):</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_53unit(PyObject *__pyx_self, PyObject *__pyx_v_vec); /*proto*/
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_53unit = {"unit", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_53unit, METH_O, 0};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_53unit(PyObject *__pyx_self, PyObject *__pyx_v_vec) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("unit (wrapper)", 0);
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_52unit(__pyx_self, ((PyObject *)__pyx_v_vec));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_52unit(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_vec) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("unit", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.unit", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__599 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_vec); if (unlikely(!__pyx_tuple__599)) __PYX_ERR(0, 1051, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__599);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__599);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_53unit, 0, __pyx_n_s_unit, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__600)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1051, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_unit, __pyx_t_2) &lt; 0) __PYX_ERR(0, 1051, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__600 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__599, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_unit, 1051, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__600)) __PYX_ERR(0, 1051, __pyx_L1_error)
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1052</span>:     <span class="k">return</span> <span class="n">vec</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_norm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1052, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_vec); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1052, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1052, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vec);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vec);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_vec);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1052, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_vec, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1052, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1053</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1054</span>: </pre>
<pre class="cython line score-60" onclick='toggleDiv(this)'>+<span class="">1055</span>: <span class="k">def</span> <span class="nf">radii</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">t_c</span><span class="o">=</span><span class="mf">0.15</span><span class="p">):</span></pre>
<pre class='cython code score-60 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_55radii(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_54radii[] = " Obtain the radii of the FEM component based on chord. ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_55radii = {"radii", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_55radii, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_54radii};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_55radii(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mesh = 0;
  PyObject *__pyx_v_t_c = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("radii (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mesh,&amp;__pyx_n_s_t_c,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)((PyObject*)__pyx_float_0_15));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_t_c);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "radii") &lt; 0)) __PYX_ERR(0, 1055, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_mesh = values[0];
    __pyx_v_t_c = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("radii", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 1055, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.radii", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_54radii(__pyx_self, __pyx_v_mesh, __pyx_v_t_c);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_54radii(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mesh, PyObject *__pyx_v_t_c) {
  PyObject *__pyx_v_vectors = NULL;
  PyObject *__pyx_v_chords = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("radii", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.radii", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vectors);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_chords);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__601 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_mesh, __pyx_n_s_t_c, __pyx_n_s_vectors, __pyx_n_s_chords); if (unlikely(!__pyx_tuple__601)) __PYX_ERR(0, 1055, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__601);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__601);
  __pyx_codeobj__602 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 4, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__601, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_radii, 1055, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__602)) __PYX_ERR(0, 1055, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_55radii, 0, __pyx_n_s_radii, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__602)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1055, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__603);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_radii, __pyx_t_2) &lt; 0) __PYX_ERR(0, 1055, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__603 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject*)__pyx_float_0_15)); if (unlikely(!__pyx_tuple__603)) __PYX_ERR(0, 1055, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__603);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__603);
</pre><pre class="cython line score-0">&#xA0;<span class="">1056</span>:     <span class="sd">&quot;&quot;&quot; Obtain the radii of the FEM component based on chord. &quot;&quot;&quot;</span></pre>
<pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">1057</span>:     <span class="n">vectors</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">mesh</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span></pre>
<pre class='cython code score-47 '>  __pyx_slice__409 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__409)) __PYX_ERR(0, 1057, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__409);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__409);
  __pyx_slice__410 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__410)) __PYX_ERR(0, 1057, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__410);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__410);
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__411); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1057, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_tuple__411 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_neg_1, __pyx_slice__409, __pyx_slice__410); if (unlikely(!__pyx_tuple__411)) __PYX_ERR(0, 1057, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__411);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__411);
  __pyx_slice__412 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__412)) __PYX_ERR(0, 1057, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__412);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__412);
  __pyx_slice__413 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__413)) __PYX_ERR(0, 1057, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__413);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__413);
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_tuple__414); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1057, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_vectors = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_tuple__414 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_slice__412, __pyx_slice__413); if (unlikely(!__pyx_tuple__414)) __PYX_ERR(0, 1057, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__414);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__414);
</pre><pre class="cython line score-60" onclick='toggleDiv(this)'>+<span class="">1058</span>:     <span class="n">chords</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vectors</span><span class="o">**</span><span class="mf">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-60 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1058, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1058, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1058, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_vectors, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1058, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1058, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1058, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_1) &lt; 0) __PYX_ERR(0, 1058, __pyx_L1_error)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1058, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1058, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1058, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1058, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_chords = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">1059</span>:     <span class="n">chords</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">chords</span><span class="p">[:</span> <span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">chords</span><span class="p">[</span><span class="mf">1</span><span class="p">:]</span></pre>
<pre class='cython code score-34 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_chords, 0, -1L, NULL, NULL, &amp;__pyx_slice__415, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1059, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1059, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__415 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__415)) __PYX_ERR(0, 1059, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__415);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__415);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_chords, 1, 0, NULL, NULL, &amp;__pyx_slice__416, 1, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1059, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1059, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1059, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_chords, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_slice__416 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None); if (unlikely(!__pyx_slice__416)) __PYX_ERR(0, 1059, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__416);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__416);
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">1060</span>:     <span class="k">return</span> <span class="n">t_c</span> <span class="o">*</span> <span class="n">chords</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_t_c, __pyx_v_chords); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1060, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1061</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1062</span>: </pre>
<pre class="cython line score-373" onclick='toggleDiv(this)'>+<span class="">1063</span>: <span class="k">def</span> <span class="nf">assemble_FEM_system</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">Iy</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span></pre>
<pre class='cython code score-373 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_57assemble_FEM_system(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_56assemble_FEM_system[] = "\n    Assemble the structural stiffness matrix based on 6 degrees of freedom\n    per element.\n\n    Can be run in dense Fortran, Sparse Fortran, or dense\n    Python code depending on the flags used. Currently, dense Fortran\n    seems to be the fastest version across many matrix sizes.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_57assemble_FEM_system = {"assemble_FEM_system", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_57assemble_FEM_system, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_56assemble_FEM_system};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_57assemble_FEM_system(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_aero_ind = 0;
  PyObject *__pyx_v_fem_ind = 0;
  PyObject *__pyx_v_nodes = 0;
  PyObject *__pyx_v_A = 0;
  PyObject *__pyx_v_J = 0;
  PyObject *__pyx_v_Iy = 0;
  PyObject *__pyx_v_Iz = 0;
  PyObject *__pyx_v_loads = 0;
  PyObject *__pyx_v_K_a = 0;
  PyObject *__pyx_v_K_t = 0;
  PyObject *__pyx_v_K_y = 0;
  PyObject *__pyx_v_K_z = 0;
  PyObject *__pyx_v_elem_IDs = 0;
  PyObject *__pyx_v_cons = 0;
  PyObject *__pyx_v_E = 0;
  PyObject *__pyx_v_G = 0;
  PyObject *__pyx_v_x_gl = 0;
  PyObject *__pyx_v_T = 0;
  PyObject *__pyx_v_K_elem = 0;
  PyObject *__pyx_v_S_a = 0;
  PyObject *__pyx_v_S_t = 0;
  PyObject *__pyx_v_S_y = 0;
  PyObject *__pyx_v_S_z = 0;
  PyObject *__pyx_v_T_elem = 0;
  PyObject *__pyx_v_const2 = 0;
  PyObject *__pyx_v_const_y = 0;
  PyObject *__pyx_v_const_z = 0;
  CYTHON_UNUSED PyObject *__pyx_v_n = 0;
  PyObject *__pyx_v_size = 0;
  PyObject *__pyx_v_mtx = 0;
  PyObject *__pyx_v_rhs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assemble_FEM_system (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_aero_ind,&amp;__pyx_n_s_fem_ind,&amp;__pyx_n_s_nodes,&amp;__pyx_n_s_A,&amp;__pyx_n_s_J,&amp;__pyx_n_s_Iy,&amp;__pyx_n_s_Iz,&amp;__pyx_n_s_loads,&amp;__pyx_n_s_K_a,&amp;__pyx_n_s_K_t,&amp;__pyx_n_s_K_y,&amp;__pyx_n_s_K_z,&amp;__pyx_n_s_elem_IDs,&amp;__pyx_n_s_cons,&amp;__pyx_n_s_E,&amp;__pyx_n_s_G,&amp;__pyx_n_s_x_gl,&amp;__pyx_n_s_T,&amp;__pyx_n_s_K_elem,&amp;__pyx_n_s_S_a,&amp;__pyx_n_s_S_t,&amp;__pyx_n_s_S_y,&amp;__pyx_n_s_S_z,&amp;__pyx_n_s_T_elem,&amp;__pyx_n_s_const2,&amp;__pyx_n_s_const_y,&amp;__pyx_n_s_const_z,&amp;__pyx_n_s_n,&amp;__pyx_n_s_size,&amp;__pyx_n_s_mtx,&amp;__pyx_n_s_rhs,0};
    PyObject* values[31] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 31: values[30] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 30);
        case 30: values[29] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 29);
        case 29: values[28] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 28);
        case 28: values[27] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 27);
        case 27: values[26] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 26);
        case 26: values[25] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 25);
        case 25: values[24] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 24);
        case 24: values[23] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 23);
        case 23: values[22] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 22);
        case 22: values[21] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 21);
        case 21: values[20] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 20);
        case 20: values[19] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 19);
        case 19: values[18] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 18);
        case 18: values[17] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 17);
        case 17: values[16] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 16);
        case 16: values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
        case 15: values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
        case 14: values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aero_ind)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_fem_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 1); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_nodes)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 2); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_A)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 3); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_J)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 4); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Iy)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 5); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Iz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 6); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case  7:
        if (likely((values[7] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_loads)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 7); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case  8:
        if (likely((values[8] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_K_a)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 8); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case  9:
        if (likely((values[9] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_K_t)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 9); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 10:
        if (likely((values[10] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_K_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 10); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 11:
        if (likely((values[11] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_K_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 11); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 12:
        if (likely((values[12] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_elem_IDs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 12); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 13:
        if (likely((values[13] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cons)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 13); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 14:
        if (likely((values[14] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_E)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 14); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 15:
        if (likely((values[15] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_G)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 15); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 16:
        if (likely((values[16] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_x_gl)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 16); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 17:
        if (likely((values[17] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_T)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 17); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 18:
        if (likely((values[18] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_K_elem)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 18); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 19:
        if (likely((values[19] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_S_a)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 19); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 20:
        if (likely((values[20] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_S_t)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 20); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 21:
        if (likely((values[21] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_S_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 21); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 22:
        if (likely((values[22] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_S_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 22); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 23:
        if (likely((values[23] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_T_elem)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 23); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 24:
        if (likely((values[24] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_const2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 24); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 25:
        if (likely((values[25] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_const_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 25); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 26:
        if (likely((values[26] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_const_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 26); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 27:
        if (likely((values[27] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_n)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 27); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 28:
        if (likely((values[28] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_size)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 28); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 29:
        if (likely((values[29] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mtx)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 29); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
        case 30:
        if (likely((values[30] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_rhs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, 30); __PYX_ERR(0, 1063, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "assemble_FEM_system") &lt; 0)) __PYX_ERR(0, 1063, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 31) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
      values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
      values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
      values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
      values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
      values[16] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 16);
      values[17] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 17);
      values[18] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 18);
      values[19] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 19);
      values[20] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 20);
      values[21] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 21);
      values[22] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 22);
      values[23] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 23);
      values[24] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 24);
      values[25] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 25);
      values[26] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 26);
      values[27] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 27);
      values[28] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 28);
      values[29] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 29);
      values[30] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 30);
    }
    __pyx_v_aero_ind = values[0];
    __pyx_v_fem_ind = values[1];
    __pyx_v_nodes = values[2];
    __pyx_v_A = values[3];
    __pyx_v_J = values[4];
    __pyx_v_Iy = values[5];
    __pyx_v_Iz = values[6];
    __pyx_v_loads = values[7];
    __pyx_v_K_a = values[8];
    __pyx_v_K_t = values[9];
    __pyx_v_K_y = values[10];
    __pyx_v_K_z = values[11];
    __pyx_v_elem_IDs = values[12];
    __pyx_v_cons = values[13];
    __pyx_v_E = values[14];
    __pyx_v_G = values[15];
    __pyx_v_x_gl = values[16];
    __pyx_v_T = values[17];
    __pyx_v_K_elem = values[18];
    __pyx_v_S_a = values[19];
    __pyx_v_S_t = values[20];
    __pyx_v_S_y = values[21];
    __pyx_v_S_z = values[22];
    __pyx_v_T_elem = values[23];
    __pyx_v_const2 = values[24];
    __pyx_v_const_y = values[25];
    __pyx_v_const_z = values[26];
    __pyx_v_n = values[27];
    __pyx_v_size = values[28];
    __pyx_v_mtx = values[29];
    __pyx_v_rhs = values[30];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assemble_FEM_system", 1, 31, 31, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 1063, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.assemble_FEM_system", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_56assemble_FEM_system(__pyx_self, __pyx_v_aero_ind, __pyx_v_fem_ind, __pyx_v_nodes, __pyx_v_A, __pyx_v_J, __pyx_v_Iy, __pyx_v_Iz, __pyx_v_loads, __pyx_v_K_a, __pyx_v_K_t, __pyx_v_K_y, __pyx_v_K_z, __pyx_v_elem_IDs, __pyx_v_cons, __pyx_v_E, __pyx_v_G, __pyx_v_x_gl, __pyx_v_T, __pyx_v_K_elem, __pyx_v_S_a, __pyx_v_S_t, __pyx_v_S_y, __pyx_v_S_z, __pyx_v_T_elem, __pyx_v_const2, __pyx_v_const_y, __pyx_v_const_z, __pyx_v_n, __pyx_v_size, __pyx_v_mtx, __pyx_v_rhs);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_56assemble_FEM_system(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_aero_ind, PyObject *__pyx_v_fem_ind, PyObject *__pyx_v_nodes, PyObject *__pyx_v_A, PyObject *__pyx_v_J, PyObject *__pyx_v_Iy, PyObject *__pyx_v_Iz, PyObject *__pyx_v_loads, PyObject *__pyx_v_K_a, PyObject *__pyx_v_K_t, PyObject *__pyx_v_K_y, PyObject *__pyx_v_K_z, PyObject *__pyx_v_elem_IDs, PyObject *__pyx_v_cons, PyObject *__pyx_v_E, PyObject *__pyx_v_G, PyObject *__pyx_v_x_gl, PyObject *__pyx_v_T, PyObject *__pyx_v_K_elem, PyObject *__pyx_v_S_a, PyObject *__pyx_v_S_t, PyObject *__pyx_v_S_y, PyObject *__pyx_v_S_z, PyObject *__pyx_v_T_elem, PyObject *__pyx_v_const2, PyObject *__pyx_v_const_y, PyObject *__pyx_v_const_z, CYTHON_UNUSED PyObject *__pyx_v_n, PyObject *__pyx_v_size, PyObject *__pyx_v_mtx, PyObject *__pyx_v_rhs) {
  PyObject *__pyx_v_data_list = NULL;
  PyObject *__pyx_v_rows_list = NULL;
  PyObject *__pyx_v_cols_list = NULL;
  PyObject *__pyx_v_num_surf = NULL;
  PyObject *__pyx_v_tot_n_fem = NULL;
  PyObject *__pyx_v_i_surf = NULL;
  PyObject *__pyx_v_row = NULL;
  PyObject *__pyx_v_n_fem = NULL;
  PyObject *__pyx_v_i_fem = NULL;
  PyObject *__pyx_v_num_cons = NULL;
  PyObject *__pyx_v_size_ = NULL;
  PyObject *__pyx_v_mtx_ = NULL;
  PyObject *__pyx_v_rhs_ = NULL;
  PyObject *__pyx_v_A_ = NULL;
  PyObject *__pyx_v_J_ = NULL;
  PyObject *__pyx_v_Iy_ = NULL;
  PyObject *__pyx_v_Iz_ = NULL;
  PyObject *__pyx_v_elem_IDs_ = NULL;
  PyObject *__pyx_v_loads_ = NULL;
  PyObject *__pyx_v_num_elems = NULL;
  PyObject *__pyx_v_E_vec = NULL;
  PyObject *__pyx_v_G_vec = NULL;
  PyObject *__pyx_v_nnz = NULL;
  PyObject *__pyx_v_data1 = NULL;
  PyObject *__pyx_v_rows1 = NULL;
  PyObject *__pyx_v_cols1 = NULL;
  PyObject *__pyx_v_data2 = NULL;
  PyObject *__pyx_v_rows2 = NULL;
  PyObject *__pyx_v_cols2 = NULL;
  PyObject *__pyx_v_ind = NULL;
  PyObject *__pyx_v_data = NULL;
  PyObject *__pyx_v_rows = NULL;
  PyObject *__pyx_v_cols = NULL;
  PyObject *__pyx_v_num_nodes = NULL;
  PyObject *__pyx_v_ielem = NULL;
  PyObject *__pyx_v_P0 = NULL;
  PyObject *__pyx_v_P1 = NULL;
  PyObject *__pyx_v_x_loc = NULL;
  PyObject *__pyx_v_y_loc = NULL;
  PyObject *__pyx_v_z_loc = NULL;
  PyObject *__pyx_v_L = NULL;
  PyObject *__pyx_v_EA_L = NULL;
  PyObject *__pyx_v_GJ_L = NULL;
  PyObject *__pyx_v_EIy_L3 = NULL;
  PyObject *__pyx_v_EIz_L3 = NULL;
  PyObject *__pyx_v_res = NULL;
  PyObject *__pyx_v_in0 = NULL;
  PyObject *__pyx_v_in1 = NULL;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assemble_FEM_system", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_elem);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_size);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mtx);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.assemble_FEM_system", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rows_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cols_list);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_cons);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_size_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtx_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rhs_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_A_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_J_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Iy_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Iz_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_elem_IDs_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_loads_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_elems);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_E_vec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_G_vec);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nnz);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rows1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cols1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rows2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cols2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rows);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cols);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_nodes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ielem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_P0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_P1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_loc);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_loc);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z_loc);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_L);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_EA_L);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_GJ_L);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_EIy_L3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_EIz_L3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_res);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_in0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_in1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_K_elem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_size);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtx);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__604 = <span class='py_c_api'>PyTuple_Pack</span>(80, __pyx_n_s_aero_ind, __pyx_n_s_fem_ind, __pyx_n_s_nodes, __pyx_n_s_A, __pyx_n_s_J, __pyx_n_s_Iy, __pyx_n_s_Iz, __pyx_n_s_loads, __pyx_n_s_K_a, __pyx_n_s_K_t, __pyx_n_s_K_y, __pyx_n_s_K_z, __pyx_n_s_elem_IDs, __pyx_n_s_cons, __pyx_n_s_E, __pyx_n_s_G, __pyx_n_s_x_gl, __pyx_n_s_T, __pyx_n_s_K_elem, __pyx_n_s_S_a, __pyx_n_s_S_t, __pyx_n_s_S_y, __pyx_n_s_S_z, __pyx_n_s_T_elem, __pyx_n_s_const2, __pyx_n_s_const_y, __pyx_n_s_const_z, __pyx_n_s_n, __pyx_n_s_size, __pyx_n_s_mtx, __pyx_n_s_rhs, __pyx_n_s_data_list, __pyx_n_s_rows_list, __pyx_n_s_cols_list, __pyx_n_s_num_surf, __pyx_n_s_tot_n_fem, __pyx_n_s_i_surf, __pyx_n_s_row, __pyx_n_s_n_fem, __pyx_n_s_i_fem, __pyx_n_s_num_cons, __pyx_n_s_size_2, __pyx_n_s_mtx_2, __pyx_n_s_rhs_2, __pyx_n_s_A_2, __pyx_n_s_J_2, __pyx_n_s_Iy_2, __pyx_n_s_Iz_2, __pyx_n_s_elem_IDs_2, __pyx_n_s_loads_2, __pyx_n_s_num_elems, __pyx_n_s_E_vec, __pyx_n_s_G_vec, __pyx_n_s_nnz, __pyx_n_s_data1, __pyx_n_s_rows1, __pyx_n_s_cols1, __pyx_n_s_data2, __pyx_n_s_rows2, __pyx_n_s_cols2, __pyx_n_s_ind, __pyx_n_s_data, __pyx_n_s_rows, __pyx_n_s_cols, __pyx_n_s_num_nodes, __pyx_n_s_ielem, __pyx_n_s_P0, __pyx_n_s_P1, __pyx_n_s_x_loc, __pyx_n_s_y_loc, __pyx_n_s_z_loc, __pyx_n_s_L, __pyx_n_s_EA_L, __pyx_n_s_GJ_L, __pyx_n_s_EIy_L3, __pyx_n_s_EIz_L3, __pyx_n_s_res, __pyx_n_s_in0, __pyx_n_s_in1, __pyx_n_s_k); if (unlikely(!__pyx_tuple__604)) __PYX_ERR(0, 1063, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__604);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__604);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_57assemble_FEM_system, 0, __pyx_n_s_assemble_FEM_system, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__605)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1063, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_assemble_FEM_system, __pyx_t_2) &lt; 0) __PYX_ERR(0, 1063, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__605 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(31, 0, 80, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__604, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_assemble_FEM_system, 1063, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__605)) __PYX_ERR(0, 1063, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">1064</span>:                         <span class="n">K_a</span><span class="p">,</span> <span class="n">K_t</span><span class="p">,</span> <span class="n">K_y</span><span class="p">,</span> <span class="n">K_z</span><span class="p">,</span> <span class="n">elem_IDs</span><span class="p">,</span> <span class="n">cons</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">x_gl</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1065</span>:                         <span class="n">K_elem</span><span class="p">,</span> <span class="n">S_a</span><span class="p">,</span> <span class="n">S_t</span><span class="p">,</span> <span class="n">S_y</span><span class="p">,</span> <span class="n">S_z</span><span class="p">,</span> <span class="n">T_elem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1066</span>:                         <span class="n">const2</span><span class="p">,</span> <span class="n">const_y</span><span class="p">,</span> <span class="n">const_z</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">mtx</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1067</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1068</span>: <span class="sd">    Assemble the structural stiffness matrix based on 6 degrees of freedom</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1069</span>: <span class="sd">    per element.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1070</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1071</span>: <span class="sd">    Can be run in dense Fortran, Sparse Fortran, or dense</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1072</span>: <span class="sd">    Python code depending on the flags used. Currently, dense Fortran</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1073</span>: <span class="sd">    seems to be the fastest version across many matrix sizes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1074</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1075</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1076</span>:     <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1076, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_data_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1077</span>:     <span class="n">rows_list</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_rows_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1078</span>:     <span class="n">cols_list</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1078, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_cols_list = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1079</span>:     <span class="n">num_surf</span> <span class="o">=</span> <span class="n">fem_ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_fem_ind, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1079, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1079, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_num_surf = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">1080</span>:     <span class="n">tot_n_fem</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1080, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__417 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__417)) __PYX_ERR(0, 1080, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__417);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__417);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fem_ind, __pyx_tuple__418); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1080, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1080, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1080, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_tot_n_fem = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_tuple__418 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__417, __pyx_int_0); if (unlikely(!__pyx_tuple__418)) __PYX_ERR(0, 1080, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__418);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__418);
</pre><pre class="cython line score-18" onclick='toggleDiv(this)'>+<span class="">1081</span>:     <span class="n">size</span> <span class="o">=</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">tot_n_fem</span> <span class="o">+</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">num_surf</span></pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_tot_n_fem); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1081, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_num_surf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1081, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1081, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_size, __pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">1082</span>:     <span class="k">for</span> <span class="n">i_surf</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_5 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_fem_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_fem_ind)) {
    __pyx_t_3 = __pyx_v_fem_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_fem_ind); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1082, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1082, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1082, __pyx_L1_error)
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1082, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1082, __pyx_L1_error)
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1082, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_7(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 1082, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_surf, __pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_5, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1082, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5);
    __pyx_t_5 = __pyx_t_2;
    __pyx_t_2 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">1083</span>:         <span class="n">n_fem</span><span class="p">,</span> <span class="n">i_fem</span> <span class="o">=</span> <span class="n">row</span></pre>
<pre class='cython code score-47 '>    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_row))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_row))) {
      PyObject* sequence = __pyx_v_row;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 1083, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1083, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1083, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      #endif
    } else {
      Py_ssize_t index = -1;
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_row); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1083, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_8 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
      index = 0; __pyx_t_2 = __pyx_t_8(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      index = 1; __pyx_t_1 = __pyx_t_8(__pyx_t_4); if (unlikely(!__pyx_t_1)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_4), 2) &lt; 0) __PYX_ERR(0, 1083, __pyx_L1_error)
      __pyx_t_8 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_8 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 1083, __pyx_L1_error)
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_fem, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_fem, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1084</span>:         <span class="c"># create truncated versions of the input arrays to assemble</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1085</span>:         <span class="c"># smaller matrices that we later assemble into a full matrix</span></pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1086</span>:         <span class="n">num_cons</span> <span class="o">=</span> <span class="mf">1</span>  <span class="c"># just one constraint per structural component</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_num_cons, __pyx_int_1);
</pre><pre class="cython line score-12" onclick='toggleDiv(this)'>+<span class="">1087</span>:         <span class="n">size_</span> <span class="o">=</span> <span class="mf">6</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_fem</span> <span class="o">+</span> <span class="n">num_cons</span><span class="p">)</span></pre>
<pre class='cython code score-12 '>    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_n_fem, __pyx_v_num_cons); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1087, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_size_, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-39" onclick='toggleDiv(this)'>+<span class="">1088</span>:         <span class="n">mtx_</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size_</span><span class="p">,</span> <span class="n">size_</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1088, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1088, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1088, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_size_);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_size_);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_size_);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_size_);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_size_);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_size_);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1088, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1088, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1088, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_9) &lt; 0) __PYX_ERR(0, 1088, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1088, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_mtx_, __pyx_t_9);
    __pyx_t_9 = 0;
</pre><pre class="cython line score-31" onclick='toggleDiv(this)'>+<span class="">1089</span>:         <span class="n">rhs_</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size_</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1089, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1089, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1089, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_size_);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_size_);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_size_);
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1089, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) __PYX_ERR(0, 1089, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rhs_, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">1090</span>:         <span class="n">A_</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span><span class="p">:</span> <span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>    __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1090, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1090, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_v_n_fem); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1090, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_9, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1090, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_A, 0, 0, &amp;__pyx_t_1, &amp;__pyx_t_4, NULL, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1090, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_A_, __pyx_t_9);
    __pyx_t_9 = 0;
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">1091</span>:         <span class="n">J_</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span><span class="p">:</span> <span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>    __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1091, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1091, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_v_n_fem); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1091, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1091, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_J, 0, 0, &amp;__pyx_t_9, &amp;__pyx_t_4, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1091, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_J_, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">1092</span>:         <span class="n">Iy_</span> <span class="o">=</span> <span class="n">Iy</span><span class="p">[</span><span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span><span class="p">:</span> <span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>    __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1092, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_v_n_fem); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1092, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_9, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1092, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_Iy, 0, 0, &amp;__pyx_t_1, &amp;__pyx_t_4, NULL, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1092, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_Iy_, __pyx_t_9);
    __pyx_t_9 = 0;
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">1093</span>:         <span class="n">Iz_</span> <span class="o">=</span> <span class="n">Iz</span><span class="p">[</span><span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span><span class="p">:</span> <span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>    __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1093, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1093, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_v_n_fem); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1093, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1093, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_Iz, 0, 0, &amp;__pyx_t_9, &amp;__pyx_t_4, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1093, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_Iz_, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-36" onclick='toggleDiv(this)'>+<span class="">1094</span>:         <span class="n">elem_IDs_</span> <span class="o">=</span> <span class="n">elem_IDs</span><span class="p">[</span><span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span><span class="p">:</span> <span class="n">i_fem</span> <span class="o">-</span></pre>
<pre class='cython code score-36 '>    __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1094, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1094, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
    __pyx_t_9 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_1, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1094, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1094, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__419);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__419);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_slice__419);
    __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_elem_IDs, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1094, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_slice__419 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__419)) __PYX_ERR(0, 1094, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__419);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__419);
</pre><pre class="cython line score-16" onclick='toggleDiv(this)'>+<span class="">1095</span>:                              <span class="n">i_surf</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">i_fem</span></pre>
<pre class='cython code score-16 '>    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_v_n_fem); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1095, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_9, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1095, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_9, __pyx_v_i_fem); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1095, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_elem_IDs_, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">1096</span>:         <span class="n">loads_</span> <span class="o">=</span> <span class="n">loads</span><span class="p">[</span><span class="n">i_fem</span><span class="p">:</span> <span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span><span class="p">]</span></pre>
<pre class='cython code score-9 '>    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1096, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_loads, 0, 0, &amp;__pyx_v_i_fem, &amp;__pyx_t_4, NULL, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1096, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_loads_, __pyx_t_9);
    __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1097</span>: </pre>
<pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">1098</span>:         <span class="n">num_elems</span> <span class="o">=</span> <span class="n">elem_IDs_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_elem_IDs_, __pyx_n_s_shape); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1098, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_9, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1098, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_num_elems, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-36" onclick='toggleDiv(this)'>+<span class="">1099</span>:         <span class="n">E_vec</span> <span class="o">=</span> <span class="n">E</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_elems</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1099, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_ones); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1099, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_9) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_num_elems); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1099, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else {
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1099, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9); __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_elems);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_elems);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_num_elems);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1099, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_E, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1099, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_E_vec, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-36" onclick='toggleDiv(this)'>+<span class="">1100</span>:         <span class="n">G_vec</span> <span class="o">=</span> <span class="n">G</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_elems</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1100, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_ones); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1100, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_num_elems); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1100, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_4); __pyx_t_4 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_elems);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_elems);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_num_elems);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_G, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1100, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_G_vec, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1101</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1102</span>:         <span class="c"># dense Fortran</span></pre>
<pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1103</span>:         <span class="k">if</span> <span class="n">fortran_flag</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">sparse_flag</span><span class="p">:</span></pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fortran_flag); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1103, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_11 &lt; 0)) __PYX_ERR(0, 1103, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_11) {
    } else {
      __pyx_t_10 = __pyx_t_11;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sparse_flag); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1103, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_11 &lt; 0)) __PYX_ERR(0, 1103, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_12 = ((!__pyx_t_11) != 0);
    __pyx_t_10 = __pyx_t_12;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_10) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1104</span>:             <span class="n">mtx_</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">assemblestructmtx</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">A_</span><span class="p">,</span> <span class="n">J_</span><span class="p">,</span> <span class="n">Iy_</span><span class="p">,</span> <span class="n">Iz_</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_lib); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1104, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_assemblestructmtx); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1104, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1105</span>:                                          <span class="n">K_a</span><span class="p">,</span> <span class="n">K_t</span><span class="p">,</span> <span class="n">K_y</span><span class="p">,</span> <span class="n">K_z</span><span class="p">,</span></pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">1106</span>:                                          <span class="n">elem_IDs_</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">cons</span><span class="p">[</span><span class="n">i_surf</span><span class="p">],</span></pre>
<pre class='cython code score-7 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_elem_IDs_, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1106, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_cons, __pyx_v_i_surf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1106, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-0">&#xA0;<span class="">1107</span>:                                          <span class="n">E_vec</span><span class="p">,</span> <span class="n">G_vec</span><span class="p">,</span> <span class="n">x_gl</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1108</span>:                                          <span class="n">K_elem</span><span class="p">,</span> <span class="n">S_a</span><span class="p">,</span> <span class="n">S_t</span><span class="p">,</span> <span class="n">S_y</span><span class="p">,</span> <span class="n">S_z</span><span class="p">,</span> <span class="n">T_elem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1109</span>:                                          <span class="n">const2</span><span class="p">,</span> <span class="n">const_y</span><span class="p">,</span> <span class="n">const_z</span><span class="p">,</span> <span class="n">n_fem</span><span class="p">,</span></pre>
<pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">1110</span>:                                          <span class="n">tot_n_fem</span><span class="p">,</span> <span class="n">size_</span><span class="p">)</span></pre>
<pre class='cython code score-73 '>      __pyx_t_13 = NULL;
      __pyx_t_14 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_13)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
          __pyx_t_14 = 1;
        }
      }
      __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(27+__pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1104, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      if (__pyx_t_13) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_13); __pyx_t_13 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nodes);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nodes);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+__pyx_t_14, __pyx_v_nodes);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_A_);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_A_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1+__pyx_t_14, __pyx_v_A_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_J_);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_J_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 2+__pyx_t_14, __pyx_v_J_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Iy_);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Iy_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 3+__pyx_t_14, __pyx_v_Iy_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Iz_);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Iz_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 4+__pyx_t_14, __pyx_v_Iz_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_a);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_a);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 5+__pyx_t_14, __pyx_v_K_a);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_t);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_t);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 6+__pyx_t_14, __pyx_v_K_t);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_y);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_y);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 7+__pyx_t_14, __pyx_v_K_y);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_z);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_z);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 8+__pyx_t_14, __pyx_v_K_z);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 9+__pyx_t_14, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 10+__pyx_t_14, __pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_vec);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_E_vec);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 11+__pyx_t_14, __pyx_v_E_vec);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_G_vec);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_G_vec);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 12+__pyx_t_14, __pyx_v_G_vec);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_gl);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_gl);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 13+__pyx_t_14, __pyx_v_x_gl);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_T);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_T);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 14+__pyx_t_14, __pyx_v_T);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_elem);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_elem);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 15+__pyx_t_14, __pyx_v_K_elem);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_a);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_a);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 16+__pyx_t_14, __pyx_v_S_a);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_t);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_t);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 17+__pyx_t_14, __pyx_v_S_t);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_y);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_y);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 18+__pyx_t_14, __pyx_v_S_y);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_z);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_z);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 19+__pyx_t_14, __pyx_v_S_z);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_T_elem);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_T_elem);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 20+__pyx_t_14, __pyx_v_T_elem);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_const2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_const2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 21+__pyx_t_14, __pyx_v_const2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_const_y);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_const_y);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 22+__pyx_t_14, __pyx_v_const_y);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_const_z);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_const_z);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 23+__pyx_t_14, __pyx_v_const_z);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n_fem);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n_fem);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 24+__pyx_t_14, __pyx_v_n_fem);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_n_fem);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_n_fem);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 25+__pyx_t_14, __pyx_v_tot_n_fem);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_size_);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_size_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 26+__pyx_t_14, __pyx_v_size_);
      __pyx_t_1 = 0;
      __pyx_t_4 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_15, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1104, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_mtx_, __pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">1111</span>:             <span class="n">mtx</span><span class="p">[(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6</span><span class="p">:</span> <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">+</span> <span class="n">num_cons</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6</span><span class="p">,</span></pre>
<pre class='cython code score-61 '>      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1111, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_int_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1111, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1111, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_v_num_cons); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1111, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_v_i_surf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1111, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_int_6); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1111, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_9, __pyx_t_15, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1111, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
/* … */
      __pyx_t_15 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_9, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1111, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1111, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_15);
      __pyx_t_2 = 0;
      __pyx_t_15 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mtx, __pyx_t_4, __pyx_v_mtx_) &lt; 0)) __PYX_ERR(0, 1111, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">1112</span>:                 <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6</span><span class="p">:</span> <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">+</span> <span class="n">num_cons</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtx_</span></pre>
<pre class='cython code score-34 '>      __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1112, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_15, __pyx_int_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1112, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1112, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_v_num_cons); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1112, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_v_i_surf); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1112, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_15, __pyx_int_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1112, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1113</span>: </pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">1114</span>:             <span class="n">rhs_</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-7 '>
      /* "OpenAeroStruct/aerostruct.py":1114
 *                 (i_fem + i_surf) * 6: (i_fem + n_fem + num_cons + i_surf) * 6] = mtx_
 * 
 *             rhs_[:] = 0.0             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             rhs_[: 6 * n_fem] = loads_.reshape((6 * n_fem))
 *             rhs[6 * (i_fem + i_surf): 6 *
 */
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_rhs_, __pyx_float_0_0, 0, 0, NULL, NULL, &amp;__pyx_slice__420, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1114, __pyx_L1_error)

  /* "OpenAeroStruct/aerostruct.py":1114
 *                 (i_fem + i_surf) * 6: (i_fem + n_fem + num_cons + i_surf) * 6] = mtx_
 * 
 *             rhs_[:] = 0.0             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             rhs_[: 6 * n_fem] = loads_.reshape((6 * n_fem))
 *             rhs[6 * (i_fem + i_surf): 6 *
 */
  __pyx_slice__420 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__420)) __PYX_ERR(0, 1114, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__420);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__420);
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">1115</span>:             <span class="n">rhs_</span><span class="p">[:</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">n_fem</span><span class="p">]</span> <span class="o">=</span> <span class="n">loads_</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mf">6</span> <span class="o">*</span> <span class="n">n_fem</span><span class="p">))</span></pre>
<pre class='cython code score-40 '>      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_loads_, __pyx_n_s_reshape); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1115, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_n_fem); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1115, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_15, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1115, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      } else {
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9); __pyx_t_9 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1115, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_n_fem); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1115, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_rhs_, __pyx_t_4, 0, 0, NULL, &amp;__pyx_t_15, NULL, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1115, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">1116</span>:             <span class="n">rhs</span><span class="p">[</span><span class="mf">6</span> <span class="o">*</span> <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">):</span> <span class="mf">6</span> <span class="o">*</span></pre>
<pre class='cython code score-21 '>      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1116, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_t_4); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1116, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1116, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_rhs, __pyx_v_rhs_, 0, 0, &amp;__pyx_t_15, &amp;__pyx_t_1, NULL, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1116, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">1117</span>:                 <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">+</span> <span class="n">i_surf</span> <span class="o">+</span> <span class="n">num_cons</span><span class="p">)]</span> <span class="o">=</span> <span class="n">rhs_</span></pre>
<pre class='cython code score-17 '>      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_v_i_surf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1117, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_num_cons); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1118</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1119</span>:         <span class="c"># sparse Fortran</span></pre>
<pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1120</span>:         <span class="k">elif</span> <span class="n">fortran_flag</span> <span class="ow">and</span> <span class="n">sparse_flag</span><span class="p">:</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fortran_flag); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1120, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_12 &lt; 0)) __PYX_ERR(0, 1120, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_12) {
    } else {
      __pyx_t_10 = __pyx_t_12;
      goto __pyx_L10_bool_binop_done;
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sparse_flag); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1120, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_12 &lt; 0)) __PYX_ERR(0, 1120, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_10 = __pyx_t_12;
    __pyx_L10_bool_binop_done:;
    if (__pyx_t_10) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-6" onclick='toggleDiv(this)'>+<span class="">1121</span>:             <span class="n">nnz</span> <span class="o">=</span> <span class="mf">144</span> <span class="o">*</span> <span class="n">num_elems</span></pre>
<pre class='cython code score-6 '>      __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_144, __pyx_v_num_elems); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1121, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_nnz, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1122</span>: </pre>
<pre class="cython line score-8" onclick='toggleDiv(this)'>+<span class="">1123</span>:             <span class="n">data1</span><span class="p">,</span> <span class="n">rows1</span><span class="p">,</span> <span class="n">cols1</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">assemblesparsemtx</span><span class="p">(</span><span class="n">num_elems</span><span class="p">,</span> <span class="n">tot_n_fem</span><span class="p">,</span> <span class="n">nnz</span><span class="p">,</span> <span class="n">x_gl</span><span class="p">,</span> <span class="n">E_vec</span><span class="p">,</span></pre>
<pre class='cython code score-8 '>      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_lib); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1123, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_assemblesparsemtx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1123, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
/* … */
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_data1, __pyx_t_4);
      __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rows1, __pyx_t_9);
      __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cols1, __pyx_t_15);
      __pyx_t_15 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1124</span>:                                                         <span class="n">G_vec</span><span class="p">,</span> <span class="n">A_</span><span class="p">,</span> <span class="n">J_</span><span class="p">,</span> <span class="n">Iy_</span><span class="p">,</span> <span class="n">Iz_</span><span class="p">,</span></pre>
<pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1125</span>:                                                         <span class="n">nodes</span><span class="p">,</span> <span class="n">elem_IDs_</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">const2</span><span class="p">,</span> <span class="n">const_y</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_elem_IDs_, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1125, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
</pre><pre class="cython line score-108" onclick='toggleDiv(this)'>+<span class="">1126</span>:                                                         <span class="n">const_z</span><span class="p">,</span> <span class="n">S_a</span><span class="p">,</span> <span class="n">S_t</span><span class="p">,</span> <span class="n">S_y</span><span class="p">,</span> <span class="n">S_z</span><span class="p">)</span></pre>
<pre class='cython code score-108 '>      __pyx_t_2 = NULL;
      __pyx_t_14 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_14 = 1;
        }
      }
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(19+__pyx_t_14); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1123, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      if (__pyx_t_2) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_elems);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_elems);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_14, __pyx_v_num_elems);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_n_fem);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_n_fem);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_14, __pyx_v_tot_n_fem);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nnz);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nnz);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_14, __pyx_v_nnz);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_gl);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_gl);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 3+__pyx_t_14, __pyx_v_x_gl);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E_vec);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_E_vec);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 4+__pyx_t_14, __pyx_v_E_vec);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_G_vec);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_G_vec);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 5+__pyx_t_14, __pyx_v_G_vec);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_A_);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_A_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 6+__pyx_t_14, __pyx_v_A_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_J_);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_J_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 7+__pyx_t_14, __pyx_v_J_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Iy_);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Iy_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 8+__pyx_t_14, __pyx_v_Iy_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Iz_);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Iz_);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 9+__pyx_t_14, __pyx_v_Iz_);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nodes);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nodes);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 10+__pyx_t_14, __pyx_v_nodes);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 11+__pyx_t_14, __pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_const2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_const2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 12+__pyx_t_14, __pyx_v_const2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_const_y);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_const_y);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 13+__pyx_t_14, __pyx_v_const_y);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_const_z);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_const_z);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 14+__pyx_t_14, __pyx_v_const_z);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_a);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_a);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 15+__pyx_t_14, __pyx_v_S_a);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_t);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_t);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 16+__pyx_t_14, __pyx_v_S_t);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_y);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_y);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 17+__pyx_t_14, __pyx_v_S_y);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_z);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_z);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 18+__pyx_t_14, __pyx_v_S_z);
      __pyx_t_15 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1123, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 3)) {
          if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          __PYX_ERR(0, 1123, __pyx_L1_error)
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
          __pyx_t_15 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        } else {
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
          __pyx_t_15 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1123, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1123, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_15 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1123, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1123, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_8 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;
        index = 0; __pyx_t_4 = __pyx_t_8(__pyx_t_2); if (unlikely(!__pyx_t_4)) goto __pyx_L12_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        index = 1; __pyx_t_9 = __pyx_t_8(__pyx_t_2); if (unlikely(!__pyx_t_9)) goto __pyx_L12_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        index = 2; __pyx_t_15 = __pyx_t_8(__pyx_t_2); if (unlikely(!__pyx_t_15)) goto __pyx_L12_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_2), 3) &lt; 0) __PYX_ERR(0, 1123, __pyx_L1_error)
        __pyx_t_8 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        goto __pyx_L13_unpacking_done;
        __pyx_L12_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_8 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        __PYX_ERR(0, 1123, __pyx_L1_error)
        __pyx_L13_unpacking_done:;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1127</span>: </pre>
<pre class="cython line score-41" onclick='toggleDiv(this)'>+<span class="">1128</span>:             <span class="n">data2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mf">6</span> <span class="o">*</span> <span class="n">num_cons</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.e9</span></pre>
<pre class='cython code score-41 '>      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1128, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_ones); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1128, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_num_cons); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1128, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1128, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1128, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_15);
        __pyx_t_15 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1128, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_float_1_e9); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1128, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_data2, __pyx_t_9);
      __pyx_t_9 = 0;
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">1129</span>:             <span class="n">rows2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">6</span> <span class="o">*</span> <span class="n">num_cons</span><span class="p">)</span> <span class="o">+</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">n_fem</span></pre>
<pre class='cython code score-47 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1129, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_arange); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1129, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_num_cons); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1129, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_15 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_15 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_15)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_15) {
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1129, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      } else {
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1129, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_15); __pyx_t_15 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1129, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_n_fem); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1129, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1129, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rows2, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">1130</span>:             <span class="n">cols2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mf">6</span> <span class="o">*</span> <span class="n">num_cons</span><span class="p">)</span></pre>
<pre class='cython code score-35 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1130, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1130, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_num_cons); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1130, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      if (!__pyx_t_1) {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1130, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      } else {
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1130, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_1); __pyx_t_1 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+1, __pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_15, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1130, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cols2, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">1131</span>:             <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">6</span><span class="p">):</span></pre>
<pre class='cython code score-57 '>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1131, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__421, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1131, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_9)) {
        __pyx_t_4 = __pyx_t_9; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_14 = 0;
        __pyx_t_16 = NULL;
      } else {
        __pyx_t_14 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1131, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_16 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1131, __pyx_L1_error)
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      for (;;) {
        if (likely(!__pyx_t_16)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
            if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_14++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1131, __pyx_L1_error)
            #else
            __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_14); __pyx_t_14++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1131, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
            #endif
          } else {
            if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_14++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1131, __pyx_L1_error)
            #else
            __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_14); __pyx_t_14++; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1131, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
            #endif
          }
        } else {
          __pyx_t_9 = __pyx_t_16(__pyx_t_4);
          if (unlikely(!__pyx_t_9)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else __PYX_ERR(0, 1131, __pyx_L1_error)
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_9);
        __pyx_t_9 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_tuple__421 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_6); if (unlikely(!__pyx_tuple__421)) __PYX_ERR(0, 1131, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__421);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__421);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1132</span>:                 <span class="n">cols2</span><span class="p">[</span><span class="n">ind</span><span class="p">::</span> <span class="mf">6</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">cons</span><span class="p">[</span><span class="n">i_surf</span><span class="p">]</span> <span class="o">+</span> <span class="n">ind</span></pre>
<pre class='cython code score-29 '>        __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_cons, __pyx_v_i_surf); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1132, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_t_9); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1132, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_v_ind); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1132, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_15 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_ind, Py_None, __pyx_int_6); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1132, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_cols2, __pyx_t_15, __pyx_t_9) &lt; 0)) __PYX_ERR(0, 1132, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1133</span>: </pre>
<pre class="cython line score-41" onclick='toggleDiv(this)'>+<span class="">1134</span>:             <span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">data2</span><span class="p">])</span></pre>
<pre class='cython code score-41 '>      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1134, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1134, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1134, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data1);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_data1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data2);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_data2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data2);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 2, __pyx_v_data2);
      __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_15, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1134, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      } else {
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1134, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2); __pyx_t_2 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_9);
        __pyx_t_9 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1134, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_data, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1135</span>:             <span class="n">rows</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1135, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1135, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class="cython line score-54" onclick='toggleDiv(this)'>+<span class="">1136</span>:                 <span class="p">[</span><span class="n">rows1</span><span class="p">,</span> <span class="n">rows2</span><span class="p">,</span> <span class="n">cols2</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6</span></pre>
<pre class='cython code score-54 '>      __pyx_t_15 = <span class='py_c_api'>PyList_New</span>(3); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1136, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rows1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rows1);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 0, __pyx_v_rows1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rows2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rows2);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 1, __pyx_v_rows2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cols2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cols2);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 2, __pyx_v_cols2);
      __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_15); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1135, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      } else {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1135, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9); __pyx_t_9 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_15);
        __pyx_t_15 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1135, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1136, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_int_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1136, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rows, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1137</span>:             <span class="n">cols</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-54" onclick='toggleDiv(this)'>+<span class="">1138</span>:                 <span class="p">[</span><span class="n">cols1</span><span class="p">,</span> <span class="n">cols2</span><span class="p">,</span> <span class="n">rows2</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6</span></pre>
<pre class='cython code score-54 '>      __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1138, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cols1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cols1);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_cols1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cols2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cols2);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_cols2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rows2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rows2);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_rows2);
      __pyx_t_15 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_15 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_15)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_15) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1137, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_15); __pyx_t_15 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1138, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_int_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1138, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_9); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1138, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cols, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1139</span>:             <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_data_list, __pyx_v_data); if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 1139, __pyx_L1_error)
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1140</span>:             <span class="n">rows_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_rows_list, __pyx_v_rows); if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 1140, __pyx_L1_error)
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1141</span>:             <span class="n">cols_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_cols_list, __pyx_v_cols); if (unlikely(__pyx_t_17 == -1)) __PYX_ERR(0, 1141, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">1142</span>: </pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">1143</span>:             <span class="n">rhs_</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-7 '>
      /* "OpenAeroStruct/aerostruct.py":1143
 *             cols_list.append(cols)
 * 
 *             rhs_[:] = 0.0             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             rhs_[: 6 * n_fem] = loads_.reshape((6 * n_fem))
 *             rhs[6 * (i_fem + i_surf): 6 *
 */
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_rhs_, __pyx_float_0_0, 0, 0, NULL, NULL, &amp;__pyx_slice__422, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1143, __pyx_L1_error)

  /* "OpenAeroStruct/aerostruct.py":1143
 *             cols_list.append(cols)
 * 
 *             rhs_[:] = 0.0             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             rhs_[: 6 * n_fem] = loads_.reshape((6 * n_fem))
 *             rhs[6 * (i_fem + i_surf): 6 *
 */
  __pyx_slice__422 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__422)) __PYX_ERR(0, 1143, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__422);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__422);
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">1144</span>:             <span class="n">rhs_</span><span class="p">[:</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">n_fem</span><span class="p">]</span> <span class="o">=</span> <span class="n">loads_</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mf">6</span> <span class="o">*</span> <span class="n">n_fem</span><span class="p">))</span></pre>
<pre class='cython code score-40 '>      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_loads_, __pyx_n_s_reshape); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1144, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_n_fem); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1144, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      } else {
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1144, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_2); __pyx_t_2 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+1, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_15, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1144, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_n_fem); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1144, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_rhs_, __pyx_t_4, 0, 0, NULL, &amp;__pyx_t_9, NULL, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1144, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">1145</span>:             <span class="n">rhs</span><span class="p">[</span><span class="mf">6</span> <span class="o">*</span> <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">):</span> <span class="mf">6</span> <span class="o">*</span></pre>
<pre class='cython code score-21 '>      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1145, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1145, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_t_4); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1145, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_rhs, __pyx_v_rhs_, 0, 0, &amp;__pyx_t_9, &amp;__pyx_t_15, NULL, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1145, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">1146</span>:                 <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">+</span> <span class="n">i_surf</span> <span class="o">+</span> <span class="n">num_cons</span><span class="p">)]</span> <span class="o">=</span> <span class="n">rhs_</span></pre>
<pre class='cython code score-17 '>      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1146, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_v_i_surf); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1146, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_v_num_cons); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1146, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1147</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1148</span>:         <span class="c"># sparse Python</span></pre>
<pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1149</span>:         <span class="k">elif</span> <span class="ow">not</span> <span class="n">fortran_flag</span> <span class="ow">and</span> <span class="n">sparse_flag</span><span class="p">:</span></pre>
<pre class='cython code score-10 '>    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fortran_flag); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1149, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_15); if (unlikely(__pyx_t_12 &lt; 0)) __PYX_ERR(0, 1149, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    __pyx_t_11 = ((!__pyx_t_12) != 0);
    if (__pyx_t_11) {
    } else {
      __pyx_t_10 = __pyx_t_11;
      goto __pyx_L16_bool_binop_done;
    }
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_sparse_flag); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1149, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_15); if (unlikely(__pyx_t_11 &lt; 0)) __PYX_ERR(0, 1149, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    __pyx_t_10 = __pyx_t_11;
    __pyx_L16_bool_binop_done:;
    if (__pyx_t_10) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1150</span>:             <span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1150, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1150, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_data_list); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1150, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      } else {
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1150, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9); __pyx_t_9 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data_list);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data_list);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_v_data_list);
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1150, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_data, __pyx_t_15);
      __pyx_t_15 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1151</span>:             <span class="n">rows</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">rows_list</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1151, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1151, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_4) {
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_rows_list); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1151, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      } else {
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1151, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_4); __pyx_t_4 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rows_list);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rows_list);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_rows_list);
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_9, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1151, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rows, __pyx_t_15);
      __pyx_t_15 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1152</span>:             <span class="n">cols</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">cols_list</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1152, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_concatenate); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1152, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      if (!__pyx_t_1) {
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_cols_list); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1152, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      } else {
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1152, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cols_list);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cols_list);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_v_cols_list);
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_4, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1152, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cols, __pyx_t_15);
      __pyx_t_15 = 0;
</pre><pre class="cython line score-37" onclick='toggleDiv(this)'>+<span class="">1153</span>:             <span class="n">mtx</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">csc_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">)),</span></pre>
<pre class='cython code score-37 '>      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_scipy); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1153, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_sparse); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1153, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_csc_matrix); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1153, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1153, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rows);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rows);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_rows);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cols);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cols);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_cols);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1153, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_data);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1153, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_4);
      __pyx_t_4 = 0;
/* … */
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_9, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1153, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_mtx, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">1154</span>:                                           <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span></pre>
<pre class='cython code score-20 '>      __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1154, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1154, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_size);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_size);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_size);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_size);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_size);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_size);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_shape, __pyx_t_1) &lt; 0) __PYX_ERR(0, 1154, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1155</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1156</span>:         <span class="c"># dense Python</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1157</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-3" onclick='toggleDiv(this)'>+<span class="">1158</span>:             <span class="n">num_nodes</span> <span class="o">=</span> <span class="n">num_elems</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>    /*else*/ {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_num_elems, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1158, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_num_nodes, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1159</span>: </pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">1160</span>:             <span class="n">mtx_</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-7 '>      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_mtx_, __pyx_float_0_, 0, 0, NULL, NULL, &amp;__pyx_slice__423, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1160, __pyx_L1_error)
/* … */
  __pyx_slice__423 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__423)) __PYX_ERR(0, 1160, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__423);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__423);
</pre><pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">1161</span>:             <span class="k">for</span> <span class="n">ielem</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_elems</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1161, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_num_elems); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1161, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1161, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_9); __pyx_t_9 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_elems);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_elems);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+1, __pyx_v_num_elems);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_15, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1161, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
        __pyx_t_4 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_14 = 0;
        __pyx_t_16 = NULL;
      } else {
        __pyx_t_14 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1161, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_16 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1161, __pyx_L1_error)
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      for (;;) {
        if (likely(!__pyx_t_16)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
            if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1161, __pyx_L1_error)
            #else
            __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_14); __pyx_t_14++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1161, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            #endif
          } else {
            if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1161, __pyx_L1_error)
            #else
            __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_14); __pyx_t_14++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1161, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            #endif
          }
        } else {
          __pyx_t_1 = __pyx_t_16(__pyx_t_4);
          if (unlikely(!__pyx_t_1)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else __PYX_ERR(0, 1161, __pyx_L1_error)
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ielem, __pyx_t_1);
        __pyx_t_1 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">1162</span>:                 <span class="n">P0</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">elem_IDs_</span><span class="p">[</span><span class="n">ielem</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="p">:]</span></pre>
<pre class='cython code score-35 '>        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1162, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ielem);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ielem);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_ielem);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_0);
        __pyx_t_15 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_elem_IDs_, __pyx_t_1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1162, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1162, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__424);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__424);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_slice__424);
        __pyx_t_15 = 0;
        __pyx_t_15 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_nodes, __pyx_t_1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1162, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_P0, __pyx_t_15);
        __pyx_t_15 = 0;
/* … */
  __pyx_slice__424 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__424)) __PYX_ERR(0, 1162, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__424);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__424);
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">1163</span>:                 <span class="n">P1</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">elem_IDs_</span><span class="p">[</span><span class="n">ielem</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="p">:]</span></pre>
<pre class='cython code score-35 '>        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1163, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ielem);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ielem);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_v_ielem);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1, __pyx_int_1);
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_elem_IDs_, __pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1163, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1163, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__425);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__425);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1, __pyx_slice__425);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_nodes, __pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1163, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_P1, __pyx_t_1);
        __pyx_t_1 = 0;
/* … */
  __pyx_slice__425 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__425)) __PYX_ERR(0, 1163, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__425);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__425);
</pre><pre class="cython line score-0">&#xA0;<span class="">1164</span>: </pre>
<pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1165</span>:                 <span class="n">x_loc</span> <span class="o">=</span> <span class="n">unit</span><span class="p">(</span><span class="n">P1</span> <span class="o">-</span> <span class="n">P0</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_unit); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1165, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_P1, __pyx_v_P0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1165, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_2 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
          __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
          if (likely(__pyx_t_2)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
          }
        }
        if (!__pyx_t_2) {
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_15, __pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1165, __pyx_L1_error)
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        } else {
          __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1165, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_2); __pyx_t_2 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+1, __pyx_t_9);
          __pyx_t_9 = 0;
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_13, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1165, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x_loc, __pyx_t_1);
        __pyx_t_1 = 0;
</pre><pre class="cython line score-56" onclick='toggleDiv(this)'>+<span class="">1166</span>:                 <span class="n">y_loc</span> <span class="o">=</span> <span class="n">unit</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">x_loc</span><span class="p">,</span> <span class="n">x_gl</span><span class="p">))</span></pre>
<pre class='cython code score-56 '>        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_unit); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1166, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1166, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_cross); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1166, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = NULL;
        __pyx_t_18 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
          __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
          if (likely(__pyx_t_9)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
            __pyx_t_18 = 1;
          }
        }
        __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_18); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1166, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        if (__pyx_t_9) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_9); __pyx_t_9 = NULL;
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_loc);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_loc);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0+__pyx_t_18, __pyx_v_x_loc);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_gl);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_gl);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1+__pyx_t_18, __pyx_v_x_gl);
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_19, NULL); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1166, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
          __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
          if (likely(__pyx_t_2)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
          }
        }
        if (!__pyx_t_2) {
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_15, __pyx_t_13); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1166, __pyx_L1_error)
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        } else {
          __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1166, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_2); __pyx_t_2 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0+1, __pyx_t_13);
          __pyx_t_13 = 0;
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_19, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1166, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_y_loc, __pyx_t_1);
        __pyx_t_1 = 0;
</pre><pre class="cython line score-56" onclick='toggleDiv(this)'>+<span class="">1167</span>:                 <span class="n">z_loc</span> <span class="o">=</span> <span class="n">unit</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">x_loc</span><span class="p">,</span> <span class="n">y_loc</span><span class="p">))</span></pre>
<pre class='cython code score-56 '>        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_unit); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1167, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1167, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_cross); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1167, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        __pyx_t_13 = NULL;
        __pyx_t_18 = 0;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
          __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
          if (likely(__pyx_t_13)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
            __pyx_t_18 = 1;
          }
        }
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_18); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1167, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        if (__pyx_t_13) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_13); __pyx_t_13 = NULL;
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_loc);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_loc);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_18, __pyx_v_x_loc);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_loc);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_loc);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_18, __pyx_v_y_loc);
        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, NULL); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1167, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
          __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
          if (likely(__pyx_t_2)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
          }
        }
        if (!__pyx_t_2) {
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_15, __pyx_t_19); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1167, __pyx_L1_error)
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        } else {
          __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1167, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_t_19);
          __pyx_t_19 = 0;
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1167, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_z_loc, __pyx_t_1);
        __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1168</span>: </pre>
<pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">1169</span>:                 <span class="n">T</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">x_loc</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__426 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__426)) __PYX_ERR(0, 1169, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__426);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__426);
/* … */
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_T, __pyx_tuple__427, __pyx_v_x_loc) &lt; 0)) __PYX_ERR(0, 1169, __pyx_L1_error)
  __pyx_tuple__427 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_slice__426); if (unlikely(!__pyx_tuple__427)) __PYX_ERR(0, 1169, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__427);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__427);
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">1170</span>:                 <span class="n">T</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">y_loc</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__428 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__428)) __PYX_ERR(0, 1170, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__428);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__428);
/* … */
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_T, __pyx_tuple__429, __pyx_v_y_loc) &lt; 0)) __PYX_ERR(0, 1170, __pyx_L1_error)
  __pyx_tuple__429 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_slice__428); if (unlikely(!__pyx_tuple__429)) __PYX_ERR(0, 1170, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__429);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__429);
</pre><pre class="cython line score-15" onclick='toggleDiv(this)'>+<span class="">1171</span>:                 <span class="n">T</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">z_loc</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__430 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__430)) __PYX_ERR(0, 1171, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__430);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__430);
/* … */
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_T, __pyx_tuple__431, __pyx_v_z_loc) &lt; 0)) __PYX_ERR(0, 1171, __pyx_L1_error)
  __pyx_tuple__431 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_slice__430); if (unlikely(!__pyx_tuple__431)) __PYX_ERR(0, 1171, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__431);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__431);
</pre><pre class="cython line score-0">&#xA0;<span class="">1172</span>: </pre>
<pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">1173</span>:                 <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">4</span><span class="p">):</span></pre>
<pre class='cython code score-57 '>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1173, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__432, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1173, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_15)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_15)) {
          __pyx_t_1 = __pyx_t_15; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_18 = 0;
          __pyx_t_20 = NULL;
        } else {
          __pyx_t_18 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1173, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_20 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext; if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1173, __pyx_L1_error)
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        for (;;) {
          if (likely(!__pyx_t_20)) {
            if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
              if (__pyx_t_18 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_15 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15); __pyx_t_18++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1173, __pyx_L1_error)
              #else
              __pyx_t_15 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_18); __pyx_t_18++; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1173, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
              #endif
            } else {
              if (__pyx_t_18 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_15 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15); __pyx_t_18++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1173, __pyx_L1_error)
              #else
              __pyx_t_15 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_18); __pyx_t_18++; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1173, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
              #endif
            }
          } else {
            __pyx_t_15 = __pyx_t_20(__pyx_t_1);
            if (unlikely(!__pyx_t_15)) {
              PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                else __PYX_ERR(0, 1173, __pyx_L1_error)
              }
              break;
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_15);
          __pyx_t_15 = 0;
/* … */
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__432 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_4); if (unlikely(!__pyx_tuple__432)) __PYX_ERR(0, 1173, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__432);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__432);
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">1174</span>:                     <span class="n">T_elem</span><span class="p">[</span><span class="mf">3</span> <span class="o">*</span> <span class="n">ind</span><span class="p">:</span> <span class="mf">3</span> <span class="o">*</span> <span class="n">ind</span> <span class="o">+</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">3</span> <span class="o">*</span> <span class="n">ind</span><span class="p">:</span> <span class="mf">3</span> <span class="o">*</span> <span class="n">ind</span> <span class="o">+</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span></pre>
<pre class='cython code score-53 '>          __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_3, __pyx_v_ind); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1174, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_3, __pyx_v_ind); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1174, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_9, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1174, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          __pyx_t_9 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_15, __pyx_t_19, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1174, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
          __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_3, __pyx_v_ind); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1174, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_3, __pyx_v_ind); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1174, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_15, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1174, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          __pyx_t_15 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_19, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1174, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1174, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_15);
          __pyx_t_9 = 0;
          __pyx_t_15 = 0;
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_T_elem, __pyx_t_2, __pyx_v_T) &lt; 0)) __PYX_ERR(0, 1174, __pyx_L1_error)
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1175</span>: </pre>
<pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1176</span>:                 <span class="n">L</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">P1</span> <span class="o">-</span> <span class="n">P0</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_norm); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1176, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_15 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_P1, __pyx_v_P0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1176, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_9 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
          __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
          if (likely(__pyx_t_9)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          }
        }
        if (!__pyx_t_9) {
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1176, __pyx_L1_error)
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        } else {
          __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1176, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_9); __pyx_t_9 = NULL;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0+1, __pyx_t_15);
          __pyx_t_15 = 0;
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_19, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1176, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_L, __pyx_t_1);
        __pyx_t_1 = 0;
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">1177</span>:                 <span class="n">EA_L</span> <span class="o">=</span> <span class="n">E_vec</span><span class="p">[</span><span class="n">ielem</span><span class="p">]</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="n">ielem</span><span class="p">]</span> <span class="o">/</span> <span class="n">L</span></pre>
<pre class='cython code score-21 '>        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_E_vec, __pyx_v_ielem); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_A, __pyx_v_ielem); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1177, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1177, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_19, __pyx_v_L); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1177, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_EA_L, __pyx_t_2);
        __pyx_t_2 = 0;
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">1178</span>:                 <span class="n">GJ_L</span> <span class="o">=</span> <span class="n">G_vec</span><span class="p">[</span><span class="n">ielem</span><span class="p">]</span> <span class="o">*</span> <span class="n">J</span><span class="p">[</span><span class="n">ielem</span><span class="p">]</span> <span class="o">/</span> <span class="n">L</span></pre>
<pre class='cython code score-21 '>        __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_G_vec, __pyx_v_ielem); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1178, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_19 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_J, __pyx_v_ielem); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1178, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_19); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1178, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_v_L); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1178, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_GJ_L, __pyx_t_19);
        __pyx_t_19 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">1179</span>:                 <span class="n">EIy_L3</span> <span class="o">=</span> <span class="n">E_vec</span><span class="p">[</span><span class="n">ielem</span><span class="p">]</span> <span class="o">*</span> <span class="n">Iy</span><span class="p">[</span><span class="n">ielem</span><span class="p">]</span> <span class="o">/</span> <span class="n">L</span><span class="o">**</span><span class="mf">3</span></pre>
<pre class='cython code score-27 '>        __pyx_t_19 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_E_vec, __pyx_v_ielem); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1179, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Iy, __pyx_v_ielem); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1179, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_19, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_L, __pyx_int_3, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1179, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1179, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_EIy_L3, __pyx_t_19);
        __pyx_t_19 = 0;
</pre><pre class="cython line score-27" onclick='toggleDiv(this)'>+<span class="">1180</span>:                 <span class="n">EIz_L3</span> <span class="o">=</span> <span class="n">E_vec</span><span class="p">[</span><span class="n">ielem</span><span class="p">]</span> <span class="o">*</span> <span class="n">Iz</span><span class="p">[</span><span class="n">ielem</span><span class="p">]</span> <span class="o">/</span> <span class="n">L</span><span class="o">**</span><span class="mf">3</span></pre>
<pre class='cython code score-27 '>        __pyx_t_19 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_E_vec, __pyx_v_ielem); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1180, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Iz, __pyx_v_ielem); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1180, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_19, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1180, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_L, __pyx_int_3, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1180, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1180, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_EIz_L3, __pyx_t_19);
        __pyx_t_19 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1181</span>: </pre>
<pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">1182</span>:                 <span class="n">K_a</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">EA_L</span> <span class="o">*</span> <span class="n">const2</span></pre>
<pre class='cython code score-26 '>        __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_EA_L, __pyx_v_const2); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1182, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
/* … */
  __pyx_slice__433 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__433)) __PYX_ERR(0, 1182, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__433);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__433);
  __pyx_slice__434 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__434)) __PYX_ERR(0, 1182, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__434);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__434);
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_K_a, __pyx_tuple__435, __pyx_t_19) &lt; 0)) __PYX_ERR(0, 1182, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_tuple__435 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__433, __pyx_slice__434); if (unlikely(!__pyx_tuple__435)) __PYX_ERR(0, 1182, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__435);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__435);
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">1183</span>:                 <span class="n">K_t</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">GJ_L</span> <span class="o">*</span> <span class="n">const2</span></pre>
<pre class='cython code score-26 '>        __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_GJ_L, __pyx_v_const2); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1183, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
/* … */
  __pyx_slice__436 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__436)) __PYX_ERR(0, 1183, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__436);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__436);
  __pyx_slice__437 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__437)) __PYX_ERR(0, 1183, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__437);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__437);
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_K_t, __pyx_tuple__438, __pyx_t_19) &lt; 0)) __PYX_ERR(0, 1183, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_tuple__438 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__436, __pyx_slice__437); if (unlikely(!__pyx_tuple__438)) __PYX_ERR(0, 1183, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__438);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__438);
</pre><pre class="cython line score-0">&#xA0;<span class="">1184</span>: </pre>
<pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">1185</span>:                 <span class="n">K_y</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">EIy_L3</span> <span class="o">*</span> <span class="n">const_y</span></pre>
<pre class='cython code score-26 '>        __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_EIy_L3, __pyx_v_const_y); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1185, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
/* … */
  __pyx_slice__439 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__439)) __PYX_ERR(0, 1185, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__439);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__439);
  __pyx_slice__440 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__440)) __PYX_ERR(0, 1185, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__440);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__440);
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_K_y, __pyx_tuple__441, __pyx_t_19) &lt; 0)) __PYX_ERR(0, 1185, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_tuple__441 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__439, __pyx_slice__440); if (unlikely(!__pyx_tuple__441)) __PYX_ERR(0, 1185, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__441);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__441);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1186</span>:                 <span class="n">K_y</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*=</span> <span class="n">L</span></pre>
<pre class='cython code score-29 '>  __pyx_slice__442 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__442)) __PYX_ERR(0, 1186, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__442);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__442);
/* … */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__443);
        __pyx_t_21 = __pyx_tuple__443;
        __pyx_t_19 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_K_y, __pyx_t_21); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1186, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_19, __pyx_v_L); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1186, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_K_y, __pyx_t_21, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 1186, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_tuple__443 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_slice__442); if (unlikely(!__pyx_tuple__443)) __PYX_ERR(0, 1186, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__443);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__443);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1187</span>:                 <span class="n">K_y</span><span class="p">[</span><span class="mf">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*=</span> <span class="n">L</span></pre>
<pre class='cython code score-29 '>  __pyx_slice__444 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__444)) __PYX_ERR(0, 1187, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__444);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__444);
/* … */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__445);
        __pyx_t_21 = __pyx_tuple__445;
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_K_y, __pyx_t_21); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1187, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_19 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_1, __pyx_v_L); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1187, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_K_y, __pyx_t_21, __pyx_t_19) &lt; 0)) __PYX_ERR(0, 1187, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_tuple__445 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_3, __pyx_slice__444); if (unlikely(!__pyx_tuple__445)) __PYX_ERR(0, 1187, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__445);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__445);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1188</span>:                 <span class="n">K_y</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">*=</span> <span class="n">L</span></pre>
<pre class='cython code score-29 '>  __pyx_slice__446 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__446)) __PYX_ERR(0, 1188, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__446);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__446);
/* … */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__447);
        __pyx_t_21 = __pyx_tuple__447;
        __pyx_t_19 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_K_y, __pyx_t_21); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1188, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_19, __pyx_v_L); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1188, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_K_y, __pyx_t_21, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 1188, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_tuple__447 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__446, __pyx_int_1); if (unlikely(!__pyx_tuple__447)) __PYX_ERR(0, 1188, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__447);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__447);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1189</span>:                 <span class="n">K_y</span><span class="p">[:,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">*=</span> <span class="n">L</span></pre>
<pre class='cython code score-29 '>  __pyx_slice__448 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__448)) __PYX_ERR(0, 1189, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__448);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__448);
/* … */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__449);
        __pyx_t_21 = __pyx_tuple__449;
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_K_y, __pyx_t_21); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1189, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_19 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_1, __pyx_v_L); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1189, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_K_y, __pyx_t_21, __pyx_t_19) &lt; 0)) __PYX_ERR(0, 1189, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_tuple__449 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__448, __pyx_int_3); if (unlikely(!__pyx_tuple__449)) __PYX_ERR(0, 1189, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__449);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__449);
</pre><pre class="cython line score-0">&#xA0;<span class="">1190</span>: </pre>
<pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">1191</span>:                 <span class="n">K_z</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">EIz_L3</span> <span class="o">*</span> <span class="n">const_z</span></pre>
<pre class='cython code score-26 '>        __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_EIz_L3, __pyx_v_const_z); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1191, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
/* … */
  __pyx_slice__450 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__450)) __PYX_ERR(0, 1191, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__450);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__450);
  __pyx_slice__451 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__451)) __PYX_ERR(0, 1191, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__451);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__451);
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_K_z, __pyx_tuple__452, __pyx_t_19) &lt; 0)) __PYX_ERR(0, 1191, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_tuple__452 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__450, __pyx_slice__451); if (unlikely(!__pyx_tuple__452)) __PYX_ERR(0, 1191, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__452);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__452);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1192</span>:                 <span class="n">K_z</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*=</span> <span class="n">L</span></pre>
<pre class='cython code score-29 '>  __pyx_slice__453 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__453)) __PYX_ERR(0, 1192, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__453);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__453);
/* … */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__454);
        __pyx_t_21 = __pyx_tuple__454;
        __pyx_t_19 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_K_z, __pyx_t_21); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1192, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_19, __pyx_v_L); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1192, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_K_z, __pyx_t_21, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 1192, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_tuple__454 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_slice__453); if (unlikely(!__pyx_tuple__454)) __PYX_ERR(0, 1192, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__454);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__454);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1193</span>:                 <span class="n">K_z</span><span class="p">[</span><span class="mf">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*=</span> <span class="n">L</span></pre>
<pre class='cython code score-29 '>  __pyx_slice__455 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__455)) __PYX_ERR(0, 1193, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__455);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__455);
/* … */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__456);
        __pyx_t_21 = __pyx_tuple__456;
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_K_z, __pyx_t_21); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1193, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_19 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_1, __pyx_v_L); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1193, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_K_z, __pyx_t_21, __pyx_t_19) &lt; 0)) __PYX_ERR(0, 1193, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_tuple__456 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_3, __pyx_slice__455); if (unlikely(!__pyx_tuple__456)) __PYX_ERR(0, 1193, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__456);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__456);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1194</span>:                 <span class="n">K_z</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">*=</span> <span class="n">L</span></pre>
<pre class='cython code score-29 '>  __pyx_slice__457 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__457)) __PYX_ERR(0, 1194, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__457);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__457);
/* … */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__458);
        __pyx_t_21 = __pyx_tuple__458;
        __pyx_t_19 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_K_z, __pyx_t_21); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1194, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_19, __pyx_v_L); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1194, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_K_z, __pyx_t_21, __pyx_t_1) &lt; 0)) __PYX_ERR(0, 1194, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_tuple__458 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__457, __pyx_int_1); if (unlikely(!__pyx_tuple__458)) __PYX_ERR(0, 1194, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__458);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__458);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1195</span>:                 <span class="n">K_z</span><span class="p">[:,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">*=</span> <span class="n">L</span></pre>
<pre class='cython code score-29 '>  __pyx_slice__459 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__459)) __PYX_ERR(0, 1195, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__459);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__459);
/* … */
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__460);
        __pyx_t_21 = __pyx_tuple__460;
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_K_z, __pyx_t_21); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1195, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_19 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_1, __pyx_v_L); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1195, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_K_z, __pyx_t_21, __pyx_t_19) &lt; 0)) __PYX_ERR(0, 1195, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_tuple__460 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__459, __pyx_int_3); if (unlikely(!__pyx_tuple__460)) __PYX_ERR(0, 1195, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__460);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__460);
</pre><pre class="cython line score-0">&#xA0;<span class="">1196</span>: </pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">1197</span>:                 <span class="n">K_elem</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-7 '>        if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_K_elem, __pyx_int_0, 0, 0, NULL, NULL, &amp;__pyx_slice__461, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1197, __pyx_L1_error)
/* … */
  __pyx_slice__461 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__461)) __PYX_ERR(0, 1197, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__461);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__461);
</pre><pre class="cython line score-63" onclick='toggleDiv(this)'>+<span class="">1198</span>:                 <span class="n">K_elem</span> <span class="o">+=</span> <span class="n">S_a</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K_a</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S_a</span><span class="p">)</span></pre>
<pre class='cython code score-63 '>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_S_a, __pyx_n_s_T); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1198, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_dot); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1198, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
          __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
          if (likely(__pyx_t_2)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
          }
        }
        if (!__pyx_t_2) {
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_15, __pyx_v_K_a); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1198, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        } else {
          __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1198, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_a);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_a);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_K_a);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1198, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_dot); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1198, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
          __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
          if (likely(__pyx_t_1)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
          }
        }
        if (!__pyx_t_1) {
          __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_15, __pyx_v_S_a); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1198, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        } else {
          __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1198, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1); __pyx_t_1 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_a);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_a);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_S_a);
          __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_9, NULL); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1198, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_15 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_K_elem, __pyx_t_19); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1198, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_K_elem, __pyx_t_15);
        __pyx_t_15 = 0;
</pre><pre class="cython line score-63" onclick='toggleDiv(this)'>+<span class="">1199</span>:                 <span class="n">K_elem</span> <span class="o">+=</span> <span class="n">S_t</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K_t</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S_t</span><span class="p">)</span></pre>
<pre class='cython code score-63 '>        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_S_t, __pyx_n_s_T); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1199, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_dot); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
          __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
          if (likely(__pyx_t_9)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          }
        }
        if (!__pyx_t_9) {
          __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_K_t); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1199, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        } else {
          __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1199, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9); __pyx_t_9 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_t);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_t);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_K_t);
          __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1199, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_19, __pyx_n_s_dot); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        __pyx_t_19 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
          __pyx_t_19 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
          if (likely(__pyx_t_19)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          }
        }
        if (!__pyx_t_19) {
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_S_t); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1199, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        } else {
          __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1199, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_19); __pyx_t_19 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_t);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_t);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_S_t);
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1199, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_K_elem, __pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_K_elem, __pyx_t_1);
        __pyx_t_1 = 0;
</pre><pre class="cython line score-63" onclick='toggleDiv(this)'>+<span class="">1200</span>:                 <span class="n">K_elem</span> <span class="o">+=</span> <span class="n">S_y</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K_y</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S_y</span><span class="p">)</span></pre>
<pre class='cython code score-63 '>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_S_y, __pyx_n_s_T); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1200, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_dot); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1200, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_19))) {
          __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_19);
          if (likely(__pyx_t_2)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_19, function);
          }
        }
        if (!__pyx_t_2) {
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_19, __pyx_v_K_y); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1200, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        } else {
          __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1200, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_y);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_y);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_K_y);
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_19, __pyx_t_9, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1200, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_dot); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1200, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_15 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_19))) {
          __pyx_t_15 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_19);
          if (likely(__pyx_t_15)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_19, function);
          }
        }
        if (!__pyx_t_15) {
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_19, __pyx_v_S_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1200, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        } else {
          __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1200, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_15); __pyx_t_15 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_y);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_y);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_S_y);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_19, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1200, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        __pyx_t_19 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_K_elem, __pyx_t_1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1200, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_K_elem, __pyx_t_19);
        __pyx_t_19 = 0;
</pre><pre class="cython line score-63" onclick='toggleDiv(this)'>+<span class="">1201</span>:                 <span class="n">K_elem</span> <span class="o">+=</span> <span class="n">S_z</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K_z</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S_z</span><span class="p">)</span></pre>
<pre class='cython code score-63 '>        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_S_z, __pyx_n_s_T); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1201, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_dot); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1201, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
          __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
          if (likely(__pyx_t_9)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
          }
        }
        if (!__pyx_t_9) {
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_15, __pyx_v_K_z); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1201, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        } else {
          __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1201, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9); __pyx_t_9 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_z);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_z);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_K_z);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1201, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_dot); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1201, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
          __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
          if (likely(__pyx_t_1)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
          }
        }
        if (!__pyx_t_1) {
          __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_15, __pyx_v_S_z); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1201, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        } else {
          __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1201, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_z);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_z);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_S_z);
          __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_2, NULL); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1201, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_15 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_K_elem, __pyx_t_19); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1201, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_K_elem, __pyx_t_15);
        __pyx_t_15 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1202</span>: </pre>
<pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">1203</span>:                 <span class="n">res</span> <span class="o">=</span> <span class="n">T_elem</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K_elem</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">T_elem</span><span class="p">)</span></pre>
<pre class='cython code score-57 '>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_T_elem, __pyx_n_s_T); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1203, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_dot); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1203, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
          __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
          if (likely(__pyx_t_2)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          }
        }
        if (!__pyx_t_2) {
          __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_K_elem); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1203, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        } else {
          __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1203, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_elem);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_elem);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_K_elem);
          __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_9, NULL); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1203, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_19, __pyx_n_s_dot); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1203, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        __pyx_t_19 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
          __pyx_t_19 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
          if (likely(__pyx_t_19)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          }
        }
        if (!__pyx_t_19) {
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_T_elem); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1203, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        } else {
          __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1203, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_19); __pyx_t_19 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_T_elem);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_T_elem);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+1, __pyx_v_T_elem);
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_9, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1203, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_res, __pyx_t_15);
        __pyx_t_15 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1204</span>: </pre>
<pre class="cython line score-69" onclick='toggleDiv(this)'>+<span class="">1205</span>:                 <span class="n">in0</span><span class="p">,</span> <span class="n">in1</span> <span class="o">=</span> <span class="n">elem_IDs</span><span class="p">[</span><span class="n">ielem</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-69 '>
        /* "OpenAeroStruct/aerostruct.py":1205
 *                 res = T_elem.T.dot(K_elem).dot(T_elem)
 * 
 *                 in0, in1 = elem_IDs[ielem, :]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *                 mtx_[6 * in0: 6 * in0 + 6, 6 *
 */
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1205, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ielem);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ielem);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_v_ielem);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__462);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__462);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1, __pyx_slice__462);
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_elem_IDs, __pyx_t_15); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
          PyObject* sequence = __pyx_t_1;
          #if CYTHON_COMPILING_IN_CPYTHON
          Py_ssize_t size = Py_SIZE(sequence);
          #else
          Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
          #endif
          if (unlikely(size != 2)) {
            if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
            else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
            __PYX_ERR(0, 1205, __pyx_L1_error)
          }
          #if CYTHON_COMPILING_IN_CPYTHON
          if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
            __pyx_t_15 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
            __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
          } else {
            __pyx_t_15 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
            __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          #else
          __pyx_t_15 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1205, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1205, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          #endif
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        } else {
          Py_ssize_t index = -1;
          __pyx_t_19 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1205, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_8 = Py_TYPE(__pyx_t_19)-&gt;tp_iternext;
          index = 0; __pyx_t_15 = __pyx_t_8(__pyx_t_19); if (unlikely(!__pyx_t_15)) goto __pyx_L22_unpacking_failed;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          index = 1; __pyx_t_9 = __pyx_t_8(__pyx_t_19); if (unlikely(!__pyx_t_9)) goto __pyx_L22_unpacking_failed;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_19), 2) &lt; 0) __PYX_ERR(0, 1205, __pyx_L1_error)
          __pyx_t_8 = NULL;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
          goto __pyx_L23_unpacking_done;
          __pyx_L22_unpacking_failed:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
          __pyx_t_8 = NULL;
          if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
          __PYX_ERR(0, 1205, __pyx_L1_error)
          __pyx_L23_unpacking_done:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_in0, __pyx_t_15);
        __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_in1, __pyx_t_9);
        __pyx_t_9 = 0;

  /* "OpenAeroStruct/aerostruct.py":1205
 *                 res = T_elem.T.dot(K_elem).dot(T_elem)
 * 
 *                 in0, in1 = elem_IDs[ielem, :]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *                 mtx_[6 * in0: 6 * in0 + 6, 6 *
 */
  __pyx_slice__462 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__462)) __PYX_ERR(0, 1205, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__462);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__462);
</pre><pre class="cython line score-0">&#xA0;<span class="">1206</span>: </pre>
<pre class="cython line score-58" onclick='toggleDiv(this)'>+<span class="">1207</span>:                 <span class="n">mtx_</span><span class="p">[</span><span class="mf">6</span> <span class="o">*</span> <span class="n">in0</span><span class="p">:</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">in0</span> <span class="o">+</span> <span class="mf">6</span><span class="p">,</span> <span class="mf">6</span> <span class="o">*</span></pre>
<pre class='cython code score-58 '>        __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_9, __pyx_int_6, 6, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_1, __pyx_t_15, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
/* … */
        __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
/* … */
        __pyx_t_1 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_15, __pyx_t_19, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1, __pyx_t_1);
        __pyx_t_9 = 0;
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mtx_, __pyx_t_19); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
        __pyx_t_15 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_1, __pyx_t_9); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1207, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mtx_, __pyx_t_19, __pyx_t_15) &lt; 0)) __PYX_ERR(0, 1207, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
</pre><pre class="cython line score-28" onclick='toggleDiv(this)'>+<span class="">1208</span>:                      <span class="n">in0</span><span class="p">:</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">in0</span> <span class="o">+</span> <span class="mf">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">res</span><span class="p">[:</span> <span class="mf">6</span><span class="p">,</span> <span class="p">:</span> <span class="mf">6</span><span class="p">]</span></pre>
<pre class='cython code score-28 '>        __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1208, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_6, 6, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1208, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__463 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_6, Py_None); if (unlikely(!__pyx_slice__463)) __PYX_ERR(0, 1208, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__463);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__463);
  __pyx_slice__464 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_6, Py_None); if (unlikely(!__pyx_slice__464)) __PYX_ERR(0, 1208, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__464);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__464);
/* … */
        __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_res, __pyx_tuple__465); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1208, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_tuple__465 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__463, __pyx_slice__464); if (unlikely(!__pyx_tuple__465)) __PYX_ERR(0, 1208, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__465);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__465);
</pre><pre class="cython line score-86" onclick='toggleDiv(this)'>+<span class="">1209</span>:                 <span class="n">mtx_</span><span class="p">[</span><span class="mf">6</span> <span class="o">*</span> <span class="n">in1</span><span class="p">:</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">in1</span> <span class="o">+</span> <span class="mf">6</span><span class="p">,</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">in0</span><span class="p">:</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">in0</span> <span class="o">+</span> <span class="mf">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">res</span><span class="p">[</span><span class="mf">6</span><span class="p">:,</span> <span class="p">:</span> <span class="mf">6</span><span class="p">]</span></pre>
<pre class='cython code score-86 '>        __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_15, __pyx_int_6, 6, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_15 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_19, __pyx_t_9, Py_None); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_19, __pyx_int_6, 6, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        __pyx_t_19 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_9, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_15);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_19);
        __pyx_t_15 = 0;
        __pyx_t_19 = 0;
        __pyx_t_19 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mtx_, __pyx_t_1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
/* … */
  __pyx_slice__466 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_6, Py_None, Py_None); if (unlikely(!__pyx_slice__466)) __PYX_ERR(0, 1209, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__466);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__466);
  __pyx_slice__467 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_6, Py_None); if (unlikely(!__pyx_slice__467)) __PYX_ERR(0, 1209, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__467);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__467);
        __pyx_t_15 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_res, __pyx_tuple__468); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_9 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_19, __pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mtx_, __pyx_t_1, __pyx_t_9) &lt; 0)) __PYX_ERR(0, 1209, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_tuple__468 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__466, __pyx_slice__467); if (unlikely(!__pyx_tuple__468)) __PYX_ERR(0, 1209, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__468);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__468);
</pre><pre class="cython line score-86" onclick='toggleDiv(this)'>+<span class="">1210</span>:                 <span class="n">mtx_</span><span class="p">[</span><span class="mf">6</span> <span class="o">*</span> <span class="n">in0</span><span class="p">:</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">in0</span> <span class="o">+</span> <span class="mf">6</span><span class="p">,</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">in1</span><span class="p">:</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">in1</span> <span class="o">+</span> <span class="mf">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">res</span><span class="p">[:</span> <span class="mf">6</span><span class="p">,</span> <span class="mf">6</span><span class="p">:]</span></pre>
<pre class='cython code score-86 '>        __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_9, __pyx_int_6, 6, 0); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_1, __pyx_t_15, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_6, 6, 0); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_15, __pyx_t_19, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1, __pyx_t_1);
        __pyx_t_9 = 0;
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mtx_, __pyx_t_19); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_slice__469 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_6, Py_None); if (unlikely(!__pyx_slice__469)) __PYX_ERR(0, 1210, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__469);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__469);
  __pyx_slice__470 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_6, Py_None, Py_None); if (unlikely(!__pyx_slice__470)) __PYX_ERR(0, 1210, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__470);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__470);
        __pyx_t_9 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_res, __pyx_tuple__471); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_15 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_1, __pyx_t_9); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mtx_, __pyx_t_19, __pyx_t_15) &lt; 0)) __PYX_ERR(0, 1210, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_tuple__471 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__469, __pyx_slice__470); if (unlikely(!__pyx_tuple__471)) __PYX_ERR(0, 1210, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__471);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__471);
</pre><pre class="cython line score-86" onclick='toggleDiv(this)'>+<span class="">1211</span>:                 <span class="n">mtx_</span><span class="p">[</span><span class="mf">6</span> <span class="o">*</span> <span class="n">in1</span><span class="p">:</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">in1</span> <span class="o">+</span> <span class="mf">6</span><span class="p">,</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">in1</span><span class="p">:</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">in1</span> <span class="o">+</span> <span class="mf">6</span><span class="p">]</span> <span class="o">+=</span> <span class="n">res</span><span class="p">[</span><span class="mf">6</span><span class="p">:,</span> <span class="mf">6</span><span class="p">:]</span></pre>
<pre class='cython code score-86 '>        __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_15, __pyx_int_6, 6, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_15 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_19, __pyx_t_9, Py_None); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_in1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_19, __pyx_int_6, 6, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        __pyx_t_19 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_9, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_15);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_19);
        __pyx_t_15 = 0;
        __pyx_t_19 = 0;
        __pyx_t_19 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mtx_, __pyx_t_1); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
/* … */
  __pyx_slice__472 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_6, Py_None, Py_None); if (unlikely(!__pyx_slice__472)) __PYX_ERR(0, 1211, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__472);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__472);
  __pyx_slice__473 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_6, Py_None, Py_None); if (unlikely(!__pyx_slice__473)) __PYX_ERR(0, 1211, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__473);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__473);
        __pyx_t_15 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_res, __pyx_tuple__474); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_9 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_19, __pyx_t_15); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mtx_, __pyx_t_1, __pyx_t_9) &lt; 0)) __PYX_ERR(0, 1211, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_tuple__474 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__472, __pyx_slice__473); if (unlikely(!__pyx_tuple__474)) __PYX_ERR(0, 1211, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__474);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__474);
</pre><pre class="cython line score-0">&#xA0;<span class="">1212</span>: </pre>
<pre class="cython line score-73" onclick='toggleDiv(this)'>+<span class="">1213</span>:             <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_cons</span><span class="p">):</span></pre>
<pre class='cython code score-73 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1213, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_num_cons); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1213, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      } else {
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1213, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_9); __pyx_t_9 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_cons);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_cons);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+1, __pyx_v_num_cons);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_15, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1213, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
        __pyx_t_1 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_14 = 0;
        __pyx_t_16 = NULL;
      } else {
        __pyx_t_14 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1213, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_16 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext; if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1213, __pyx_L1_error)
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      for (;;) {
        if (likely(!__pyx_t_16)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
            if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_14++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1213, __pyx_L1_error)
            #else
            __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_14); __pyx_t_14++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1213, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            #endif
          } else {
            if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
            #if CYTHON_COMPILING_IN_CPYTHON
            __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_14++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1213, __pyx_L1_error)
            #else
            __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_14); __pyx_t_14++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1213, __pyx_L1_error)
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            #endif
          }
        } else {
          __pyx_t_4 = __pyx_t_16(__pyx_t_1);
          if (unlikely(!__pyx_t_4)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else __PYX_ERR(0, 1213, __pyx_L1_error)
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_4);
        __pyx_t_4 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-57" onclick='toggleDiv(this)'>+<span class="">1214</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">6</span><span class="p">):</span></pre>
<pre class='cython code score-57 '>        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_range); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1214, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__475, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1214, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_15)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_15)) {
          __pyx_t_4 = __pyx_t_15; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_18 = 0;
          __pyx_t_20 = NULL;
        } else {
          __pyx_t_18 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_15); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1214, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          __pyx_t_20 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext; if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1214, __pyx_L1_error)
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        for (;;) {
          if (likely(!__pyx_t_20)) {
            if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
              if (__pyx_t_18 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_15 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15); __pyx_t_18++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1214, __pyx_L1_error)
              #else
              __pyx_t_15 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_18); __pyx_t_18++; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1214, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
              #endif
            } else {
              if (__pyx_t_18 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
              #if CYTHON_COMPILING_IN_CPYTHON
              __pyx_t_15 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_18); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15); __pyx_t_18++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1214, __pyx_L1_error)
              #else
              __pyx_t_15 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_18); __pyx_t_18++; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1214, __pyx_L1_error)
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
              #endif
            }
          } else {
            __pyx_t_15 = __pyx_t_20(__pyx_t_4);
            if (unlikely(!__pyx_t_15)) {
              PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
              if (exc_type) {
                if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                else __PYX_ERR(0, 1214, __pyx_L1_error)
              }
              break;
            }
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_k, __pyx_t_15);
          __pyx_t_15 = 0;
/* … */
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_tuple__475 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_6); if (unlikely(!__pyx_tuple__475)) __PYX_ERR(0, 1214, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__475);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__475);
</pre><pre class="cython line score-36" onclick='toggleDiv(this)'>+<span class="">1215</span>:                     <span class="n">mtx_</span><span class="p">[</span><span class="mf">6</span> <span class="o">*</span> <span class="n">num_nodes</span> <span class="o">+</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">ind</span> <span class="o">+</span></pre>
<pre class='cython code score-36 '>
          /* "OpenAeroStruct/aerostruct.py":1215
 *             for ind in range(num_cons):
 *                 for k in range(6):
 *                     mtx_[6 * num_nodes + 6 * ind +             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                          k, 6 * cons[i_surf] + k] = 1.e9
 *                     mtx_[6 * cons[i_surf] + k, 6 *
 */
          __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_num_nodes); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1215, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_ind); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1215, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_19 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_t_9); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1215, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
          __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_19, __pyx_v_k); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1215, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;

          /* "OpenAeroStruct/aerostruct.py":1215
 *             for ind in range(num_cons):
 *                 for k in range(6):
 *                     mtx_[6 * num_nodes + 6 * ind +             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                          k, 6 * cons[i_surf] + k] = 1.e9
 *                     mtx_[6 * cons[i_surf] + k, 6 *
 */
          __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1215, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1, __pyx_t_19);
          __pyx_t_9 = 0;
          __pyx_t_19 = 0;
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mtx_, __pyx_t_15, __pyx_float_1_e9) &lt; 0)) __PYX_ERR(0, 1215, __pyx_L1_error)
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">1216</span>:                          <span class="n">k</span><span class="p">,</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">cons</span><span class="p">[</span><span class="n">i_surf</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.e9</span></pre>
<pre class='cython code score-17 '>          __pyx_t_19 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_cons, __pyx_v_i_surf); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1216, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_t_19); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1216, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
          __pyx_t_19 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_v_k); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1216, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">1217</span>:                     <span class="n">mtx_</span><span class="p">[</span><span class="mf">6</span> <span class="o">*</span> <span class="n">cons</span><span class="p">[</span><span class="n">i_surf</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="p">,</span> <span class="mf">6</span> <span class="o">*</span></pre>
<pre class='cython code score-35 '>          __pyx_t_15 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_cons, __pyx_v_i_surf); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1217, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_t_15); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1217, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_19, __pyx_v_k); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1217, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
/* … */
          __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_num_nodes); if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1217, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
/* … */
          __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1217, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_15);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_9);
          __pyx_t_15 = 0;
          __pyx_t_9 = 0;
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mtx_, __pyx_t_2, __pyx_float_1_e9) &lt; 0)) __PYX_ERR(0, 1217, __pyx_L1_error)
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-18" onclick='toggleDiv(this)'>+<span class="">1218</span>:                          <span class="n">num_nodes</span> <span class="o">+</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">ind</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.e9</span></pre>
<pre class='cython code score-18 '>          __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_ind); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1218, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_19, __pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1218, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_v_k); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1218, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1219</span>: </pre>
<pre class="cython line score-7" onclick='toggleDiv(this)'>+<span class="">1220</span>:             <span class="n">rhs_</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-7 '>
      /* "OpenAeroStruct/aerostruct.py":1220
 *                          num_nodes + 6 * ind + k] = 1.e9
 * 
 *             rhs_[:] = 0.0             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             rhs_[: 6 * n_fem] = loads_.reshape((6 * n_fem))
 *             rhs[6 * (i_fem + i_surf): 6 *
 */
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_rhs_, __pyx_float_0_0, 0, 0, NULL, NULL, &amp;__pyx_slice__476, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1220, __pyx_L1_error)

  /* "OpenAeroStruct/aerostruct.py":1220
 *                          num_nodes + 6 * ind + k] = 1.e9
 * 
 *             rhs_[:] = 0.0             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             rhs_[: 6 * n_fem] = loads_.reshape((6 * n_fem))
 *             rhs[6 * (i_fem + i_surf): 6 *
 */
  __pyx_slice__476 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__476)) __PYX_ERR(0, 1220, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__476);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__476);
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">1221</span>:             <span class="n">rhs_</span><span class="p">[:</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">n_fem</span><span class="p">]</span> <span class="o">=</span> <span class="n">loads_</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mf">6</span> <span class="o">*</span> <span class="n">n_fem</span><span class="p">))</span></pre>
<pre class='cython code score-40 '>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_loads_, __pyx_n_s_reshape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1221, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_n_fem); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1221, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_9 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        }
      }
      if (!__pyx_t_9) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1221, __pyx_L1_error)
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1221, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_9); __pyx_t_9 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+1, __pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_15, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1221, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_n_fem); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1221, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_rhs_, __pyx_t_1, 0, 0, NULL, &amp;__pyx_t_4, NULL, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1221, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-21" onclick='toggleDiv(this)'>+<span class="">1222</span>:             <span class="n">rhs</span><span class="p">[</span><span class="mf">6</span> <span class="o">*</span> <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">):</span> <span class="mf">6</span> <span class="o">*</span></pre>
<pre class='cython code score-21 '>      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1222, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1222, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_t_1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1222, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_rhs, __pyx_v_rhs_, 0, 0, &amp;__pyx_t_4, &amp;__pyx_t_15, NULL, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1222, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">1223</span>:                 <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">+</span> <span class="n">i_surf</span> <span class="o">+</span> <span class="n">num_cons</span><span class="p">)]</span> <span class="o">=</span> <span class="n">rhs_</span></pre>
<pre class='cython code score-17 '>      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1223, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_i_surf); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1223, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_v_num_cons); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1223, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1224</span>: </pre>
<pre class="cython line score-61" onclick='toggleDiv(this)'>+<span class="">1225</span>:             <span class="n">mtx</span><span class="p">[(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6</span><span class="p">:</span> <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">+</span> <span class="n">num_cons</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6</span><span class="p">,</span></pre>
<pre class='cython code score-61 '>      __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1225, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_15, __pyx_int_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1225, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1225, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_v_num_cons); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1225, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_i_surf); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1225, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_15, __pyx_int_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1225, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_15 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_4, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1225, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
      __pyx_t_1 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_4, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1225, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1225, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_15);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
      __pyx_t_15 = 0;
      __pyx_t_1 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_mtx, __pyx_t_2, __pyx_v_mtx_) &lt; 0)) __PYX_ERR(0, 1225, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_L7:;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">1226</span>:                 <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6</span><span class="p">:</span> <span class="p">(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">+</span> <span class="n">num_cons</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">mtx_</span></pre>
<pre class='cython code score-34 '>      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_int_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1226, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_num_cons); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1226, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_v_i_surf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_int_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1226, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1227</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1228</span>: </pre>
<pre class="cython line score-41" onclick='toggleDiv(this)'>+<span class="">1229</span>:     <span class="n">rhs</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c"># *should this have lower tolerance?</span></pre>
<pre class='cython code score-41 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1229, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_abs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1229, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_rhs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1229, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1229, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rhs);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rhs);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_v_rhs);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1229, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_float_1eneg_6, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1229, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_rhs, __pyx_t_2, __pyx_float_0_) &lt; 0)) __PYX_ERR(0, 1229, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-10" onclick='toggleDiv(this)'>+<span class="">1230</span>:     <span class="k">return</span> <span class="n">mtx</span><span class="p">,</span> <span class="n">rhs</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1230, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mtx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mtx);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_mtx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rhs);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rhs);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_rhs);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1231</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1232</span>: </pre>
<pre class="cython line score-188" onclick='toggleDiv(this)'>+<span class="">1233</span>: <span class="k">def</span> <span class="nf">spatial_beam_FEM</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">Iy</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">cg_x</span><span class="o">=</span><span class="mf">5</span><span class="p">):</span></pre>
<pre class='cython code score-188 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_59spatial_beam_FEM(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_58spatial_beam_FEM[] = "\n    Compute the displacements and rotations by solving the linear system\n    using the structural stiffness matrix.\n\n    Parameters\n    ----------\n    A : array_like\n        Areas for each FEM element.\n    Iy : array_like\n        Mass moment of inertia around the y-axis for each FEM element.\n    Iz : array_like\n        Mass moment of inertia around the z-axis for each FEM element.\n    J : array_like\n        Polar moment of inertia for each FEM element.\n    nodes : array_like\n        Flattened array with coordinates for each FEM node.\n    loads : array_like\n        Flattened array containing the loads applied on the FEM component,\n        computed from the sectional forces.\n\n    Returns\n    -------\n    disp_aug : array_like\n        Augmented displacement array. Obtained by solving the system\n        mtx * disp_aug = rhs, where rhs is a flattened version of loads.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_59spatial_beam_FEM = {"spatial_beam_FEM", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_59spatial_beam_FEM, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_58spatial_beam_FEM};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_59spatial_beam_FEM(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_A = 0;
  PyObject *__pyx_v_Iy = 0;
  PyObject *__pyx_v_Iz = 0;
  PyObject *__pyx_v_J = 0;
  PyObject *__pyx_v_nodes = 0;
  PyObject *__pyx_v_loads = 0;
  PyObject *__pyx_v_aero_ind = 0;
  PyObject *__pyx_v_fem_ind = 0;
  PyObject *__pyx_v_E = 0;
  PyObject *__pyx_v_G = 0;
  PyObject *__pyx_v_cg_x = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("spatial_beam_FEM (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_A,&amp;__pyx_n_s_Iy,&amp;__pyx_n_s_Iz,&amp;__pyx_n_s_J,&amp;__pyx_n_s_nodes,&amp;__pyx_n_s_loads,&amp;__pyx_n_s_aero_ind,&amp;__pyx_n_s_fem_ind,&amp;__pyx_n_s_E,&amp;__pyx_n_s_G,&amp;__pyx_n_s_cg_x,0};
    PyObject* values[11] = {0,0,0,0,0,0,0,0,0,0,0};
    values[10] = ((PyObject *)((PyObject *)__pyx_int_5));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_A)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Iy)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("spatial_beam_FEM", 0, 10, 11, 1); __PYX_ERR(0, 1233, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Iz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("spatial_beam_FEM", 0, 10, 11, 2); __PYX_ERR(0, 1233, __pyx_L3_error)
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_J)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("spatial_beam_FEM", 0, 10, 11, 3); __PYX_ERR(0, 1233, __pyx_L3_error)
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_nodes)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("spatial_beam_FEM", 0, 10, 11, 4); __PYX_ERR(0, 1233, __pyx_L3_error)
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_loads)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("spatial_beam_FEM", 0, 10, 11, 5); __PYX_ERR(0, 1233, __pyx_L3_error)
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aero_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("spatial_beam_FEM", 0, 10, 11, 6); __PYX_ERR(0, 1233, __pyx_L3_error)
        }
        case  7:
        if (likely((values[7] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_fem_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("spatial_beam_FEM", 0, 10, 11, 7); __PYX_ERR(0, 1233, __pyx_L3_error)
        }
        case  8:
        if (likely((values[8] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_E)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("spatial_beam_FEM", 0, 10, 11, 8); __PYX_ERR(0, 1233, __pyx_L3_error)
        }
        case  9:
        if (likely((values[9] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_G)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("spatial_beam_FEM", 0, 10, 11, 9); __PYX_ERR(0, 1233, __pyx_L3_error)
        }
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cg_x);
          if (value) { values[10] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "spatial_beam_FEM") &lt; 0)) __PYX_ERR(0, 1233, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_A = values[0];
    __pyx_v_Iy = values[1];
    __pyx_v_Iz = values[2];
    __pyx_v_J = values[3];
    __pyx_v_nodes = values[4];
    __pyx_v_loads = values[5];
    __pyx_v_aero_ind = values[6];
    __pyx_v_fem_ind = values[7];
    __pyx_v_E = values[8];
    __pyx_v_G = values[9];
    __pyx_v_cg_x = values[10];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("spatial_beam_FEM", 0, 10, 11, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 1233, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.spatial_beam_FEM", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_58spatial_beam_FEM(__pyx_self, __pyx_v_A, __pyx_v_Iy, __pyx_v_Iz, __pyx_v_J, __pyx_v_nodes, __pyx_v_loads, __pyx_v_aero_ind, __pyx_v_fem_ind, __pyx_v_E, __pyx_v_G, __pyx_v_cg_x);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_58spatial_beam_FEM(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_A, PyObject *__pyx_v_Iy, PyObject *__pyx_v_Iz, PyObject *__pyx_v_J, PyObject *__pyx_v_nodes, PyObject *__pyx_v_loads, PyObject *__pyx_v_aero_ind, PyObject *__pyx_v_fem_ind, PyObject *__pyx_v_E, PyObject *__pyx_v_G, PyObject *__pyx_v_cg_x) {
  PyObject *__pyx_v_n_fem = NULL;
  PyObject *__pyx_v_i_fem = NULL;
  PyObject *__pyx_v_num_surf = NULL;
  PyObject *__pyx_v_tot_n_fem = NULL;
  PyObject *__pyx_v_size = NULL;
  PyObject *__pyx_v_elem_IDs = NULL;
  PyObject *__pyx_v_i_surf = NULL;
  PyObject *__pyx_v_row = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_nx = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ny = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_n = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_n_bpts = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_n_panels = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i_bpts = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i_panels = NULL;
  PyObject *__pyx_v_arange = NULL;
  PyObject *__pyx_v_const2 = NULL;
  PyObject *__pyx_v_const_y = NULL;
  PyObject *__pyx_v_const_z = NULL;
  PyObject *__pyx_v_x_gl = NULL;
  PyObject *__pyx_v_K_elem = NULL;
  PyObject *__pyx_v_T_elem = NULL;
  PyObject *__pyx_v_T = NULL;
  PyObject *__pyx_v_num_nodes = NULL;
  PyObject *__pyx_v_num_cons = NULL;
  PyObject *__pyx_v_mtx = NULL;
  PyObject *__pyx_v_rhs = NULL;
  PyObject *__pyx_v_K_a = NULL;
  PyObject *__pyx_v_K_t = NULL;
  PyObject *__pyx_v_K_y = NULL;
  PyObject *__pyx_v_K_z = NULL;
  PyObject *__pyx_v_S_a = NULL;
  PyObject *__pyx_v_S_t = NULL;
  PyObject *__pyx_v_S_y = NULL;
  PyObject *__pyx_v_S_z = NULL;
  PyObject *__pyx_v_cons = NULL;
  PyObject *__pyx_v_dist = NULL;
  PyObject *__pyx_v_idx = NULL;
  PyObject *__pyx_v_disp_aug = NULL;
  PyObject *__pyx_v_splu = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("spatial_beam_FEM", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nodes);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.spatial_beam_FEM", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_size);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_elem_IDs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arange);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_const2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_const_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_const_z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_gl);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_K_elem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_T_elem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_T);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_nodes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_cons);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mtx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rhs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_K_a);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_K_t);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_K_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_K_z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_S_a);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_S_t);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_S_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_S_z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cons);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dist);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_disp_aug);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_splu);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nodes);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__606 = <span class='py_c_api'>PyTuple_Pack</span>(52, __pyx_n_s_A, __pyx_n_s_Iy, __pyx_n_s_Iz, __pyx_n_s_J, __pyx_n_s_nodes, __pyx_n_s_loads, __pyx_n_s_aero_ind, __pyx_n_s_fem_ind, __pyx_n_s_E, __pyx_n_s_G, __pyx_n_s_cg_x, __pyx_n_s_n_fem, __pyx_n_s_i_fem, __pyx_n_s_num_surf, __pyx_n_s_tot_n_fem, __pyx_n_s_size, __pyx_n_s_elem_IDs, __pyx_n_s_i_surf, __pyx_n_s_row, __pyx_n_s_nx, __pyx_n_s_ny, __pyx_n_s_n, __pyx_n_s_n_bpts, __pyx_n_s_n_panels, __pyx_n_s_i, __pyx_n_s_i_bpts, __pyx_n_s_i_panels, __pyx_n_s_arange, __pyx_n_s_const2, __pyx_n_s_const_y, __pyx_n_s_const_z, __pyx_n_s_x_gl, __pyx_n_s_K_elem, __pyx_n_s_T_elem, __pyx_n_s_T, __pyx_n_s_num_nodes, __pyx_n_s_num_cons, __pyx_n_s_mtx, __pyx_n_s_rhs, __pyx_n_s_K_a, __pyx_n_s_K_t, __pyx_n_s_K_y, __pyx_n_s_K_z, __pyx_n_s_S_a, __pyx_n_s_S_t, __pyx_n_s_S_y, __pyx_n_s_S_z, __pyx_n_s_cons, __pyx_n_s_dist, __pyx_n_s_idx, __pyx_n_s_disp_aug, __pyx_n_s_splu); if (unlikely(!__pyx_tuple__606)) __PYX_ERR(0, 1233, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__606);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__606);
  __pyx_codeobj__607 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(11, 0, 52, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__606, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_spatial_beam_FEM, 1233, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__607)) __PYX_ERR(0, 1233, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_59spatial_beam_FEM, 0, __pyx_n_s_spatial_beam_FEM, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__607)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1233, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__608);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_spatial_beam_FEM, __pyx_t_2) &lt; 0) __PYX_ERR(0, 1233, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__608 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_int_5)); if (unlikely(!__pyx_tuple__608)) __PYX_ERR(0, 1233, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__608);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__608);
</pre><pre class="cython line score-0">&#xA0;<span class="">1234</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1235</span>: <span class="sd">    Compute the displacements and rotations by solving the linear system</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1236</span>: <span class="sd">    using the structural stiffness matrix.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1237</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1238</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1239</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1240</span>: <span class="sd">    A : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1241</span>: <span class="sd">        Areas for each FEM element.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1242</span>: <span class="sd">    Iy : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1243</span>: <span class="sd">        Mass moment of inertia around the y-axis for each FEM element.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1244</span>: <span class="sd">    Iz : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1245</span>: <span class="sd">        Mass moment of inertia around the z-axis for each FEM element.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1246</span>: <span class="sd">    J : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1247</span>: <span class="sd">        Polar moment of inertia for each FEM element.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1248</span>: <span class="sd">    nodes : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1249</span>: <span class="sd">        Flattened array with coordinates for each FEM node.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1250</span>: <span class="sd">    loads : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1251</span>: <span class="sd">        Flattened array containing the loads applied on the FEM component,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1252</span>: <span class="sd">        computed from the sectional forces.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1253</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1254</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1255</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1256</span>: <span class="sd">    disp_aug : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1257</span>: <span class="sd">        Augmented displacement array. Obtained by solving the system</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1258</span>: <span class="sd">        mtx * disp_aug = rhs, where rhs is a flattened version of loads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1259</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1260</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-62" onclick='toggleDiv(this)'>+<span class="">1261</span>:     <span class="n">n_fem</span><span class="p">,</span> <span class="n">i_fem</span> <span class="o">=</span> <span class="n">fem_ind</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-62 '>  __pyx_slice__477 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__477)) __PYX_ERR(0, 1261, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__477);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__477);
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fem_ind, __pyx_tuple__478); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1261, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 1261, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1261, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1261, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1261, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_5(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_5(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_4), 2) &lt; 0) __PYX_ERR(0, 1261, __pyx_L1_error)
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 1261, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_n_fem = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_i_fem = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_tuple__478 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_slice__477); if (unlikely(!__pyx_tuple__478)) __PYX_ERR(0, 1261, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__478);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__478);
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1262</span>:     <span class="n">num_surf</span> <span class="o">=</span> <span class="n">fem_ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_fem_ind, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1262, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1262, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_num_surf = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">1263</span>:     <span class="n">tot_n_fem</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1263, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1263, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__479 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__479)) __PYX_ERR(0, 1263, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__479);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__479);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fem_ind, __pyx_tuple__480); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1263, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1263, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1263, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1263, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_tot_n_fem = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_tuple__480 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__479, __pyx_int_0); if (unlikely(!__pyx_tuple__480)) __PYX_ERR(0, 1263, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__480);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__480);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">1264</span>:     <span class="n">size</span> <span class="o">=</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">tot_n_fem</span> <span class="o">+</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">num_surf</span></pre>
<pre class='cython code score-17 '>  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_tot_n_fem); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1264, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_num_surf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1264, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1264, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_size = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-41" onclick='toggleDiv(this)'>+<span class="">1265</span>:     <span class="n">elem_IDs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_n_fem</span> <span class="o">-</span> <span class="n">num_surf</span><span class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-41 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1265, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1265, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_tot_n_fem, __pyx_v_num_surf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1265, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1265, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1265, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (__pyx_t_2) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
  }
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_7, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyInt_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyInt_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_7, ((PyObject *)(&amp;PyInt_Type)));
  __pyx_t_1 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1265, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_elem_IDs = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">1266</span>:     <span class="k">for</span> <span class="n">i_surf</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_6 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_fem_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_fem_ind)) {
    __pyx_t_3 = __pyx_v_fem_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_fem_ind); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1266, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1266, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_7++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1266, __pyx_L1_error)
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1266, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_7++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1266, __pyx_L1_error)
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1266, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_8(__pyx_t_3);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 1266, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_surf, __pyx_t_6);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_6, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1266, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6);
    __pyx_t_6 = __pyx_t_4;
    __pyx_t_4 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-92" onclick='toggleDiv(this)'>+<span class="">1267</span>:         <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_bpts</span><span class="p">,</span> <span class="n">n_panels</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_bpts</span><span class="p">,</span> <span class="n">i_panels</span> <span class="o">=</span> <span class="n">aero_ind</span><span class="p">[</span><span class="n">i_surf</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-92 '>    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1267, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i_surf);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i_surf);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_i_surf);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__481);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__481);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_slice__481);
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1267, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 8)) {
        if (size &gt; 8) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(8);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 1267, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
        __pyx_t_13 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 6); 
        __pyx_t_14 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 7); 
      } else {
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
        __pyx_t_13 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 6); 
        __pyx_t_14 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 7); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[8] = {&amp;__pyx_t_4,&amp;__pyx_t_2,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_13,&amp;__pyx_t_14};
        for (i=0; i &lt; 8; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 1267, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[8] = {&amp;__pyx_t_4,&amp;__pyx_t_2,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_13,&amp;__pyx_t_14};
      __pyx_t_15 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1267, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_5 = Py_TYPE(__pyx_t_15)-&gt;tp_iternext;
      for (index=0; index &lt; 8; index++) {
        PyObject* item = __pyx_t_5(__pyx_t_15); if (unlikely(!item)) goto __pyx_L7_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_15), 8) &lt; 0) __PYX_ERR(0, 1267, __pyx_L1_error)
      __pyx_t_5 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      goto __pyx_L8_unpacking_done;
      __pyx_L7_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_5 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 1267, __pyx_L1_error)
      __pyx_L8_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_nx, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ny, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n, __pyx_t_9);
    __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_bpts, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_panels, __pyx_t_11);
    __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_12);
    __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_bpts, __pyx_t_13);
    __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_panels, __pyx_t_14);
    __pyx_t_14 = 0;
/* … */
  __pyx_slice__481 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__481)) __PYX_ERR(0, 1267, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__481);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__481);
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">1268</span>:         <span class="n">n_fem</span><span class="p">,</span> <span class="n">i_fem</span> <span class="o">=</span> <span class="n">row</span></pre>
<pre class='cython code score-47 '>    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_row))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_row))) {
      PyObject* sequence = __pyx_v_row;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 1268, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_14 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_14 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1268, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_14 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1268, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      #endif
    } else {
      Py_ssize_t index = -1;
      __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_row); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1268, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_5 = Py_TYPE(__pyx_t_13)-&gt;tp_iternext;
      index = 0; __pyx_t_1 = __pyx_t_5(__pyx_t_13); if (unlikely(!__pyx_t_1)) goto __pyx_L9_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      index = 1; __pyx_t_14 = __pyx_t_5(__pyx_t_13); if (unlikely(!__pyx_t_14)) goto __pyx_L9_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_13), 2) &lt; 0) __PYX_ERR(0, 1268, __pyx_L1_error)
      __pyx_t_5 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      goto __pyx_L10_unpacking_done;
      __pyx_L9_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_5 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 1268, __pyx_L1_error)
      __pyx_L10_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_n_fem, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_i_fem, __pyx_t_14);
    __pyx_t_14 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">1269</span>:         <span class="n">arange</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_fem</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">i_fem</span></pre>
<pre class='cython code score-38 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1269, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_arange); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1269, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_n_fem, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1269, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_12 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
      }
    }
    if (!__pyx_t_12) {
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_13, __pyx_t_1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1269, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    } else {
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1269, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_11, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1269, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, __pyx_v_i_fem); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1269, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_arange, __pyx_t_13);
    __pyx_t_13 = 0;
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">1270</span>:         <span class="n">elem_IDs</span><span class="p">[</span><span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span><span class="p">:</span> <span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">arange</span></pre>
<pre class='cython code score-40 '>    __pyx_t_13 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1270, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_14 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1270, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, __pyx_v_n_fem); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1270, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_11, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1270, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_13, __pyx_t_14, Py_None); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1270, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1270, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1, __pyx_int_0);
    __pyx_t_11 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_elem_IDs, __pyx_t_14, __pyx_v_arange) &lt; 0)) __PYX_ERR(0, 1270, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-43" onclick='toggleDiv(this)'>+<span class="">1271</span>:         <span class="n">elem_IDs</span><span class="p">[</span><span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span><span class="p">:</span> <span class="n">i_fem</span> <span class="o">-</span> <span class="n">i_surf</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">arange</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-43 '>    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_arange, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1271, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1271, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1271, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_13, __pyx_v_n_fem); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1271, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1271, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_11, __pyx_t_13, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1271, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1271, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1, __pyx_int_1);
    __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_elem_IDs, __pyx_t_13, __pyx_t_14) &lt; 0)) __PYX_ERR(0, 1271, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1272</span>:         <span class="n">elem_IDs</span> <span class="o">=</span> <span class="n">elem_IDs</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_elem_IDs);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_elem_IDs, __pyx_v_elem_IDs);
</pre><pre class="cython line score-23" onclick='toggleDiv(this)'>+<span class="">1273</span>:     <span class="n">const2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span></pre>
<pre class='cython code score-23 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1273, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1273, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_t_13 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1273, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 1, __pyx_t_14);
  __pyx_t_6 = 0;
  __pyx_t_14 = 0;
  __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1273, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_13);
  __pyx_t_13 = 0;
/* … */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_14, __pyx_t_13); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1273, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_v_const2 = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">1274</span>:         <span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">],</span></pre>
<pre class='cython code score-9 '>  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1274, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_neg_1);
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">1275</span>:         <span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span></pre>
<pre class='cython code score-9 '>  __pyx_t_14 = <span class='py_c_api'>PyList_New</span>(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1275, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 0, __pyx_int_neg_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 1, __pyx_int_1);
</pre><pre class="cython line score-13" onclick='toggleDiv(this)'>+<span class="">1276</span>:     <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>  __pyx_t_13 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1276, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1276, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) __PYX_ERR(0, 1276, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1277</span>:     <span class="n">const_y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span></pre>
<pre class='cython code score-25 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1277, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1277, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_t_11 = <span class='py_c_api'>PyList_New</span>(4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1277, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_1);
  __pyx_t_6 = 0;
  __pyx_t_14 = 0;
  __pyx_t_3 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1277, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_11);
  __pyx_t_11 = 0;
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_1, __pyx_t_11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1277, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_v_const_y = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-13" onclick='toggleDiv(this)'>+<span class="">1278</span>:         <span class="p">[</span><span class="mf">12</span><span class="p">,</span> <span class="o">-</span><span class="mf">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">12</span><span class="p">,</span> <span class="o">-</span><span class="mf">6</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1278, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_12);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_neg_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_neg_12);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_int_neg_6);
</pre><pre class="cython line score-13" onclick='toggleDiv(this)'>+<span class="">1279</span>:         <span class="p">[</span><span class="o">-</span><span class="mf">6</span><span class="p">,</span> <span class="mf">4</span><span class="p">,</span> <span class="mf">6</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>  __pyx_t_14 = <span class='py_c_api'>PyList_New</span>(4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1279, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 0, __pyx_int_neg_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 1, __pyx_int_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 2, __pyx_int_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 3, __pyx_int_2);
</pre><pre class="cython line score-13" onclick='toggleDiv(this)'>+<span class="">1280</span>:         <span class="p">[</span><span class="o">-</span><span class="mf">12</span><span class="p">,</span> <span class="mf">6</span><span class="p">,</span> <span class="mf">12</span><span class="p">,</span> <span class="mf">6</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1280, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_neg_12);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_12);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_int_6);
</pre><pre class="cython line score-13" onclick='toggleDiv(this)'>+<span class="">1281</span>:         <span class="p">[</span><span class="o">-</span><span class="mf">6</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">6</span><span class="p">,</span> <span class="mf">4</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1281, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_neg_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_4);
</pre><pre class="cython line score-13" onclick='toggleDiv(this)'>+<span class="">1282</span>:     <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>  __pyx_t_11 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1282, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1282, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) __PYX_ERR(0, 1282, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-25" onclick='toggleDiv(this)'>+<span class="">1283</span>:     <span class="n">const_z</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span></pre>
<pre class='cython code score-25 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1283, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1283, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1283, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_14);
  __pyx_t_3 = 0;
  __pyx_t_1 = 0;
  __pyx_t_13 = 0;
  __pyx_t_14 = 0;
  __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1283, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_6);
  __pyx_t_6 = 0;
/* … */
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_14, __pyx_t_6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1283, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_const_z = __pyx_t_13;
  __pyx_t_13 = 0;
</pre><pre class="cython line score-13" onclick='toggleDiv(this)'>+<span class="">1284</span>:         <span class="p">[</span><span class="mf">12</span><span class="p">,</span> <span class="mf">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">12</span><span class="p">,</span> <span class="mf">6</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1284, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_12);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_neg_12);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_int_6);
</pre><pre class="cython line score-13" onclick='toggleDiv(this)'>+<span class="">1285</span>:         <span class="p">[</span><span class="mf">6</span><span class="p">,</span> <span class="mf">4</span><span class="p">,</span> <span class="o">-</span><span class="mf">6</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1285, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_neg_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_2);
</pre><pre class="cython line score-13" onclick='toggleDiv(this)'>+<span class="">1286</span>:         <span class="p">[</span><span class="o">-</span><span class="mf">12</span><span class="p">,</span> <span class="o">-</span><span class="mf">6</span><span class="p">,</span> <span class="mf">12</span><span class="p">,</span> <span class="o">-</span><span class="mf">6</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>  __pyx_t_13 = <span class='py_c_api'>PyList_New</span>(4); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1286, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 0, __pyx_int_neg_12);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 1, __pyx_int_neg_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 2, __pyx_int_12);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 3, __pyx_int_neg_6);
</pre><pre class="cython line score-13" onclick='toggleDiv(this)'>+<span class="">1287</span>:         <span class="p">[</span><span class="mf">6</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">6</span><span class="p">,</span> <span class="mf">4</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>  __pyx_t_14 = <span class='py_c_api'>PyList_New</span>(4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1287, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 0, __pyx_int_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 1, __pyx_int_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 2, __pyx_int_neg_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_14, 3, __pyx_int_4);
</pre><pre class="cython line score-13" onclick='toggleDiv(this)'>+<span class="">1288</span>:     <span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>  __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1288, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1288, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_13) &lt; 0) __PYX_ERR(0, 1288, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-40" onclick='toggleDiv(this)'>+<span class="">1289</span>:     <span class="n">x_gl</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1289, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1289, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_13 = <span class='py_c_api'>PyList_New</span>(3); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1289, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 0, __pyx_int_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 1, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_13, 2, __pyx_int_0);
  __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1289, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_13);
  __pyx_t_13 = 0;
  __pyx_t_13 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1289, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1289, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_dtype, __pyx_t_11) &lt; 0) __PYX_ERR(0, 1289, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_14, __pyx_t_13); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1289, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_v_x_gl = __pyx_t_11;
  __pyx_t_11 = 0;
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1290</span>:     <span class="n">K_elem</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">12</span><span class="p">,</span> <span class="mf">12</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1290, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_zeros); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1290, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
  __pyx_tuple__482 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_12, __pyx_int_12); if (unlikely(!__pyx_tuple__482)) __PYX_ERR(0, 1290, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__482);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__482);
  __pyx_t_11 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1290, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1290, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_14) &lt; 0) __PYX_ERR(0, 1290, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_tuple__483, __pyx_t_11); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1290, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_v_K_elem = __pyx_t_14;
  __pyx_t_14 = 0;
  __pyx_tuple__483 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__482); if (unlikely(!__pyx_tuple__483)) __PYX_ERR(0, 1290, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__483);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__483);
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1291</span>:     <span class="n">T_elem</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">12</span><span class="p">,</span> <span class="mf">12</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1291, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_zeros); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1291, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
/* … */
  __pyx_tuple__484 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_12, __pyx_int_12); if (unlikely(!__pyx_tuple__484)) __PYX_ERR(0, 1291, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__484);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__484);
  __pyx_t_14 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1291, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1291, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_14, __pyx_n_s_dtype, __pyx_t_13) &lt; 0) __PYX_ERR(0, 1291, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_tuple__485, __pyx_t_14); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1291, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_v_T_elem = __pyx_t_13;
  __pyx_t_13 = 0;
  __pyx_tuple__485 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__484); if (unlikely(!__pyx_tuple__485)) __PYX_ERR(0, 1291, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__485);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__485);
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1292</span>:     <span class="n">T</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">3</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1292, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1292, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
/* … */
  __pyx_tuple__486 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_3, __pyx_int_3); if (unlikely(!__pyx_tuple__486)) __PYX_ERR(0, 1292, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__486);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__486);
  __pyx_t_13 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1292, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1292, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_dtype, __pyx_t_11) &lt; 0) __PYX_ERR(0, 1292, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_14, __pyx_tuple__487, __pyx_t_13); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1292, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_v_T = __pyx_t_11;
  __pyx_t_11 = 0;
  __pyx_tuple__487 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__486); if (unlikely(!__pyx_tuple__487)) __PYX_ERR(0, 1292, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__487);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__487);
</pre><pre class="cython line score-1" onclick='toggleDiv(this)'>+<span class="">1293</span>:     <span class="n">num_nodes</span> <span class="o">=</span> <span class="n">tot_n_fem</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_n_fem);
  __pyx_v_num_nodes = __pyx_v_tot_n_fem;
</pre><pre class="cython line score-1" onclick='toggleDiv(this)'>+<span class="">1294</span>:     <span class="n">num_cons</span> <span class="o">=</span> <span class="n">num_surf</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_surf);
  __pyx_v_num_cons = __pyx_v_num_surf;
</pre><pre class="cython line score-18" onclick='toggleDiv(this)'>+<span class="">1295</span>:     <span class="n">size</span> <span class="o">=</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">num_nodes</span> <span class="o">+</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">num_cons</span></pre>
<pre class='cython code score-18 '>  __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_num_nodes); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1295, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_num_cons); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1295, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_11, __pyx_t_13); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1295, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_size, __pyx_t_14);
  __pyx_t_14 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">1296</span>:     <span class="n">mtx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1296, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_zeros); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1296, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1296, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_size);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_size);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_v_size);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_size);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_size);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1, __pyx_v_size);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1296, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_14);
  __pyx_t_14 = 0;
  __pyx_t_14 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1296, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1296, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_14, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) __PYX_ERR(0, 1296, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_11, __pyx_t_14); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1296, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_v_mtx = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1297</span>:     <span class="n">rhs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1297, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1297, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1297, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_size);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_size);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_size);
  __pyx_t_11 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1297, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1297, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_13) &lt; 0) __PYX_ERR(0, 1297, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_14, __pyx_t_6, __pyx_t_11); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1297, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_v_rhs = __pyx_t_13;
  __pyx_t_13 = 0;
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1298</span>:     <span class="n">K_a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1298, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1298, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
/* … */
  __pyx_tuple__488 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_2); if (unlikely(!__pyx_tuple__488)) __PYX_ERR(0, 1298, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__488);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__488);
  __pyx_t_13 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1298, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1298, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) __PYX_ERR(0, 1298, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_tuple__489, __pyx_t_13); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1298, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_v_K_a = __pyx_t_6;
  __pyx_t_6 = 0;
  __pyx_tuple__489 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__488); if (unlikely(!__pyx_tuple__489)) __PYX_ERR(0, 1298, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__489);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__489);
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1299</span>:     <span class="n">K_t</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1299, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1299, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_tuple__490 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_2); if (unlikely(!__pyx_tuple__490)) __PYX_ERR(0, 1299, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__490);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__490);
  __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1299, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1299, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_11) &lt; 0) __PYX_ERR(0, 1299, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_tuple__491, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1299, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_K_t = __pyx_t_11;
  __pyx_t_11 = 0;
  __pyx_tuple__491 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__490); if (unlikely(!__pyx_tuple__491)) __PYX_ERR(0, 1299, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__491);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__491);
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1300</span>:     <span class="n">K_y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1300, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1300, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
  __pyx_tuple__492 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_4, __pyx_int_4); if (unlikely(!__pyx_tuple__492)) __PYX_ERR(0, 1300, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__492);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__492);
  __pyx_t_11 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1300, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1300, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_13) &lt; 0) __PYX_ERR(0, 1300, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__493, __pyx_t_11); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1300, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_v_K_y = __pyx_t_13;
  __pyx_t_13 = 0;
  __pyx_tuple__493 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__492); if (unlikely(!__pyx_tuple__493)) __PYX_ERR(0, 1300, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__493);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__493);
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1301</span>:     <span class="n">K_z</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1301, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1301, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
/* … */
  __pyx_tuple__494 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_4, __pyx_int_4); if (unlikely(!__pyx_tuple__494)) __PYX_ERR(0, 1301, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__494);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__494);
  __pyx_t_13 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1301, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1301, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) __PYX_ERR(0, 1301, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_tuple__495, __pyx_t_13); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1301, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_v_K_z = __pyx_t_6;
  __pyx_t_6 = 0;
  __pyx_tuple__495 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__494); if (unlikely(!__pyx_tuple__495)) __PYX_ERR(0, 1301, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__495);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__495);
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1302</span>:     <span class="n">S_a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">12</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1302, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1302, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_tuple__496 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_12); if (unlikely(!__pyx_tuple__496)) __PYX_ERR(0, 1302, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__496);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__496);
  __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1302, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1302, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_11) &lt; 0) __PYX_ERR(0, 1302, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_tuple__497, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1302, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_S_a = __pyx_t_11;
  __pyx_t_11 = 0;
  __pyx_tuple__497 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__496); if (unlikely(!__pyx_tuple__497)) __PYX_ERR(0, 1302, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__497);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__497);
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">1303</span>:     <span class="n">S_a</span><span class="p">[(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">6</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.</span></pre>
<pre class='cython code score-20 '>  __pyx_tuple__498 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_1); if (unlikely(!__pyx_tuple__498)) __PYX_ERR(0, 1303, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__498);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__498);
  __pyx_tuple__499 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_6); if (unlikely(!__pyx_tuple__499)) __PYX_ERR(0, 1303, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__499);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__499);
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_S_a, __pyx_tuple__500, __pyx_float_1_) &lt; 0)) __PYX_ERR(0, 1303, __pyx_L1_error)
  __pyx_tuple__500 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_tuple__498, __pyx_tuple__499); if (unlikely(!__pyx_tuple__500)) __PYX_ERR(0, 1303, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__500);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__500);
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1304</span>:     <span class="n">S_t</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">12</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1304, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1304, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
  __pyx_tuple__501 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_12); if (unlikely(!__pyx_tuple__501)) __PYX_ERR(0, 1304, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__501);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__501);
  __pyx_t_11 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1304, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1304, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_13) &lt; 0) __PYX_ERR(0, 1304, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__502, __pyx_t_11); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1304, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_v_S_t = __pyx_t_13;
  __pyx_t_13 = 0;
  __pyx_tuple__502 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__501); if (unlikely(!__pyx_tuple__502)) __PYX_ERR(0, 1304, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__502);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__502);
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">1305</span>:     <span class="n">S_t</span><span class="p">[(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="mf">9</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.</span></pre>
<pre class='cython code score-20 '>  __pyx_tuple__503 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_1); if (unlikely(!__pyx_tuple__503)) __PYX_ERR(0, 1305, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__503);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__503);
  __pyx_tuple__504 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_3, __pyx_int_9); if (unlikely(!__pyx_tuple__504)) __PYX_ERR(0, 1305, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__504);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__504);
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_S_t, __pyx_tuple__505, __pyx_float_1_) &lt; 0)) __PYX_ERR(0, 1305, __pyx_L1_error)
  __pyx_tuple__505 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_tuple__503, __pyx_tuple__504); if (unlikely(!__pyx_tuple__505)) __PYX_ERR(0, 1305, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__505);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__505);
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1306</span>:     <span class="n">S_y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">4</span><span class="p">,</span> <span class="mf">12</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_zeros); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
/* … */
  __pyx_tuple__506 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_4, __pyx_int_12); if (unlikely(!__pyx_tuple__506)) __PYX_ERR(0, 1306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__506);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__506);
  __pyx_t_13 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) __PYX_ERR(0, 1306, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_tuple__507, __pyx_t_13); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_v_S_y = __pyx_t_6;
  __pyx_t_6 = 0;
  __pyx_tuple__507 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__506); if (unlikely(!__pyx_tuple__507)) __PYX_ERR(0, 1306, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__507);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__507);
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">1307</span>:     <span class="n">S_y</span><span class="p">[(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="p">(</span><span class="mf">2</span><span class="p">,</span> <span class="mf">4</span><span class="p">,</span> <span class="mf">8</span><span class="p">,</span> <span class="mf">10</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.</span></pre>
<pre class='cython code score-20 '>  __pyx_tuple__508 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_int_0, __pyx_int_1, __pyx_int_2, __pyx_int_3); if (unlikely(!__pyx_tuple__508)) __PYX_ERR(0, 1307, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__508);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__508);
  __pyx_tuple__509 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_int_2, __pyx_int_4, __pyx_int_8, __pyx_int_10); if (unlikely(!__pyx_tuple__509)) __PYX_ERR(0, 1307, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__509);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__509);
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_S_y, __pyx_tuple__510, __pyx_float_1_) &lt; 0)) __PYX_ERR(0, 1307, __pyx_L1_error)
  __pyx_tuple__510 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_tuple__508, __pyx_tuple__509); if (unlikely(!__pyx_tuple__510)) __PYX_ERR(0, 1307, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__510);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__510);
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1308</span>:     <span class="n">S_z</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">4</span><span class="p">,</span> <span class="mf">12</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1308, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1308, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_tuple__511 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_4, __pyx_int_12); if (unlikely(!__pyx_tuple__511)) __PYX_ERR(0, 1308, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__511);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__511);
  __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1308, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_DTYPE); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1308, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_11) &lt; 0) __PYX_ERR(0, 1308, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_tuple__512, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1308, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_S_z = __pyx_t_11;
  __pyx_t_11 = 0;
  __pyx_tuple__512 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__511); if (unlikely(!__pyx_tuple__512)) __PYX_ERR(0, 1308, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__512);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__512);
</pre><pre class="cython line score-20" onclick='toggleDiv(this)'>+<span class="">1309</span>:     <span class="n">S_z</span><span class="p">[(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="mf">5</span><span class="p">,</span> <span class="mf">7</span><span class="p">,</span> <span class="mf">11</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.</span></pre>
<pre class='cython code score-20 '>  __pyx_tuple__513 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_int_0, __pyx_int_1, __pyx_int_2, __pyx_int_3); if (unlikely(!__pyx_tuple__513)) __PYX_ERR(0, 1309, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__513);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__513);
  __pyx_tuple__514 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_int_1, __pyx_int_5, __pyx_int_7, __pyx_int_11); if (unlikely(!__pyx_tuple__514)) __PYX_ERR(0, 1309, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__514);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__514);
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_S_z, __pyx_tuple__515, __pyx_float_1_) &lt; 0)) __PYX_ERR(0, 1309, __pyx_L1_error)
  __pyx_tuple__515 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_tuple__513, __pyx_tuple__514); if (unlikely(!__pyx_tuple__515)) __PYX_ERR(0, 1309, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__515);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__515);
</pre><pre class="cython line score-29" onclick='toggleDiv(this)'>+<span class="">1310</span>:     <span class="n">cons</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_surf</span><span class="p">))</span></pre>
<pre class='cython code score-29 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1310, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1310, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_13, __pyx_v_num_surf); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1310, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  } else {
    __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1310, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_6); __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_surf);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_surf);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+1, __pyx_v_num_surf);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_14, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1310, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_v_cons = __pyx_t_11;
  __pyx_t_11 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1311</span>:     <span class="c"># find constrained nodes based on closeness to specified cg point</span></pre>
<pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">1312</span>:     <span class="k">for</span> <span class="n">i_surf</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_11 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_fem_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_fem_ind)) {
    __pyx_t_13 = __pyx_v_fem_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13); __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_fem_ind); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1312, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_8 = Py_TYPE(__pyx_t_13)-&gt;tp_iternext; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1312, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_13))) {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_13)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_14 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_13, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14); __pyx_t_7++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1312, __pyx_L1_error)
        #else
        __pyx_t_14 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_13, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1312, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        #endif
      } else {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_13)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_14 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_13, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14); __pyx_t_7++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1312, __pyx_L1_error)
        #else
        __pyx_t_14 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_13, __pyx_t_7); __pyx_t_7++; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1312, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        #endif
      }
    } else {
      __pyx_t_14 = __pyx_t_8(__pyx_t_13);
      if (unlikely(!__pyx_t_14)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 1312, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_14);
    __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_surf, __pyx_t_11);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_11, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1312, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11);
    __pyx_t_11 = __pyx_t_14;
    __pyx_t_14 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">1313</span>:         <span class="n">n_fem</span><span class="p">,</span> <span class="n">i_fem</span> <span class="o">=</span> <span class="n">row</span></pre>
<pre class='cython code score-47 '>    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_row))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_row))) {
      PyObject* sequence = __pyx_v_row;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 1313, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_14 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_14 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      #else
      __pyx_t_14 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1313, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1313, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      #endif
    } else {
      Py_ssize_t index = -1;
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_row); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1313, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;
      index = 0; __pyx_t_14 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_14)) goto __pyx_L13_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      index = 1; __pyx_t_6 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_6)) goto __pyx_L13_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_1), 2) &lt; 0) __PYX_ERR(0, 1313, __pyx_L1_error)
      __pyx_t_5 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L14_unpacking_done;
      __pyx_L13_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_5 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 1313, __pyx_L1_error)
      __pyx_L14_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_n_fem, __pyx_t_14);
    __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_i_fem, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-9" onclick='toggleDiv(this)'>+<span class="">1314</span>:         <span class="n">nodes</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">i_fem</span><span class="p">:</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span><span class="p">]</span></pre>
<pre class='cython code score-9 '>    __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1314, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_nodes, 0, 0, &amp;__pyx_v_i_fem, &amp;__pyx_t_6, NULL, 0, 0, 1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1314, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_nodes, __pyx_t_14);
    __pyx_t_14 = 0;
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">1315</span>:         <span class="n">dist</span> <span class="o">=</span> <span class="n">nodes</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cg_x</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-47 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1315, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1315, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1315, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cg_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cg_x);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_cg_x);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_0);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_0);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1315, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    } else {
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1315, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_3); __pyx_t_3 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+1, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_12, NULL); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1315, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_nodes, __pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1315, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dist, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-50" onclick='toggleDiv(this)'>+<span class="">1316</span>:         <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span></pre>
<pre class='cython code score-50 '>    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1316, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_linalg); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1316, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_norm); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1316, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1316, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dist);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dist);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_v_dist);
    __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1316, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_axis, __pyx_int_1) &lt; 0) __PYX_ERR(0, 1316, __pyx_L1_error)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_14, __pyx_t_12, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1316, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_argmin); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1316, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1316, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1316, __pyx_L1_error)
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_idx, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1317</span>:         <span class="n">cons</span><span class="p">[</span><span class="n">i_surf</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-5 '>    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_cons, __pyx_v_i_surf, __pyx_v_idx) &lt; 0)) __PYX_ERR(0, 1317, __pyx_L1_error)
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1318</span>:     <span class="n">mtx</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> \</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_mtx, __pyx_t_13);
  __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_rhs, __pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1319</span>:         <span class="n">assemble_FEM_system</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">Iy</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">loads</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_assemble_FEM_system); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1319, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
</pre><pre class="cython line score-0">&#xA0;<span class="">1320</span>:                             <span class="n">K_a</span><span class="p">,</span> <span class="n">K_t</span><span class="p">,</span> <span class="n">K_y</span><span class="p">,</span> <span class="n">K_z</span><span class="p">,</span> <span class="n">elem_IDs</span><span class="p">,</span> <span class="n">cons</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">x_gl</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1321</span>:                             <span class="n">K_elem</span><span class="p">,</span> <span class="n">S_a</span><span class="p">,</span> <span class="n">S_t</span><span class="p">,</span> <span class="n">S_y</span><span class="p">,</span> <span class="n">S_z</span><span class="p">,</span> <span class="n">T_elem</span><span class="p">,</span> <span class="n">const2</span><span class="p">,</span> <span class="n">const_y</span><span class="p">,</span></pre>
<pre class="cython line score-129" onclick='toggleDiv(this)'>+<span class="">1322</span>:                             <span class="n">const_z</span><span class="p">,</span> <span class="n">n_fem</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">mtx</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></pre>
<pre class='cython code score-129 '>  __pyx_t_1 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(31+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1319, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (__pyx_t_1) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aero_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_aero_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_7, __pyx_v_aero_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fem_ind);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fem_ind);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_7, __pyx_v_fem_ind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nodes);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nodes);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_7, __pyx_v_nodes);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_A);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_A);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3+__pyx_t_7, __pyx_v_A);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_J);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_J);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 4+__pyx_t_7, __pyx_v_J);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Iy);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Iy);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 5+__pyx_t_7, __pyx_v_Iy);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Iz);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Iz);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 6+__pyx_t_7, __pyx_v_Iz);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_loads);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_loads);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 7+__pyx_t_7, __pyx_v_loads);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_a);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_a);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 8+__pyx_t_7, __pyx_v_K_a);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_t);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_t);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 9+__pyx_t_7, __pyx_v_K_t);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_y);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 10+__pyx_t_7, __pyx_v_K_y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_z);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_z);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 11+__pyx_t_7, __pyx_v_K_z);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_elem_IDs);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_elem_IDs);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 12+__pyx_t_7, __pyx_v_elem_IDs);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cons);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cons);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 13+__pyx_t_7, __pyx_v_cons);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_E);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_E);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 14+__pyx_t_7, __pyx_v_E);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_G);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_G);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 15+__pyx_t_7, __pyx_v_G);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_gl);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x_gl);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 16+__pyx_t_7, __pyx_v_x_gl);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_T);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_T);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 17+__pyx_t_7, __pyx_v_T);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_K_elem);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_K_elem);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 18+__pyx_t_7, __pyx_v_K_elem);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_a);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_a);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 19+__pyx_t_7, __pyx_v_S_a);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_t);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_t);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 20+__pyx_t_7, __pyx_v_S_t);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_y);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 21+__pyx_t_7, __pyx_v_S_y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_S_z);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_S_z);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 22+__pyx_t_7, __pyx_v_S_z);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_T_elem);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_T_elem);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 23+__pyx_t_7, __pyx_v_T_elem);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_const2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_const2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 24+__pyx_t_7, __pyx_v_const2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_const_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_const_y);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 25+__pyx_t_7, __pyx_v_const_y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_const_z);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_const_z);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 26+__pyx_t_7, __pyx_v_const_z);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n_fem);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n_fem);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 27+__pyx_t_7, __pyx_v_n_fem);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_size);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_size);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 28+__pyx_t_7, __pyx_v_size);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mtx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mtx);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 29+__pyx_t_7, __pyx_v_mtx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rhs);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rhs);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 30+__pyx_t_7, __pyx_v_rhs);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_6, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1319, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_11))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11))) {
    PyObject* sequence = __pyx_t_11;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 1318, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_13 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_13 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    #else
    __pyx_t_13 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1318, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1318, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1318, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_5 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;
    index = 0; __pyx_t_13 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_13)) goto __pyx_L15_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    index = 1; __pyx_t_6 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_6)) goto __pyx_L15_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_1), 2) &lt; 0) __PYX_ERR(0, 1318, __pyx_L1_error)
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L16_unpacking_done;
    __pyx_L15_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 1318, __pyx_L1_error)
    __pyx_L16_unpacking_done:;
  }
</pre><pre class="cython line score-14" onclick='toggleDiv(this)'>+<span class="">1323</span>:     <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mtx</span><span class="p">)</span> <span class="o">==</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span></pre>
<pre class='cython code score-14 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1323, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_ndarray); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1323, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)Py_TYPE(__pyx_v_mtx)), __pyx_t_6, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_11); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1323, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_11); if (unlikely(__pyx_t_16 &lt; 0)) __PYX_ERR(0, 1323, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (__pyx_t_16) {
/* … */
    goto __pyx_L17;
  }
</pre><pre class="cython line score-32" onclick='toggleDiv(this)'>+<span class="">1324</span>:         <span class="n">disp_aug</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">mtx</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1324, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_linalg); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1324, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_solve); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1324, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_7 = 1;
      }
    }
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1324, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (__pyx_t_13) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_13); __pyx_t_13 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mtx);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mtx);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+__pyx_t_7, __pyx_v_mtx);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rhs);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rhs);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1+__pyx_t_7, __pyx_v_rhs);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_1, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1324, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_disp_aug = __pyx_t_11;
    __pyx_t_11 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1325</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-35" onclick='toggleDiv(this)'>+<span class="">1326</span>:         <span class="n">splu</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">splu</span><span class="p">(</span><span class="n">mtx</span><span class="p">)</span></pre>
<pre class='cython code score-35 '>  /*else*/ {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_scipy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1326, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_sparse); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1326, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linalg); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1326, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_splu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1326, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_mtx); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1326, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    } else {
      __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1326, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_6); __pyx_t_6 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mtx);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mtx);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+1, __pyx_v_mtx);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_13, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1326, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_splu = __pyx_t_11;
    __pyx_t_11 = 0;
</pre><pre class="cython line score-26" onclick='toggleDiv(this)'>+<span class="">1327</span>:         <span class="n">disp_aug</span> <span class="o">=</span> <span class="n">splu</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_splu, __pyx_n_s_solve); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1327, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_13 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_13) {
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_rhs); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1327, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    } else {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1327, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_13); __pyx_t_13 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rhs);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_rhs);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_v_rhs);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1327, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_disp_aug = __pyx_t_11;
    __pyx_t_11 = 0;
  }
  __pyx_L17:;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1328</span>:     <span class="k">return</span> <span class="n">disp_aug</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_disp_aug);
  __pyx_r = __pyx_v_disp_aug;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1329</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1330</span>: </pre>
<pre class="cython line score-63" onclick='toggleDiv(this)'>+<span class="">1331</span>: <span class="k">def</span> <span class="nf">spatial_beam_disp</span><span class="p">(</span><span class="n">disp_aug</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">):</span></pre>
<pre class='cython code score-63 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_61spatial_beam_disp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_60spatial_beam_disp[] = "\n    Select displacements from augmented vector.\n\n    The solution to the linear system has additional results due to the\n    constraints on the FEM model. The displacements from this portion of\n    the linear system is not needed, so we select only the relevant\n    portion of the displacements for further calculations.\n\n    Parameters\n    ----------\n    disp_aug : array_like\n        Augmented displacement array. Obtained by solving the system\n        mtx * disp_aug = rhs, where rhs is a flattened version of loads.\n\n    Returns\n    -------\n    disp : array_like\n        Actual displacement array formed by truncating disp_aug.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_61spatial_beam_disp = {"spatial_beam_disp", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_61spatial_beam_disp, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_60spatial_beam_disp};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_61spatial_beam_disp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_disp_aug = 0;
  PyObject *__pyx_v_fem_ind = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("spatial_beam_disp (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_disp_aug,&amp;__pyx_n_s_fem_ind,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_disp_aug)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_fem_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("spatial_beam_disp", 1, 2, 2, 1); __PYX_ERR(0, 1331, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "spatial_beam_disp") &lt; 0)) __PYX_ERR(0, 1331, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_disp_aug = values[0];
    __pyx_v_fem_ind = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("spatial_beam_disp", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 1331, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.spatial_beam_disp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_60spatial_beam_disp(__pyx_self, __pyx_v_disp_aug, __pyx_v_fem_ind);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_60spatial_beam_disp(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_disp_aug, PyObject *__pyx_v_fem_ind) {
  PyObject *__pyx_v_num_surf = NULL;
  PyObject *__pyx_v_tot_n_fem = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_size = NULL;
  PyObject *__pyx_v_disp = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_arange = NULL;
  PyObject *__pyx_v_i_surf = NULL;
  PyObject *__pyx_v_row = NULL;
  PyObject *__pyx_v_n_fem = NULL;
  PyObject *__pyx_v_i_fem = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("spatial_beam_disp", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.spatial_beam_disp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_size);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_disp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arange);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_fem);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__609 = <span class='py_c_api'>PyTuple_Pack</span>(11, __pyx_n_s_disp_aug, __pyx_n_s_fem_ind, __pyx_n_s_num_surf, __pyx_n_s_tot_n_fem, __pyx_n_s_size, __pyx_n_s_disp, __pyx_n_s_arange, __pyx_n_s_i_surf, __pyx_n_s_row, __pyx_n_s_n_fem, __pyx_n_s_i_fem); if (unlikely(!__pyx_tuple__609)) __PYX_ERR(0, 1331, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__609);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__609);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_61spatial_beam_disp, 0, __pyx_n_s_spatial_beam_disp, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__610)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1331, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_spatial_beam_disp, __pyx_t_2) &lt; 0) __PYX_ERR(0, 1331, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__610 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 11, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__609, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_spatial_beam_disp, 1331, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__610)) __PYX_ERR(0, 1331, __pyx_L1_error)
</pre><pre class="cython line score-0">&#xA0;<span class="">1332</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1333</span>: <span class="sd">    Select displacements from augmented vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1334</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1335</span>: <span class="sd">    The solution to the linear system has additional results due to the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1336</span>: <span class="sd">    constraints on the FEM model. The displacements from this portion of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1337</span>: <span class="sd">    the linear system is not needed, so we select only the relevant</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1338</span>: <span class="sd">    portion of the displacements for further calculations.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1339</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1340</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1341</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1342</span>: <span class="sd">    disp_aug : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1343</span>: <span class="sd">        Augmented displacement array. Obtained by solving the system</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1344</span>: <span class="sd">        mtx * disp_aug = rhs, where rhs is a flattened version of loads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1345</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1346</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1347</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1348</span>: <span class="sd">    disp : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1349</span>: <span class="sd">        Actual displacement array formed by truncating disp_aug.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1350</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1351</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1352</span>:     <span class="n">num_surf</span> <span class="o">=</span> <span class="n">fem_ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_fem_ind, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1352, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1352, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_num_surf = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">1353</span>:     <span class="n">tot_n_fem</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1353, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1353, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__516 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__516)) __PYX_ERR(0, 1353, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__516);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__516);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fem_ind, __pyx_tuple__517); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1353, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1353, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1353, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1353, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_tot_n_fem = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_tuple__517 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__516, __pyx_int_0); if (unlikely(!__pyx_tuple__517)) __PYX_ERR(0, 1353, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__517);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__517);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">1354</span>:     <span class="n">size</span> <span class="o">=</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">tot_n_fem</span> <span class="o">+</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">num_surf</span></pre>
<pre class='cython code score-17 '>  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_tot_n_fem); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1354, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_num_surf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1354, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1354, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_size = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">1355</span>:     <span class="n">disp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_n_fem</span><span class="p">,</span> <span class="mf">6</span><span class="p">))</span></pre>
<pre class='cython code score-38 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1355, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1355, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1355, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_n_fem);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_n_fem);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_tot_n_fem);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_6);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1355, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1355, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1355, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_disp = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">1356</span>:     <span class="n">arange</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">6</span> <span class="o">*</span> <span class="n">tot_n_fem</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1356, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_arange); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1356, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_tot_n_fem); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1356, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1356, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1356, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1356, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_arange = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">1357</span>:     <span class="k">for</span> <span class="n">i_surf</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_5 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_fem_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_fem_ind)) {
    __pyx_t_4 = __pyx_v_fem_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_fem_ind); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1357, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1357, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1357, __pyx_L1_error)
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1357, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1357, __pyx_L1_error)
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1357, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_7(__pyx_t_4);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 1357, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_surf, __pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_5, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1357, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5);
    __pyx_t_5 = __pyx_t_1;
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">1358</span>:         <span class="n">n_fem</span><span class="p">,</span> <span class="n">i_fem</span> <span class="o">=</span> <span class="n">row</span></pre>
<pre class='cython code score-47 '>    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_row))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_row))) {
      PyObject* sequence = __pyx_v_row;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 1358, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1358, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1358, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      #endif
    } else {
      Py_ssize_t index = -1;
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_row); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1358, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_8 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;
      index = 0; __pyx_t_1 = __pyx_t_8(__pyx_t_3); if (unlikely(!__pyx_t_1)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      index = 1; __pyx_t_2 = __pyx_t_8(__pyx_t_3); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_3), 2) &lt; 0) __PYX_ERR(0, 1358, __pyx_L1_error)
      __pyx_t_8 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_8 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 1358, __pyx_L1_error)
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_fem, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_fem, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-24" onclick='toggleDiv(this)'>+<span class="">1359</span>:         <span class="n">disp</span><span class="p">[</span><span class="n">i_fem</span><span class="p">:</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span><span class="p">]</span> <span class="o">=</span> <span class="n">disp_aug</span><span class="p">[(</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6</span><span class="p">:(</span></pre>
<pre class='cython code score-24 '>    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_i_surf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1359, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_int_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1359, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_disp_aug, 0, 0, &amp;__pyx_t_3, &amp;__pyx_t_1, NULL, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1359, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1359, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_disp, __pyx_t_2, 0, 0, &amp;__pyx_v_i_fem, &amp;__pyx_t_1, NULL, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1359, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">1360</span>:             <span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span> <span class="o">+</span> <span class="n">i_surf</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n_fem</span><span class="p">,</span> <span class="mf">6</span><span class="p">))</span></pre>
<pre class='cython code score-53 '>    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1360, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_i_surf); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1360, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_int_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1360, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_reshape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1360, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1360, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n_fem);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n_fem);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_n_fem);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_int_6);
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1360, __pyx_L1_error)
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    } else {
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1360, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_3); __pyx_t_3 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_10, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1360, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1361</span>:     <span class="k">return</span> <span class="n">disp</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_disp);
  __pyx_r = __pyx_v_disp;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1362</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1363</span>: </pre>
<pre class="cython line score-99" onclick='toggleDiv(this)'>+<span class="">1364</span>: <span class="k">def</span> <span class="nf">compute_nodes</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">,</span> <span class="n">aero_ind</span><span class="p">,</span> <span class="n">fem_origin</span><span class="o">=</span><span class="mf">0.35</span><span class="p">):</span></pre>
<pre class='cython code score-99 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_63compute_nodes(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_62compute_nodes[] = "\n    Compute FEM nodes based on aerodynamic mesh.\n\n    The FEM nodes are placed at 0.35*chord, or based on the fem_origin value.\n\n    Parameters\n    ----------\n    mesh : array_like\n        Flattened array defining the lifting surfaces.\n\n    Returns\n    -------\n    nodes : array_like\n        Flattened array with coordinates for each FEM node.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_63compute_nodes = {"compute_nodes", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_63compute_nodes, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_62compute_nodes};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_63compute_nodes(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mesh = 0;
  PyObject *__pyx_v_fem_ind = 0;
  PyObject *__pyx_v_aero_ind = 0;
  PyObject *__pyx_v_fem_origin = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_nodes (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_mesh,&amp;__pyx_n_s_fem_ind,&amp;__pyx_n_s_aero_ind,&amp;__pyx_n_s_fem_origin,0};
    PyObject* values[4] = {0,0,0,0};
    values[3] = ((PyObject *)((PyObject*)__pyx_float_0_35));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mesh)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_fem_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_nodes", 0, 3, 4, 1); __PYX_ERR(0, 1364, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_aero_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_nodes", 0, 3, 4, 2); __PYX_ERR(0, 1364, __pyx_L3_error)
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_fem_origin);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "compute_nodes") &lt; 0)) __PYX_ERR(0, 1364, __pyx_L3_error)
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_mesh = values[0];
    __pyx_v_fem_ind = values[1];
    __pyx_v_aero_ind = values[2];
    __pyx_v_fem_origin = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_nodes", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 1364, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.compute_nodes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_62compute_nodes(__pyx_self, __pyx_v_mesh, __pyx_v_fem_ind, __pyx_v_aero_ind, __pyx_v_fem_origin);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_62compute_nodes(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_mesh, PyObject *__pyx_v_fem_ind, PyObject *__pyx_v_aero_ind, PyObject *__pyx_v_fem_origin) {
  CYTHON_UNUSED PyObject *__pyx_v_num_surf = NULL;
  PyObject *__pyx_v_tot_n_fem = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_tot_n = NULL;
  PyObject *__pyx_v_nodes = NULL;
  PyObject *__pyx_v_i_surf = NULL;
  PyObject *__pyx_v_row = NULL;
  PyObject *__pyx_v_nx = NULL;
  PyObject *__pyx_v_ny = NULL;
  PyObject *__pyx_v_n = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_n_bpts = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_n_panels = NULL;
  PyObject *__pyx_v_i = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i_bpts = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i_panels = NULL;
  PyObject *__pyx_v_n_fem = NULL;
  PyObject *__pyx_v_i_fem = NULL;
  PyObject *__pyx_v_mesh2 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_nodes", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.compute_nodes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nodes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ny);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_bpts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_panels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mesh2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__611 = <span class='py_c_api'>PyTuple_Pack</span>(21, __pyx_n_s_mesh, __pyx_n_s_fem_ind, __pyx_n_s_aero_ind, __pyx_n_s_fem_origin, __pyx_n_s_num_surf, __pyx_n_s_tot_n_fem, __pyx_n_s_tot_n, __pyx_n_s_nodes, __pyx_n_s_i_surf, __pyx_n_s_row, __pyx_n_s_nx, __pyx_n_s_ny, __pyx_n_s_n, __pyx_n_s_n_bpts, __pyx_n_s_n_panels, __pyx_n_s_i, __pyx_n_s_i_bpts, __pyx_n_s_i_panels, __pyx_n_s_n_fem, __pyx_n_s_i_fem, __pyx_n_s_mesh2); if (unlikely(!__pyx_tuple__611)) __PYX_ERR(0, 1364, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__611);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__611);
  __pyx_codeobj__612 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 21, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__611, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_C_Users_Sam_repos_OpenAeroStruct, __pyx_n_s_compute_nodes, 1364, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__612)) __PYX_ERR(0, 1364, __pyx_L1_error)
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_63compute_nodes, 0, __pyx_n_s_compute_nodes, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__612)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1364, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__613);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_nodes, __pyx_t_2) &lt; 0) __PYX_ERR(0, 1364, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__613 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject*)__pyx_float_0_35)); if (unlikely(!__pyx_tuple__613)) __PYX_ERR(0, 1364, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__613);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__613);
</pre><pre class="cython line score-0">&#xA0;<span class="">1365</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1366</span>: <span class="sd">    Compute FEM nodes based on aerodynamic mesh.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1367</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1368</span>: <span class="sd">    The FEM nodes are placed at 0.35*chord, or based on the fem_origin value.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1369</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1370</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1371</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1372</span>: <span class="sd">    mesh : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1373</span>: <span class="sd">        Flattened array defining the lifting surfaces.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1374</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1375</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1376</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1377</span>: <span class="sd">    nodes : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1378</span>: <span class="sd">        Flattened array with coordinates for each FEM node.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1379</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1380</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1381</span>:     <span class="n">num_surf</span> <span class="o">=</span> <span class="n">fem_ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_fem_ind, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1381, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1381, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_num_surf = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">1382</span>:     <span class="n">tot_n_fem</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1382, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1382, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__518 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__518)) __PYX_ERR(0, 1382, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__518);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__518);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fem_ind, __pyx_tuple__519); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1382, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1382, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1382, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1382, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_tot_n_fem = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_tuple__519 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__518, __pyx_int_0); if (unlikely(!__pyx_tuple__519)) __PYX_ERR(0, 1382, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__519);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__519);
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">1383</span>:     <span class="n">tot_n</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">aero_ind</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1383, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1383, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_slice__520 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__520)) __PYX_ERR(0, 1383, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__520);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__520);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_tuple__521); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1383, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1383, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1383, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1383, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_tot_n = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_tuple__521 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__520, __pyx_int_2); if (unlikely(!__pyx_tuple__521)) __PYX_ERR(0, 1383, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__521);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__521);
</pre><pre class="cython line score-38" onclick='toggleDiv(this)'>+<span class="">1384</span>:     <span class="n">nodes</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_n_fem</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-38 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1384, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1384, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1384, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tot_n_fem);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tot_n_fem);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_tot_n_fem);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1384, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1384, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1384, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_nodes = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-53" onclick='toggleDiv(this)'>+<span class="">1385</span>:     <span class="k">for</span> <span class="n">i_surf</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">):</span></pre>
<pre class='cython code score-53 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_2 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_fem_ind)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_fem_ind)) {
    __pyx_t_4 = __pyx_v_fem_ind; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_fem_ind); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1385, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1385, __pyx_L1_error)
  }
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1385, __pyx_L1_error)
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1385, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) __PYX_ERR(0, 1385, __pyx_L1_error)
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1385, __pyx_L1_error)
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_7(__pyx_t_4);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else __PYX_ERR(0, 1385, __pyx_L1_error)
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_surf, __pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1385, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2);
    __pyx_t_2 = __pyx_t_1;
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-92" onclick='toggleDiv(this)'>+<span class="">1386</span>:         <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n_bpts</span><span class="p">,</span> <span class="n">n_panels</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_bpts</span><span class="p">,</span> <span class="n">i_panels</span> <span class="o">=</span> <span class="n">aero_ind</span><span class="p">[</span><span class="n">i_surf</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-92 '>    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1386, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i_surf);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i_surf);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_i_surf);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__522);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__522);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_slice__522);
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_aero_ind, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1386, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
      PyObject* sequence = __pyx_t_5;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 8)) {
        if (size &gt; 8) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(8);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 1386, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
        __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 6); 
        __pyx_t_13 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 7); 
      } else {
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
        __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 6); 
        __pyx_t_13 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 7); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[8] = {&amp;__pyx_t_1,&amp;__pyx_t_3,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_13};
        for (i=0; i &lt; 8; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i); if (unlikely(!item)) __PYX_ERR(0, 1386, __pyx_L1_error)
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[8] = {&amp;__pyx_t_1,&amp;__pyx_t_3,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_13};
      __pyx_t_14 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1386, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_15 = Py_TYPE(__pyx_t_14)-&gt;tp_iternext;
      for (index=0; index &lt; 8; index++) {
        PyObject* item = __pyx_t_15(__pyx_t_14); if (unlikely(!item)) goto __pyx_L5_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_14), 8) &lt; 0) __PYX_ERR(0, 1386, __pyx_L1_error)
      __pyx_t_15 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_15 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 1386, __pyx_L1_error)
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_nx, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ny, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_bpts, __pyx_t_9);
    __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_panels, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_11);
    __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_bpts, __pyx_t_12);
    __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_panels, __pyx_t_13);
    __pyx_t_13 = 0;
/* … */
  __pyx_slice__522 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__522)) __PYX_ERR(0, 1386, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__522);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__522);
</pre><pre class="cython line score-47" onclick='toggleDiv(this)'>+<span class="">1387</span>:         <span class="n">n_fem</span><span class="p">,</span> <span class="n">i_fem</span> <span class="o">=</span> <span class="n">row</span></pre>
<pre class='cython code score-47 '>    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_row))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_row))) {
      PyObject* sequence = __pyx_v_row;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        __PYX_ERR(0, 1387, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_13 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_13 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1387, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_13 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1387, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      #endif
    } else {
      Py_ssize_t index = -1;
      __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_row); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1387, __pyx_L1_error)
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_15 = Py_TYPE(__pyx_t_12)-&gt;tp_iternext;
      index = 0; __pyx_t_5 = __pyx_t_15(__pyx_t_12); if (unlikely(!__pyx_t_5)) goto __pyx_L7_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      index = 1; __pyx_t_13 = __pyx_t_15(__pyx_t_12); if (unlikely(!__pyx_t_13)) goto __pyx_L7_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_12), 2) &lt; 0) __PYX_ERR(0, 1387, __pyx_L1_error)
      __pyx_t_15 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      goto __pyx_L8_unpacking_done;
      __pyx_L7_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_15 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      __PYX_ERR(0, 1387, __pyx_L1_error)
      __pyx_L8_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_fem, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i_fem, __pyx_t_13);
    __pyx_t_13 = 0;
</pre><pre class="cython line score-60" onclick='toggleDiv(this)'>+<span class="">1388</span>:         <span class="n">mesh2</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-60 '>    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i, __pyx_v_n); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1388, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_12 = <span class='py_c_api'>PySlice_New</span>(__pyx_v_i, __pyx_t_5, Py_None); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1388, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1388, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__523);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__523);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_slice__523);
    __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh, __pyx_t_5); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1388, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_reshape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1388, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    __pyx_t_16 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_16 = 1;
      }
    }
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_16); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1388, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (__pyx_t_12) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nx);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nx);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_16, __pyx_v_nx);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ny);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ny);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_16, __pyx_v_ny);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2+__pyx_t_16, __pyx_int_3);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_11, NULL); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1388, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_mesh2, __pyx_t_13);
    __pyx_t_13 = 0;
/* … */
  __pyx_slice__523 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__523)) __PYX_ERR(0, 1388, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__523);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__523);
</pre><pre class="cython line score-71" onclick='toggleDiv(this)'>+<span class="">1389</span>:         <span class="n">nodes</span><span class="p">[</span><span class="n">i_fem</span><span class="p">:</span><span class="n">i_fem</span> <span class="o">+</span> <span class="n">n_fem</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">fem_origin</span><span class="p">)</span> <span class="o">*</span> <span class="n">mesh2</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">fem_origin</span> <span class="o">*</span> <span class="n">mesh2</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span></pre>
<pre class='cython code score-71 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_fem_origin, 1, 0); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1389, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
/* … */
  __pyx_slice__524 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__524)) __PYX_ERR(0, 1389, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__524);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__524);
  __pyx_slice__525 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__525)) __PYX_ERR(0, 1389, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__525);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__525);
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh2, __pyx_tuple__526); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1389, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_13, __pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1389, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_tuple__526 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_0, __pyx_slice__524, __pyx_slice__525); if (unlikely(!__pyx_tuple__526)) __PYX_ERR(0, 1389, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__526);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__526);
  __pyx_slice__527 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__527)) __PYX_ERR(0, 1389, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__527);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__527);
  __pyx_slice__528 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__528)) __PYX_ERR(0, 1389, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__528);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__528);
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_mesh2, __pyx_tuple__529); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1389, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_fem_origin, __pyx_t_5); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1389, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_11, __pyx_t_13); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1389, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i_fem, __pyx_v_n_fem); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1389, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_nodes, __pyx_t_5, 0, 0, &amp;__pyx_v_i_fem, &amp;__pyx_t_13, NULL, 0, 0, 1) &lt; 0) __PYX_ERR(0, 1389, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_tuple__529 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_neg_1, __pyx_slice__527, __pyx_slice__528); if (unlikely(!__pyx_tuple__529)) __PYX_ERR(0, 1389, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__529);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__529);
</pre><pre class="cython line score-2" onclick='toggleDiv(this)'>+<span class="">1390</span>:     <span class="k">return</span> <span class="n">nodes</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nodes);
  __pyx_r = __pyx_v_nodes;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1391</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1392</span>: </pre>
<pre class="cython line score-70" onclick='toggleDiv(this)'>+<span class="">1393</span>: <span class="k">def</span> <span class="nf">materials_tube</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">fem_ind</span><span class="p">):</span></pre>
<pre class='cython code score-70 '>/* Python wrapper */
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_65materials_tube(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_14OpenAeroStruct_10aerostruct_64materials_tube[] = " Compute geometric properties for a tube element.\n\n    Parameters\n    ----------\n    r : array_like\n        Radii for each FEM element.\n    thickness : array_like\n        Tube thickness for each FEM element.\n\n    Returns\n    -------\n    A : array_like\n        Areas for each FEM element.\n    Iy : array_like\n        Mass moment of inertia around the y-axis for each FEM element.\n    Iz : array_like\n        Mass moment of inertia around the z-axis for each FEM element.\n    J : array_like\n        Polar moment of inertia for each FEM element.\n\n    ";
static PyMethodDef __pyx_mdef_14OpenAeroStruct_10aerostruct_65materials_tube = {"materials_tube", (PyCFunction)__pyx_pw_14OpenAeroStruct_10aerostruct_65materials_tube, METH_VARARGS|METH_KEYWORDS, __pyx_doc_14OpenAeroStruct_10aerostruct_64materials_tube};
static PyObject *__pyx_pw_14OpenAeroStruct_10aerostruct_65materials_tube(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_r = 0;
  PyObject *__pyx_v_thickness = 0;
  PyObject *__pyx_v_fem_ind = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("materials_tube (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_r,&amp;__pyx_n_s_thickness,&amp;__pyx_n_s_fem_ind,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_thickness)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("materials_tube", 1, 3, 3, 1); __PYX_ERR(0, 1393, __pyx_L3_error)
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_fem_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("materials_tube", 1, 3, 3, 2); __PYX_ERR(0, 1393, __pyx_L3_error)
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "materials_tube") &lt; 0)) __PYX_ERR(0, 1393, __pyx_L3_error)
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_r = values[0];
    __pyx_v_thickness = values[1];
    __pyx_v_fem_ind = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("materials_tube", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); __PYX_ERR(0, 1393, __pyx_L3_error)
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.materials_tube", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_14OpenAeroStruct_10aerostruct_64materials_tube(__pyx_self, __pyx_v_r, __pyx_v_thickness, __pyx_v_fem_ind);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_14OpenAeroStruct_10aerostruct_64materials_tube(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_r, PyObject *__pyx_v_thickness, PyObject *__pyx_v_fem_ind) {
  CYTHON_UNUSED PyObject *__pyx_v_n_fem = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i_fem = NULL;
  PyObject *__pyx_v_num_surf = NULL;
  PyObject *__pyx_v_tot_n_fem = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_size = NULL;
  PyObject *__pyx_v_A = NULL;
  PyObject *__pyx_v_Iy = NULL;
  PyObject *__pyx_v_Iz = NULL;
  PyObject *__pyx_v_J = NULL;
  PyObject *__pyx_v_r1 = NULL;
  PyObject *__pyx_v_r2 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("materials_tube", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("OpenAeroStruct.aerostruct.materials_tube", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_surf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_n_fem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_size);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_A);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Iy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Iz);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_J);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__614 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_r, __pyx_n_s_thickness, __pyx_n_s_fem_ind, __pyx_n_s_n_fem, __pyx_n_s_i_fem, __pyx_n_s_num_surf, __pyx_n_s_tot_n_fem, __pyx_n_s_size, __pyx_n_s_A, __pyx_n_s_Iy, __pyx_n_s_Iz, __pyx_n_s_J, __pyx_n_s_r1, __pyx_n_s_r2); if (unlikely(!__pyx_tuple__614)) __PYX_ERR(0, 1393, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__614);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__614);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_14OpenAeroStruct_10aerostruct_65materials_tube, 0, __pyx_n_s_materials_tube, NULL, __pyx_n_s_OpenAeroStruct_aerostruct, __pyx_d, ((PyObject *)__pyx_codeobj__615)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1393, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_materials_tube, __pyx_t_2) &lt; 0) __PYX_ERR(0, 1393, __pyx_L1_error)
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1394</span>:     <span class="sd">&quot;&quot;&quot; Compute geometric properties for a tube element.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1395</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1396</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1397</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1398</span>: <span class="sd">    r : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1399</span>: <span class="sd">        Radii for each FEM element.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1400</span>: <span class="sd">    thickness : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1401</span>: <span class="sd">        Tube thickness for each FEM element.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1402</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1403</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1404</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1405</span>: <span class="sd">    A : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1406</span>: <span class="sd">        Areas for each FEM element.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1407</span>: <span class="sd">    Iy : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1408</span>: <span class="sd">        Mass moment of inertia around the y-axis for each FEM element.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1409</span>: <span class="sd">    Iz : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1410</span>: <span class="sd">        Mass moment of inertia around the z-axis for each FEM element.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1411</span>: <span class="sd">    J : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1412</span>: <span class="sd">        Polar moment of inertia for each FEM element.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1413</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1414</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-62" onclick='toggleDiv(this)'>+<span class="">1415</span>:     <span class="n">n_fem</span><span class="p">,</span> <span class="n">i_fem</span> <span class="o">=</span> <span class="n">fem_ind</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-62 '>  __pyx_slice__530 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__530)) __PYX_ERR(0, 1415, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__530);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__530);
/* … */
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fem_ind, __pyx_tuple__531); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1415, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      __PYX_ERR(0, 1415, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1415, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1415, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1415, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_5(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_5(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_4), 2) &lt; 0) __PYX_ERR(0, 1415, __pyx_L1_error)
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    __PYX_ERR(0, 1415, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_n_fem = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_i_fem = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_tuple__531 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_slice__530); if (unlikely(!__pyx_tuple__531)) __PYX_ERR(0, 1415, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__531);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__531);
</pre><pre class="cython line score-5" onclick='toggleDiv(this)'>+<span class="">1416</span>:     <span class="n">num_surf</span> <span class="o">=</span> <span class="n">fem_ind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_fem_ind, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1416, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1416, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_num_surf = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-44" onclick='toggleDiv(this)'>+<span class="">1417</span>:     <span class="n">tot_n_fem</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fem_ind</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-44 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1417, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1417, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__532 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__532)) __PYX_ERR(0, 1417, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__532);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__532);
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_fem_ind, __pyx_tuple__533); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1417, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1417, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1417, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1417, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_tot_n_fem = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_tuple__533 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__532, __pyx_int_0); if (unlikely(!__pyx_tuple__533)) __PYX_ERR(0, 1417, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__533);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__533);
</pre><pre class="cython line score-17" onclick='toggleDiv(this)'>+<span class="">1418</span>:     <span class="n">size</span> <span class="o">=</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">tot_n_fem</span> <span class="o">+</span> <span class="mf">6</span> <span class="o">*</span> <span class="n">num_surf</span></pre>
<pre class='cython code score-17 '>  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_tot_n_fem); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1418, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_6, __pyx_v_num_surf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1418, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1418, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_size = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">1419</span>:     <span class="n">A</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_n_fem</span> <span class="o">-</span> <span class="n">num_surf</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1419, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1419, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_tot_n_fem, __pyx_v_num_surf); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1419, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1419, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1419, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+1, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1419, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_A = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">1420</span>:     <span class="n">Iy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_n_fem</span> <span class="o">-</span> <span class="n">num_surf</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1420, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1420, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_tot_n_fem, __pyx_v_num_surf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1420, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_2) {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1420, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1420, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2); __pyx_t_2 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1420, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Iy = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">1421</span>:     <span class="n">Iz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_n_fem</span> <span class="o">-</span> <span class="n">num_surf</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1421, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1421, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_tot_n_fem, __pyx_v_num_surf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1421, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1421, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  } else {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1421, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1421, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Iz = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-34" onclick='toggleDiv(this)'>+<span class="">1422</span>:     <span class="n">J</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tot_n_fem</span> <span class="o">-</span> <span class="n">num_surf</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1422, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1422, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_tot_n_fem, __pyx_v_num_surf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1422, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1422, __pyx_L1_error)
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  } else {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1422, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1422, __pyx_L1_error)
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_J = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">1423</span>:     <span class="n">r1</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">thickness</span></pre>
<pre class='cython code score-11 '>  __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_v_thickness); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1423, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_r, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1423, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_r1 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick='toggleDiv(this)'>+<span class="">1424</span>:     <span class="n">r2</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">thickness</span></pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_v_thickness); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1424, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_r, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1424, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_r2 = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-30" onclick='toggleDiv(this)'>+<span class="">1425</span>:     <span class="n">A</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">r2</span><span class="o">**</span><span class="mf">2</span> <span class="o">-</span> <span class="n">r1</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1425, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_pi); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1425, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_r2, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1425, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_r1, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1425, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1425, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1425, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_A, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-33" onclick='toggleDiv(this)'>+<span class="">1426</span>:     <span class="n">Iy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">r2</span><span class="o">**</span><span class="mf">4</span> <span class="o">-</span> <span class="n">r1</span><span class="o">**</span><span class="mf">4</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span></pre>
<pre class='cython code score-33 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1426, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_pi); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1426, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_r2, __pyx_int_4, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1426, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_r1, __pyx_int_4, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1426, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1426, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1426, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideObjC</span>(__pyx_t_2, __pyx_float_4_, 4., 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1426, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_Iy, __pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-33" onclick='toggleDiv(this)'>+<span class="">1427</span>:     <span class="n">Iz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">r2</span><span class="o">**</span><span class="mf">4</span> <span class="o">-</span> <span class="n">r1</span><span class="o">**</span><span class="mf">4</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.</span></pre>
<pre class='cython code score-33 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1427, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_pi); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1427, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_r2, __pyx_int_4, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1427, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_r1, __pyx_int_4, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1427, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1427, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1427, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideObjC</span>(__pyx_t_1, __pyx_float_4_, 4., 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1427, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_Iz, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-33" onclick='toggleDiv(this)'>+<span class="">1428</span>:     <span class="n">J</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">r2</span><span class="o">**</span><span class="mf">4</span> <span class="o">-</span> <span class="n">r1</span><span class="o">**</span><span class="mf">4</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span></pre>
<pre class='cython code score-33 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_numpy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1428, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_pi); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1428, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_r2, __pyx_int_4, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1428, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_r1, __pyx_int_4, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1428, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1428, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1428, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideObjC</span>(__pyx_t_2, __pyx_float_2_, 2., 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1428, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_J, __pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick='toggleDiv(this)'>+<span class="">1429</span>:     <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">Iy</span><span class="p">,</span> <span class="n">Iz</span><span class="p">,</span> <span class="n">J</span></pre>
<pre class='cython code score-14 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1429, __pyx_L1_error)
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_A);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_A);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_A);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Iy);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Iy);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_v_Iy);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Iz);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Iz);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_v_Iz);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_J);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_J);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_v_J);
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre></div></body></html>
